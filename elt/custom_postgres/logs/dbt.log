

============================== 2024-10-24 09:53:28.053099 | 616d7bf2-a951-4042-83c5-cc1a04226dcc ==============================
[0m09:53:28.053099 [info ] [MainThread]: Running with dbt=1.4.7
[0m09:53:28.058047 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:53:28.059186 [debug] [MainThread]: Tracking: tracking
[0m09:53:28.067987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68027210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68027217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6802721390>]}
[0m09:53:28.078471 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m09:53:28.081604 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:53:28.082754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '616d7bf2-a951-4042-83c5-cc1a04226dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6802721ed0>]}
[0m09:53:28.602956 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m09:53:28.613025 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m09:53:28.616018 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m09:53:28.618895 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m09:53:28.703991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '616d7bf2-a951-4042-83c5-cc1a04226dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6800e34610>]}
[0m09:53:28.716911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '616d7bf2-a951-4042-83c5-cc1a04226dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6800dfd810>]}
[0m09:53:28.718702 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m09:53:28.720550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616d7bf2-a951-4042-83c5-cc1a04226dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6800dfdab0>]}
[0m09:53:28.722785 [info ] [MainThread]: 
[0m09:53:28.725911 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:53:28.727744 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m09:53:28.740385 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m09:53:28.741527 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m09:53:28.742423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:28.784664 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m09:53:28.786865 [debug] [ThreadPool]: On list_destination_db: Close
[0m09:53:28.789619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m09:53:28.796520 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m09:53:28.797936 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m09:53:28.798971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:28.812990 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m09:53:28.813844 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m09:53:28.814792 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m09:53:28.819020 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m09:53:28.820708 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m09:53:28.823325 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m09:53:28.829006 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:28.830263 [debug] [MainThread]: On master: BEGIN
[0m09:53:28.831126 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:28.844386 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m09:53:28.845594 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:28.846548 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:53:28.851376 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m09:53:28.853207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616d7bf2-a951-4042-83c5-cc1a04226dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68000cf8b0>]}
[0m09:53:28.854355 [debug] [MainThread]: On master: ROLLBACK
[0m09:53:28.856293 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:28.857236 [debug] [MainThread]: On master: BEGIN
[0m09:53:28.860879 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m09:53:28.861771 [debug] [MainThread]: On master: COMMIT
[0m09:53:28.863096 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:28.864039 [debug] [MainThread]: On master: COMMIT
[0m09:53:28.866018 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m09:53:28.867088 [debug] [MainThread]: On master: Close
[0m09:53:28.868265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:53:28.869590 [info ] [MainThread]: 
[0m09:53:28.884425 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m09:53:28.885781 [info ] [Thread-1 (]: 1 of 3 START sql table model public.actors ..................................... [RUN]
[0m09:53:28.887677 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m09:53:28.888528 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m09:53:28.891377 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m09:53:28.906948 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 09:53:28.889242 => 2024-10-24 09:53:28.906844
[0m09:53:28.907886 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m09:53:28.939214 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m09:53:28.952929 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:53:28.953579 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m09:53:28.954204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:28.974265 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:53:28.975291 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:53:28.976205 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m09:53:28.981759 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m09:53:28.983404 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m09:53:28.985416 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 09:53:28.908652 => 2024-10-24 09:53:28.985338
[0m09:53:28.986296 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m09:53:28.991852 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m09:53:28.992878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616d7bf2-a951-4042-83c5-cc1a04226dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6800112980>]}
[0m09:53:28.993869 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m09:53:28.996498 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m09:53:28.997347 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m09:53:28.998282 [info ] [Thread-1 (]: 2 of 3 START sql table model public.film_actors ................................ [RUN]
[0m09:53:28.999810 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m09:53:29.000533 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m09:53:29.003416 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m09:53:29.009788 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 09:53:29.001164 => 2024-10-24 09:53:29.009725
[0m09:53:29.010598 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m09:53:29.016293 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m09:53:29.022744 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:53:29.023460 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m09:53:29.024212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:29.043545 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:53:29.044964 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:53:29.046230 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m09:53:29.049414 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m09:53:29.052145 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m09:53:29.058826 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 09:53:29.011189 => 2024-10-24 09:53:29.058737
[0m09:53:29.059992 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m09:53:29.061974 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m09:53:29.064162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616d7bf2-a951-4042-83c5-cc1a04226dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6800134af0>]}
[0m09:53:29.065620 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.06s]
[0m09:53:29.066835 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m09:53:29.068157 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m09:53:29.069734 [info ] [Thread-1 (]: 3 of 3 START sql table model public.films ...................................... [RUN]
[0m09:53:29.071729 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m09:53:29.073043 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m09:53:29.076189 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m09:53:29.087309 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 09:53:29.073997 => 2024-10-24 09:53:29.087226
[0m09:53:29.088406 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m09:53:29.092976 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m09:53:29.106705 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:53:29.108277 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m09:53:29.109328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:29.125662 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:53:29.127303 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:53:29.128674 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m09:53:29.131637 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m09:53:29.143223 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m09:53:29.146763 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 09:53:29.089709 => 2024-10-24 09:53:29.146688
[0m09:53:29.147946 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m09:53:29.149642 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m09:53:29.150826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616d7bf2-a951-4042-83c5-cc1a04226dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6800f72c80>]}
[0m09:53:29.152493 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.08s]
[0m09:53:29.153778 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m09:53:29.155994 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:53:29.157256 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:29.158330 [debug] [MainThread]: On master: BEGIN
[0m09:53:29.159394 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:29.174206 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m09:53:29.175537 [debug] [MainThread]: On master: COMMIT
[0m09:53:29.176625 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:29.177621 [debug] [MainThread]: On master: COMMIT
[0m09:53:29.179765 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m09:53:29.180843 [debug] [MainThread]: On master: Close
[0m09:53:29.182313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:29.183333 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m09:53:29.184756 [info ] [MainThread]: 
[0m09:53:29.185660 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m09:53:29.186795 [debug] [MainThread]: Command end result
[0m09:53:29.202989 [info ] [MainThread]: 
[0m09:53:29.204278 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m09:53:29.205602 [info ] [MainThread]: 
[0m09:53:29.206880 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m09:53:29.208646 [error] [MainThread]:   relation "public.actors" does not exist
[0m09:53:29.210099 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m09:53:29.211157 [error] [MainThread]:                             ^
[0m09:53:29.213174 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m09:53:29.214762 [info ] [MainThread]: 
[0m09:53:29.215885 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m09:53:29.216866 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m09:53:29.217751 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m09:53:29.218634 [error] [MainThread]:                             ^
[0m09:53:29.219854 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m09:53:29.220992 [info ] [MainThread]: 
[0m09:53:29.222196 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m09:53:29.223365 [error] [MainThread]:   relation "public.films" does not exist
[0m09:53:29.224695 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m09:53:29.225519 [error] [MainThread]:                             ^
[0m09:53:29.226416 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m09:53:29.227366 [info ] [MainThread]: 
[0m09:53:29.228344 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m09:53:29.229747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68001132b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6800113c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6800113580>]}
[0m09:53:29.231375 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:03:24.395771 | 59ec9c32-7b9b-4157-8185-a1d2703e4a46 ==============================
[0m10:03:24.395771 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:03:24.400013 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:03:24.401272 [debug] [MainThread]: Tracking: tracking
[0m10:03:24.404344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840409d0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840409d780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840409d360>]}
[0m10:03:24.422523 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:03:24.570564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:03:24.571561 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:03:24.578731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59ec9c32-7b9b-4157-8185-a1d2703e4a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84027c40d0>]}
[0m10:03:24.594603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59ec9c32-7b9b-4157-8185-a1d2703e4a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840278d300>]}
[0m10:03:24.598420 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:03:24.603141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ec9c32-7b9b-4157-8185-a1d2703e4a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840278d330>]}
[0m10:03:24.605672 [info ] [MainThread]: 
[0m10:03:24.609101 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:03:24.615637 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:03:24.633255 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:03:24.636565 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:03:24.642982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:24.676995 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:03:24.681260 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:03:24.683775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:03:24.690324 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:03:24.691567 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:03:24.692507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:24.709781 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:03:24.710976 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:03:24.711921 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:03:24.716460 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:03:24.718442 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:03:24.720505 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:03:24.725888 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:24.728084 [debug] [MainThread]: On master: BEGIN
[0m10:03:24.729025 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:24.748988 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:03:24.750626 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:24.751645 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:03:24.758911 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:03:24.760794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ec9c32-7b9b-4157-8185-a1d2703e4a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840278b370>]}
[0m10:03:24.762651 [debug] [MainThread]: On master: ROLLBACK
[0m10:03:24.764971 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:24.765849 [debug] [MainThread]: On master: BEGIN
[0m10:03:24.770930 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:03:24.772244 [debug] [MainThread]: On master: COMMIT
[0m10:03:24.773539 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:24.775363 [debug] [MainThread]: On master: COMMIT
[0m10:03:24.780376 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:03:24.783947 [debug] [MainThread]: On master: Close
[0m10:03:24.786597 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:03:24.790666 [info ] [MainThread]: 
[0m10:03:24.806961 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:03:24.808650 [info ] [Thread-1 (]: 1 of 3 START sql table model public.actors ..................................... [RUN]
[0m10:03:24.810506 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:03:24.811636 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:03:24.815011 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:03:24.826791 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:03:24.812755 => 2024-10-24 10:03:24.826616
[0m10:03:24.828134 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:03:24.867379 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:03:24.879503 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:03:24.880821 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:03:24.881999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:03:24.899204 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:03:24.901129 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:03:24.902289 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:03:24.905988 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:03:24.907338 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:03:24.910831 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:03:24.829421 => 2024-10-24 10:03:24.910730
[0m10:03:24.912079 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:03:24.914855 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:03:24.916426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ec9c32-7b9b-4157-8185-a1d2703e4a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8402661210>]}
[0m10:03:24.917816 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m10:03:24.920505 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:03:24.922292 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:03:24.923608 [info ] [Thread-1 (]: 2 of 3 START sql table model public.film_actors ................................ [RUN]
[0m10:03:24.925400 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:03:24.926646 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:03:24.931134 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:03:24.941790 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:03:24.927806 => 2024-10-24 10:03:24.941694
[0m10:03:24.942928 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:03:24.947194 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:03:24.958265 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:03:24.959400 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:03:24.960637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:03:24.977169 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:03:24.978672 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:03:24.979840 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:03:24.982227 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:03:24.983268 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:03:24.987491 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:03:24.943970 => 2024-10-24 10:03:24.987361
[0m10:03:24.988815 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:03:24.990616 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:03:24.991738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ec9c32-7b9b-4157-8185-a1d2703e4a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84026a7910>]}
[0m10:03:24.992872 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m10:03:24.994009 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:03:24.995272 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:03:24.996428 [info ] [Thread-1 (]: 3 of 3 START sql table model public.films ...................................... [RUN]
[0m10:03:24.998012 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:03:24.999000 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:03:25.001994 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:03:25.014469 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:03:24.999867 => 2024-10-24 10:03:25.014360
[0m10:03:25.015903 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:03:25.020655 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:03:25.032089 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:03:25.033104 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:03:25.034373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:03:25.050624 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:03:25.052645 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:03:25.053668 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:03:25.056634 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m10:03:25.057722 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:03:25.060988 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:03:25.017304 => 2024-10-24 10:03:25.060876
[0m10:03:25.062184 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:03:25.064066 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:03:25.065253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ec9c32-7b9b-4157-8185-a1d2703e4a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8402660d00>]}
[0m10:03:25.066510 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m10:03:25.068234 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:03:25.070805 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:03:25.071879 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:25.072793 [debug] [MainThread]: On master: BEGIN
[0m10:03:25.073750 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:03:25.090515 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:03:25.091718 [debug] [MainThread]: On master: COMMIT
[0m10:03:25.092799 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:25.093810 [debug] [MainThread]: On master: COMMIT
[0m10:03:25.095984 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:03:25.097196 [debug] [MainThread]: On master: Close
[0m10:03:25.098721 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:25.099963 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:03:25.101228 [info ] [MainThread]: 
[0m10:03:25.102754 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m10:03:25.104485 [debug] [MainThread]: Command end result
[0m10:03:25.123425 [info ] [MainThread]: 
[0m10:03:25.125046 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:03:25.126524 [info ] [MainThread]: 
[0m10:03:25.128019 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:03:25.129658 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:03:25.131021 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:03:25.132329 [error] [MainThread]:                             ^
[0m10:03:25.133478 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:03:25.135010 [info ] [MainThread]: 
[0m10:03:25.136496 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:03:25.137728 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:03:25.138943 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:03:25.140252 [error] [MainThread]:                             ^
[0m10:03:25.141354 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:03:25.142721 [info ] [MainThread]: 
[0m10:03:25.143919 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:03:25.145093 [error] [MainThread]:   relation "public.films" does not exist
[0m10:03:25.146433 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m10:03:25.147470 [error] [MainThread]:                             ^
[0m10:03:25.148567 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:03:25.149601 [info ] [MainThread]: 
[0m10:03:25.150633 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m10:03:25.151866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8402810b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84026a5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84026a4580>]}
[0m10:03:25.152969 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:08:21.537809 | dbc92d43-4bac-43bf-9e01-0e67f58f9c6d ==============================
[0m10:08:21.537809 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:08:21.541617 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:08:21.543438 [debug] [MainThread]: Tracking: tracking
[0m10:08:21.550860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db192d0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db192d780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db192d360>]}
[0m10:08:21.566515 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:08:21.846717 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m10:08:21.849244 [debug] [MainThread]: Partial parsing: added file: custom_postgres://models/example/source.yml
[0m10:08:21.871249 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m10:08:21.886645 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m10:08:21.891552 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m10:08:21.985095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbc92d43-4bac-43bf-9e01-0e67f58f9c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dae0cbee0>]}
[0m10:08:22.021886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbc92d43-4bac-43bf-9e01-0e67f58f9c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db190e710>]}
[0m10:08:22.023217 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:08:22.026837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbc92d43-4bac-43bf-9e01-0e67f58f9c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db190e800>]}
[0m10:08:22.031388 [info ] [MainThread]: 
[0m10:08:22.042023 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:08:22.045753 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:08:22.062624 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:08:22.065639 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:08:22.068950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:22.118454 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:08:22.121083 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:08:22.124635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:08:22.130871 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:08:22.131981 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:08:22.132936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:08:22.144051 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:08:22.145072 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:08:22.145980 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:08:22.150065 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:08:22.151834 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:08:22.154237 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:08:22.159045 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:22.160125 [debug] [MainThread]: On master: BEGIN
[0m10:08:22.160884 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:08:22.174872 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:08:22.175881 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:22.176999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:08:22.183693 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:08:22.185658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbc92d43-4bac-43bf-9e01-0e67f58f9c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dae1138b0>]}
[0m10:08:22.197060 [debug] [MainThread]: On master: ROLLBACK
[0m10:08:22.207905 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:22.210949 [debug] [MainThread]: On master: BEGIN
[0m10:08:22.230818 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:08:22.245674 [debug] [MainThread]: On master: COMMIT
[0m10:08:22.255547 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:22.258180 [debug] [MainThread]: On master: COMMIT
[0m10:08:22.263791 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:08:22.266548 [debug] [MainThread]: On master: Close
[0m10:08:22.268898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:08:22.270857 [info ] [MainThread]: 
[0m10:08:22.291152 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:08:22.293836 [info ] [Thread-1 (]: 1 of 3 START sql table model public.actors ..................................... [RUN]
[0m10:08:22.296179 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:08:22.298384 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:08:22.303143 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:08:22.334964 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:08:22.300389 => 2024-10-24 10:08:22.334771
[0m10:08:22.337873 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:08:22.371420 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:08:22.393975 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:08:22.395700 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:08:22.397316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:22.415670 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:08:22.417267 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:08:22.418599 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:08:22.422785 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:08:22.424417 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:08:22.427659 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:08:22.339373 => 2024-10-24 10:08:22.427594
[0m10:08:22.429024 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:08:22.436083 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:08:22.437841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc92d43-4bac-43bf-9e01-0e67f58f9c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dae15e950>]}
[0m10:08:22.439500 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m10:08:22.442408 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:08:22.444028 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:08:22.445676 [info ] [Thread-1 (]: 2 of 3 START sql table model public.film_actors ................................ [RUN]
[0m10:08:22.447385 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:08:22.449140 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:08:22.453106 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:08:22.470874 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:08:22.450511 => 2024-10-24 10:08:22.470734
[0m10:08:22.472674 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:08:22.482246 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:08:22.505092 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:08:22.506782 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:08:22.508609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:22.528112 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:08:22.529269 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:08:22.530121 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:08:22.532333 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:08:22.533625 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:08:22.535570 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:08:22.474222 => 2024-10-24 10:08:22.535496
[0m10:08:22.536425 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:08:22.537830 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:08:22.540064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc92d43-4bac-43bf-9e01-0e67f58f9c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dae12b8e0>]}
[0m10:08:22.541363 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.09s]
[0m10:08:22.542198 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:08:22.543350 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:08:22.544973 [info ] [Thread-1 (]: 3 of 3 START sql table model public.films ...................................... [RUN]
[0m10:08:22.546719 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:08:22.548266 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:08:22.551314 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:08:22.562684 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:08:22.549125 => 2024-10-24 10:08:22.562595
[0m10:08:22.563840 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:08:22.568275 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:08:22.582275 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:08:22.583770 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:08:22.585138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:22.601545 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:08:22.603263 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:08:22.604529 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:08:22.607315 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m10:08:22.608428 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:08:22.610800 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:08:22.565123 => 2024-10-24 10:08:22.610722
[0m10:08:22.611872 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:08:22.613442 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:08:22.614675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc92d43-4bac-43bf-9e01-0e67f58f9c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dae15ee30>]}
[0m10:08:22.615907 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m10:08:22.616924 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:08:22.619010 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:08:22.619871 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:22.620919 [debug] [MainThread]: On master: BEGIN
[0m10:08:22.621909 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:08:22.637052 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:08:22.638707 [debug] [MainThread]: On master: COMMIT
[0m10:08:22.640317 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:22.641971 [debug] [MainThread]: On master: COMMIT
[0m10:08:22.644896 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:08:22.646445 [debug] [MainThread]: On master: Close
[0m10:08:22.648369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:08:22.649580 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:08:22.650807 [info ] [MainThread]: 
[0m10:08:22.652422 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m10:08:22.654152 [debug] [MainThread]: Command end result
[0m10:08:22.674546 [info ] [MainThread]: 
[0m10:08:22.676372 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:08:22.677629 [info ] [MainThread]: 
[0m10:08:22.678731 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:08:22.679764 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:08:22.681088 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:08:22.682575 [error] [MainThread]:                             ^
[0m10:08:22.684046 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:08:22.685436 [info ] [MainThread]: 
[0m10:08:22.686661 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:08:22.687996 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:08:22.689462 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:08:22.691299 [error] [MainThread]:                             ^
[0m10:08:22.692432 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:08:22.694131 [info ] [MainThread]: 
[0m10:08:22.695357 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:08:22.696499 [error] [MainThread]:   relation "public.films" does not exist
[0m10:08:22.697885 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m10:08:22.699082 [error] [MainThread]:                             ^
[0m10:08:22.700413 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:08:22.701959 [info ] [MainThread]: 
[0m10:08:22.703220 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m10:08:22.704586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db004fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db1910220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db1912200>]}
[0m10:08:22.706271 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:09:51.269076 | 0cfcb7b3-e0b4-4209-b78e-beca4bfda228 ==============================
[0m10:09:51.269076 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:09:51.271415 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:09:51.271936 [debug] [MainThread]: Tracking: tracking
[0m10:09:51.278457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cd8490f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cd8497b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cd849390>]}
[0m10:09:51.292235 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:09:51.429117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:09:51.430001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:09:51.435763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cfcb7b3-e0b4-4209-b78e-beca4bfda228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cbf7c0d0>]}
[0m10:09:51.445560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cfcb7b3-e0b4-4209-b78e-beca4bfda228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cbf491e0>]}
[0m10:09:51.448503 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:09:51.449795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cfcb7b3-e0b4-4209-b78e-beca4bfda228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cbf49210>]}
[0m10:09:51.453240 [info ] [MainThread]: 
[0m10:09:51.462534 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:09:51.469607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:09:51.481023 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:09:51.483506 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:09:51.485649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:51.511637 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:09:51.513853 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:09:51.516132 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:09:51.522159 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:09:51.523140 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:09:51.523963 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:51.535260 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:09:51.536432 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:09:51.537498 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:09:51.541437 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:09:51.543281 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:09:51.545052 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:09:51.550145 [debug] [MainThread]: Using postgres connection "master"
[0m10:09:51.551167 [debug] [MainThread]: On master: BEGIN
[0m10:09:51.551976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:09:51.563067 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:09:51.564167 [debug] [MainThread]: Using postgres connection "master"
[0m10:09:51.565027 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:09:51.569706 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:09:51.571299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cfcb7b3-e0b4-4209-b78e-beca4bfda228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cbf3e650>]}
[0m10:09:51.572472 [debug] [MainThread]: On master: ROLLBACK
[0m10:09:51.574141 [debug] [MainThread]: Using postgres connection "master"
[0m10:09:51.575132 [debug] [MainThread]: On master: BEGIN
[0m10:09:51.577609 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:09:51.578496 [debug] [MainThread]: On master: COMMIT
[0m10:09:51.579432 [debug] [MainThread]: Using postgres connection "master"
[0m10:09:51.580128 [debug] [MainThread]: On master: COMMIT
[0m10:09:51.581993 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:09:51.582729 [debug] [MainThread]: On master: Close
[0m10:09:51.583878 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:09:51.585449 [info ] [MainThread]: 
[0m10:09:51.599499 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:09:51.600741 [info ] [Thread-1 (]: 1 of 3 START sql table model public.actors ..................................... [RUN]
[0m10:09:51.602338 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:09:51.603304 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:09:51.606185 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:09:51.613021 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:09:51.604043 => 2024-10-24 10:09:51.612933
[0m10:09:51.614011 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:09:51.645623 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:09:51.655384 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:09:51.656549 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:09:51.657721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:51.672077 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:09:51.673222 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:09:51.673995 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:09:51.678949 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:09:51.679685 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:09:51.681121 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:09:51.614757 => 2024-10-24 10:09:51.681052
[0m10:09:51.681761 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:09:51.688534 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:09:51.690042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfcb7b3-e0b4-4209-b78e-beca4bfda228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cbe392a0>]}
[0m10:09:51.690986 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.09s]
[0m10:09:51.693401 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:09:51.694412 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:09:51.695240 [info ] [Thread-1 (]: 2 of 3 START sql table model public.film_actors ................................ [RUN]
[0m10:09:51.696992 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:09:51.697746 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:09:51.701382 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:09:51.707519 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:09:51.698406 => 2024-10-24 10:09:51.707441
[0m10:09:51.708264 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:09:51.711818 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:09:51.718067 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:09:51.718829 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:09:51.719528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:51.731061 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:09:51.731909 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:09:51.732783 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:09:51.739137 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:09:51.740356 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:09:51.741871 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:09:51.708903 => 2024-10-24 10:09:51.741801
[0m10:09:51.742799 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:09:51.744249 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:09:51.745059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfcb7b3-e0b4-4209-b78e-beca4bfda228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cbdec190>]}
[0m10:09:51.746105 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.05s]
[0m10:09:51.747302 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:09:51.748053 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:09:51.748844 [info ] [Thread-1 (]: 3 of 3 START sql table model public.films ...................................... [RUN]
[0m10:09:51.750193 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:09:51.750931 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:09:51.753753 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:09:51.760260 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:09:51.751639 => 2024-10-24 10:09:51.760175
[0m10:09:51.761079 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:09:51.764806 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:09:51.771112 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:09:51.771895 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:09:51.772622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:51.784073 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:09:51.785230 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:09:51.786084 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:09:51.791529 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m10:09:51.792258 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:09:51.793990 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:09:51.761869 => 2024-10-24 10:09:51.793927
[0m10:09:51.794643 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:09:51.795863 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:09:51.796698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfcb7b3-e0b4-4209-b78e-beca4bfda228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cbe397b0>]}
[0m10:09:51.797876 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.05s]
[0m10:09:51.799121 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:09:51.800728 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:09:51.801608 [debug] [MainThread]: Using postgres connection "master"
[0m10:09:51.802234 [debug] [MainThread]: On master: BEGIN
[0m10:09:51.803024 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:09:51.814891 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:09:51.815830 [debug] [MainThread]: On master: COMMIT
[0m10:09:51.816548 [debug] [MainThread]: Using postgres connection "master"
[0m10:09:51.817198 [debug] [MainThread]: On master: COMMIT
[0m10:09:51.818522 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:09:51.819403 [debug] [MainThread]: On master: Close
[0m10:09:51.820456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:09:51.821131 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:09:51.821774 [info ] [MainThread]: 
[0m10:09:51.823494 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m10:09:51.824898 [debug] [MainThread]: Command end result
[0m10:09:51.836062 [info ] [MainThread]: 
[0m10:09:51.838397 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:09:51.851000 [info ] [MainThread]: 
[0m10:09:51.852677 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:09:51.854345 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:09:51.855479 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:09:51.857016 [error] [MainThread]:                             ^
[0m10:09:51.858333 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:09:51.859561 [info ] [MainThread]: 
[0m10:09:51.860645 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:09:51.862027 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:09:51.863083 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:09:51.864128 [error] [MainThread]:                             ^
[0m10:09:51.865569 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:09:51.866315 [info ] [MainThread]: 
[0m10:09:51.867075 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:09:51.868103 [error] [MainThread]:   relation "public.films" does not exist
[0m10:09:51.869669 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m10:09:51.870863 [error] [MainThread]:                             ^
[0m10:09:51.872120 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:09:51.873891 [info ] [MainThread]: 
[0m10:09:51.875320 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m10:09:51.877312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cbdc8e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cbdee740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cbdee230>]}
[0m10:09:51.878711 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:15:09.015299 | 063007aa-5b27-43fb-a6ae-48aeb881784d ==============================
[0m10:15:09.015299 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:15:09.017811 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:15:09.019034 [debug] [MainThread]: Tracking: tracking
[0m10:15:09.029296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053464d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053464d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053464d390>]}
[0m10:15:09.045113 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:15:09.221301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:15:09.222433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:15:09.228801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '063007aa-5b27-43fb-a6ae-48aeb881784d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532d840d0>]}
[0m10:15:09.240693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '063007aa-5b27-43fb-a6ae-48aeb881784d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532d51270>]}
[0m10:15:09.241676 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:15:09.243377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '063007aa-5b27-43fb-a6ae-48aeb881784d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532d512a0>]}
[0m10:15:09.247217 [info ] [MainThread]: 
[0m10:15:09.250808 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:15:09.253492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:15:09.264052 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:15:09.265436 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:15:09.266636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:09.293432 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:15:09.295426 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:15:09.297824 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:15:09.303508 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:15:09.304424 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:15:09.305214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:09.318034 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:15:09.319018 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:15:09.320045 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:15:09.323844 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:15:09.325757 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:15:09.327741 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:15:09.332848 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:09.334058 [debug] [MainThread]: On master: BEGIN
[0m10:15:09.334804 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:15:09.347255 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:15:09.348235 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:09.349359 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:15:09.353318 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:15:09.354821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '063007aa-5b27-43fb-a6ae-48aeb881784d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532d4b2e0>]}
[0m10:15:09.355806 [debug] [MainThread]: On master: ROLLBACK
[0m10:15:09.358027 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:09.359071 [debug] [MainThread]: On master: BEGIN
[0m10:15:09.361740 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:15:09.362847 [debug] [MainThread]: On master: COMMIT
[0m10:15:09.363790 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:09.364553 [debug] [MainThread]: On master: COMMIT
[0m10:15:09.366206 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:15:09.367192 [debug] [MainThread]: On master: Close
[0m10:15:09.368345 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:09.370209 [info ] [MainThread]: 
[0m10:15:09.385040 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:15:09.386440 [info ] [Thread-1 (]: 1 of 3 START sql table model public.actors ..................................... [RUN]
[0m10:15:09.388137 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:15:09.389270 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:15:09.392948 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:15:09.399769 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:15:09.390656 => 2024-10-24 10:15:09.399697
[0m10:15:09.400868 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:15:09.431986 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:15:09.439278 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:15:09.439911 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:15:09.440500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:09.454425 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:15:09.455309 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:15:09.456036 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:15:09.460512 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:15:09.461908 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:15:09.463716 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:15:09.401775 => 2024-10-24 10:15:09.463648
[0m10:15:09.464525 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:15:09.469663 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:15:09.470837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '063007aa-5b27-43fb-a6ae-48aeb881784d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532c16b00>]}
[0m10:15:09.471874 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.08s]
[0m10:15:09.474446 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:15:09.475774 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:15:09.476758 [info ] [Thread-1 (]: 2 of 3 START sql table model public.film_actors ................................ [RUN]
[0m10:15:09.478037 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:15:09.478894 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:15:09.482858 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:15:09.489361 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:15:09.479729 => 2024-10-24 10:15:09.489300
[0m10:15:09.490081 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:15:09.493800 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:15:09.500513 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:15:09.501290 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:15:09.502070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:09.514387 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:15:09.515432 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:15:09.516212 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:15:09.520589 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:15:09.522600 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:15:09.524359 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:15:09.490776 => 2024-10-24 10:15:09.524276
[0m10:15:09.525415 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:15:09.526814 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:15:09.527746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '063007aa-5b27-43fb-a6ae-48aeb881784d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532bf45e0>]}
[0m10:15:09.528930 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.05s]
[0m10:15:09.530382 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:15:09.531278 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:15:09.532076 [info ] [Thread-1 (]: 3 of 3 START sql table model public.films ...................................... [RUN]
[0m10:15:09.533648 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:15:09.534586 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:15:09.537359 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:15:09.544153 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:15:09.535158 => 2024-10-24 10:15:09.544078
[0m10:15:09.545083 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:15:09.548978 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:15:09.556105 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:15:09.556937 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:15:09.557725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:09.568824 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:15:09.569767 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:15:09.570719 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:15:09.573120 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m10:15:09.577687 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:15:09.579460 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:15:09.545946 => 2024-10-24 10:15:09.579392
[0m10:15:09.580310 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:15:09.581777 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:15:09.582697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '063007aa-5b27-43fb-a6ae-48aeb881784d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532c165f0>]}
[0m10:15:09.583655 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.05s]
[0m10:15:09.585209 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:15:09.587276 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:15:09.588232 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:09.589023 [debug] [MainThread]: On master: BEGIN
[0m10:15:09.589724 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:15:09.603126 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:15:09.604254 [debug] [MainThread]: On master: COMMIT
[0m10:15:09.605002 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:09.605831 [debug] [MainThread]: On master: COMMIT
[0m10:15:09.613015 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:15:09.614471 [debug] [MainThread]: On master: Close
[0m10:15:09.615548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:09.616946 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:15:09.618233 [info ] [MainThread]: 
[0m10:15:09.619541 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m10:15:09.620973 [debug] [MainThread]: Command end result
[0m10:15:09.638842 [info ] [MainThread]: 
[0m10:15:09.640738 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:15:09.643014 [info ] [MainThread]: 
[0m10:15:09.644771 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:15:09.645815 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:15:09.647072 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:15:09.648235 [error] [MainThread]:                             ^
[0m10:15:09.649431 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:15:09.650552 [info ] [MainThread]: 
[0m10:15:09.651830 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:15:09.652964 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:15:09.654332 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:15:09.655395 [error] [MainThread]:                             ^
[0m10:15:09.656396 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:15:09.657761 [info ] [MainThread]: 
[0m10:15:09.659067 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:15:09.660201 [error] [MainThread]:   relation "public.films" does not exist
[0m10:15:09.661275 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m10:15:09.662341 [error] [MainThread]:                             ^
[0m10:15:09.663368 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:15:09.664620 [info ] [MainThread]: 
[0m10:15:09.665854 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m10:15:09.666929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532dcf4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532bf6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532bf60b0>]}
[0m10:15:09.667916 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:17:08.072673 | e656c9c3-b548-480a-bcce-a3a199e8fe64 ==============================
[0m10:17:08.072673 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:17:08.075636 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:17:08.076548 [debug] [MainThread]: Tracking: tracking
[0m10:17:08.082816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14a968d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14a968d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14a968d390>]}
[0m10:17:08.096481 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:17:08.210532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:17:08.211487 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/films.sql
[0m10:17:08.227950 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m10:17:08.282089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e656c9c3-b548-480a-bcce-a3a199e8fe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14a5c4a050>]}
[0m10:17:08.336328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e656c9c3-b548-480a-bcce-a3a199e8fe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14a7e147f0>]}
[0m10:17:08.338575 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:17:08.341978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e656c9c3-b548-480a-bcce-a3a199e8fe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14a9691210>]}
[0m10:17:08.349299 [info ] [MainThread]: 
[0m10:17:08.353201 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:17:08.357660 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:17:08.370270 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:17:08.372819 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:17:08.375207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:08.405920 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:17:08.408223 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:17:08.410771 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:17:08.416254 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:17:08.417487 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:17:08.418716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:08.432408 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:17:08.434031 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:17:08.435395 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:17:08.439466 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:17:08.441698 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:17:08.444067 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:17:08.450216 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:08.451227 [debug] [MainThread]: On master: BEGIN
[0m10:17:08.452148 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:08.463575 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:17:08.464720 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:08.465595 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:17:08.469609 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:17:08.471665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e656c9c3-b548-480a-bcce-a3a199e8fe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14a96912a0>]}
[0m10:17:08.472848 [debug] [MainThread]: On master: ROLLBACK
[0m10:17:08.474783 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:08.475783 [debug] [MainThread]: On master: BEGIN
[0m10:17:08.478346 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:17:08.479389 [debug] [MainThread]: On master: COMMIT
[0m10:17:08.480299 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:08.481032 [debug] [MainThread]: On master: COMMIT
[0m10:17:08.482643 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:17:08.483508 [debug] [MainThread]: On master: Close
[0m10:17:08.484503 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:17:08.486148 [info ] [MainThread]: 
[0m10:17:08.502199 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:17:08.503705 [info ] [Thread-1 (]: 1 of 3 START sql table model public.actors ..................................... [RUN]
[0m10:17:08.505623 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:17:08.506810 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:17:08.510205 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:17:08.526068 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:17:08.507981 => 2024-10-24 10:17:08.525909
[0m10:17:08.527853 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:17:08.562591 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:17:08.586186 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:17:08.588187 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:17:08.590004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:08.611965 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:17:08.614558 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:17:08.616269 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:17:08.620773 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:17:08.624190 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:17:08.632711 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:17:08.529245 => 2024-10-24 10:17:08.632475
[0m10:17:08.637275 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:17:08.646471 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:17:08.648823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e656c9c3-b548-480a-bcce-a3a199e8fe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14a5cc2dd0>]}
[0m10:17:08.651051 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m10:17:08.655614 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:17:08.657343 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:17:08.659300 [info ] [Thread-1 (]: 2 of 3 START sql table model public.film_actors ................................ [RUN]
[0m10:17:08.661752 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:17:08.663304 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:17:08.668738 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:17:08.685850 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:17:08.665138 => 2024-10-24 10:17:08.685714
[0m10:17:08.688374 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:17:08.694616 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:17:08.707762 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:17:08.709342 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:17:08.710932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:08.732971 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:17:08.735248 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:17:08.736967 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:17:08.740860 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:17:08.742407 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:17:08.745528 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:17:08.690322 => 2024-10-24 10:17:08.745441
[0m10:17:08.746558 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:17:08.748137 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:17:08.749403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e656c9c3-b548-480a-bcce-a3a199e8fe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14a5cdf010>]}
[0m10:17:08.750852 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.09s]
[0m10:17:08.752131 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:17:08.753079 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:17:08.754369 [info ] [Thread-1 (]: 3 of 3 START sql table model public.films ...................................... [RUN]
[0m10:17:08.755854 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:17:08.756956 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:17:08.759356 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:17:08.770028 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:17:08.758144 => 2024-10-24 10:17:08.769928
[0m10:17:08.771583 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:17:08.777326 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:17:08.791715 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:17:08.793381 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:17:08.794889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:08.814001 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:17:08.816252 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:17:08.817650 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM 'destination_db'.'films'
  );
  
[0m10:17:08.821946 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "'destination_db'"
LINE 8:     SELECT * FROM 'destination_db'.'films'
                          ^

[0m10:17:08.824364 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:17:08.832056 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:17:08.772902 => 2024-10-24 10:17:08.831844
[0m10:17:08.835898 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:17:08.838415 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  syntax error at or near "'destination_db'"
  LINE 8:     SELECT * FROM 'destination_db'.'films'
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:17:08.839623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e656c9c3-b548-480a-bcce-a3a199e8fe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14a5cc3310>]}
[0m10:17:08.840973 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.08s]
[0m10:17:08.842330 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:17:08.844507 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:17:08.845880 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:08.847196 [debug] [MainThread]: On master: BEGIN
[0m10:17:08.848515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:08.861866 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:17:08.863384 [debug] [MainThread]: On master: COMMIT
[0m10:17:08.864736 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:08.866140 [debug] [MainThread]: On master: COMMIT
[0m10:17:08.868370 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:17:08.869521 [debug] [MainThread]: On master: Close
[0m10:17:08.871231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:08.872205 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:17:08.873219 [info ] [MainThread]: 
[0m10:17:08.874386 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m10:17:08.875417 [debug] [MainThread]: Command end result
[0m10:17:08.890654 [info ] [MainThread]: 
[0m10:17:08.892190 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:17:08.893436 [info ] [MainThread]: 
[0m10:17:08.894732 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:17:08.895632 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:17:08.897490 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:17:08.898979 [error] [MainThread]:                             ^
[0m10:17:08.900170 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:17:08.901899 [info ] [MainThread]: 
[0m10:17:08.903020 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:17:08.904042 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:17:08.905414 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:17:08.906415 [error] [MainThread]:                             ^
[0m10:17:08.907277 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:17:08.908370 [info ] [MainThread]: 
[0m10:17:08.909425 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:17:08.910513 [error] [MainThread]:   syntax error at or near "'destination_db'"
[0m10:17:08.911622 [error] [MainThread]:   LINE 8:     SELECT * FROM 'destination_db'.'films'
[0m10:17:08.912863 [error] [MainThread]:                             ^
[0m10:17:08.913788 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:17:08.914866 [info ] [MainThread]: 
[0m10:17:08.916151 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m10:17:08.917315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14a7d6bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14a7e14460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14a5c48a30>]}
[0m10:17:08.918472 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:18:04.939936 | bb5bb651-8997-4655-8d6d-f41758f389e2 ==============================
[0m10:18:04.939936 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:18:04.942311 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:18:04.943010 [debug] [MainThread]: Tracking: tracking
[0m10:18:04.948672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a9f20b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a9f22fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a9f20b20>]}
[0m10:18:04.961625 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:18:05.157901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:18:05.159392 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/films.sql
[0m10:18:05.177813 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m10:18:05.230534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb5bb651-8997-4655-8d6d-f41758f389e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a66520e0>]}
[0m10:18:05.247172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb5bb651-8997-4655-8d6d-f41758f389e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a85f0f10>]}
[0m10:18:05.251388 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:18:05.253078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb5bb651-8997-4655-8d6d-f41758f389e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a862b370>]}
[0m10:18:05.264581 [info ] [MainThread]: 
[0m10:18:05.266947 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:18:05.269811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:18:05.280530 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:18:05.282328 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:18:05.283942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:05.310562 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:18:05.313224 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:18:05.316112 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:18:05.322837 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:18:05.324266 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:18:05.325862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:05.342118 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:18:05.343448 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:18:05.344981 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:18:05.353233 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m10:18:05.355222 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:18:05.357634 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:18:05.364137 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:05.365556 [debug] [MainThread]: On master: BEGIN
[0m10:18:05.367027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:18:05.378904 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:18:05.380131 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:05.380903 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:18:05.388194 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:18:05.389932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb5bb651-8997-4655-8d6d-f41758f389e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a9f23f10>]}
[0m10:18:05.390990 [debug] [MainThread]: On master: ROLLBACK
[0m10:18:05.392893 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:05.393634 [debug] [MainThread]: On master: BEGIN
[0m10:18:05.396813 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:18:05.398202 [debug] [MainThread]: On master: COMMIT
[0m10:18:05.399168 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:05.399987 [debug] [MainThread]: On master: COMMIT
[0m10:18:05.401936 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:18:05.402711 [debug] [MainThread]: On master: Close
[0m10:18:05.403841 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:18:05.405336 [info ] [MainThread]: 
[0m10:18:05.410329 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:18:05.411424 [info ] [Thread-1 (]: 1 of 3 START sql table model public.actors ..................................... [RUN]
[0m10:18:05.413297 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:18:05.414203 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:18:05.417345 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:18:05.424284 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:18:05.414955 => 2024-10-24 10:18:05.424194
[0m10:18:05.425106 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:18:05.455225 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:18:05.471412 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:18:05.472367 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:18:05.473216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:05.484911 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:18:05.485705 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:18:05.486578 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:18:05.490347 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m10:18:05.496910 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:18:05.497796 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m10:18:05.499706 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:18:05.502484 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:18:05.503317 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m10:18:05.504932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:18:05.523317 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m10:18:05.525235 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:18:05.527235 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m10:18:05.530991 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m10:18:05.535397 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:18:05.536282 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m10:18:05.540579 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m10:18:05.542479 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:18:05.426014 => 2024-10-24 10:18:05.542433
[0m10:18:05.543337 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:18:05.544691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb651-8997-4655-8d6d-f41758f389e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a6679630>]}
[0m10:18:05.545537 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.13s]
[0m10:18:05.549041 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:18:05.550043 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:18:05.550927 [info ] [Thread-1 (]: 2 of 3 START sql table model public.film_actors ................................ [RUN]
[0m10:18:05.552380 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:18:05.553277 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:18:05.556267 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:18:05.562726 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:18:05.554088 => 2024-10-24 10:18:05.562666
[0m10:18:05.563376 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:18:05.567416 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:18:05.573556 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:18:05.574216 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:18:05.574858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:05.586062 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:18:05.587048 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:18:05.587803 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:18:05.590487 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m10:18:05.593529 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:18:05.594506 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m10:18:05.596356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:18:05.599907 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:18:05.600881 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m10:18:05.602642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:18:05.605180 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m10:18:05.605885 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:18:05.606499 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m10:18:05.609138 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m10:18:05.611542 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:18:05.612402 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m10:18:05.615860 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m10:18:05.617317 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:18:05.564004 => 2024-10-24 10:18:05.617275
[0m10:18:05.618222 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:18:05.619366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb651-8997-4655-8d6d-f41758f389e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a66799c0>]}
[0m10:18:05.620109 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.07s]
[0m10:18:05.621626 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:18:05.622538 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:18:05.623566 [info ] [Thread-1 (]: 3 of 3 START sql table model public.films ...................................... [RUN]
[0m10:18:05.625183 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:18:05.626022 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:18:05.628123 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:18:05.641138 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:18:05.626735 => 2024-10-24 10:18:05.641042
[0m10:18:05.642389 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:18:05.647568 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:18:05.660072 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:18:05.661221 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:18:05.662275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:05.680268 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:18:05.682107 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:18:05.683387 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM destination_db.public.films
  );
  
[0m10:18:05.687414 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m10:18:05.692238 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:18:05.693647 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m10:18:05.696430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:18:05.700741 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:18:05.702168 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m10:18:05.705463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:18:05.708670 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m10:18:05.710144 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:18:05.711546 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m10:18:05.716516 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m10:18:05.719872 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:18:05.721206 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m10:18:05.725938 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m10:18:05.728382 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:18:05.643527 => 2024-10-24 10:18:05.728338
[0m10:18:05.729689 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:18:05.731350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb651-8997-4655-8d6d-f41758f389e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a453a110>]}
[0m10:18:05.732588 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.11s]
[0m10:18:05.733984 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:18:05.736439 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:18:05.737625 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:05.738579 [debug] [MainThread]: On master: BEGIN
[0m10:18:05.739635 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:18:05.753250 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:18:05.754598 [debug] [MainThread]: On master: COMMIT
[0m10:18:05.755671 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:05.756542 [debug] [MainThread]: On master: COMMIT
[0m10:18:05.758603 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:18:05.759740 [debug] [MainThread]: On master: Close
[0m10:18:05.761168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:05.762020 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:18:05.763115 [info ] [MainThread]: 
[0m10:18:05.764539 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m10:18:05.765988 [debug] [MainThread]: Command end result
[0m10:18:05.781392 [info ] [MainThread]: 
[0m10:18:05.783468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:18:05.785450 [info ] [MainThread]: 
[0m10:18:05.787562 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:18:05.789262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a4540490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a4520250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a453a110>]}
[0m10:18:05.790834 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:18:26.668406 | cbbc8954-aa51-4add-88e4-4f8e3657f13d ==============================
[0m10:18:26.668406 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:18:26.670806 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:18:26.671886 [debug] [MainThread]: Tracking: tracking
[0m10:18:26.673854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18362d0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18362d780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18362d360>]}
[0m10:18:26.688410 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:18:26.817388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:18:26.818162 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:18:26.824728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbbc8954-aa51-4add-88e4-4f8e3657f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa181d600d0>]}
[0m10:18:26.863344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbbc8954-aa51-4add-88e4-4f8e3657f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa181d29270>]}
[0m10:18:26.868661 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:18:26.872226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbbc8954-aa51-4add-88e4-4f8e3657f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa181d292d0>]}
[0m10:18:26.875803 [info ] [MainThread]: 
[0m10:18:26.879344 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:18:26.882007 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:18:26.890517 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:18:26.892012 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:18:26.893734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:26.909185 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:18:26.911210 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:18:26.913579 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:18:26.918842 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:18:26.919914 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:18:26.920833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:26.931872 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:18:26.932674 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:18:26.933494 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:18:26.936987 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:18:26.938439 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:18:26.940153 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:18:26.944961 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:26.945973 [debug] [MainThread]: On master: BEGIN
[0m10:18:26.946694 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:18:26.957746 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:18:26.958688 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:26.959440 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:18:26.962935 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:18:26.964494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbbc8954-aa51-4add-88e4-4f8e3657f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa181d22680>]}
[0m10:18:26.965445 [debug] [MainThread]: On master: ROLLBACK
[0m10:18:26.966845 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:26.967790 [debug] [MainThread]: On master: BEGIN
[0m10:18:26.970159 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:18:26.971177 [debug] [MainThread]: On master: COMMIT
[0m10:18:26.972008 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:26.972805 [debug] [MainThread]: On master: COMMIT
[0m10:18:26.974409 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:18:26.975324 [debug] [MainThread]: On master: Close
[0m10:18:26.976359 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:18:26.978102 [info ] [MainThread]: 
[0m10:18:26.992580 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:18:26.993628 [info ] [Thread-1 (]: 1 of 3 START sql table model public.actors ..................................... [RUN]
[0m10:18:26.995114 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:18:26.995971 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:18:26.998747 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:18:27.005388 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:18:26.996734 => 2024-10-24 10:18:27.005319
[0m10:18:27.006170 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:18:27.036268 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:18:27.052725 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:18:27.053621 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:18:27.054386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:27.065342 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:18:27.066110 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:18:27.066941 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:18:27.074267 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:18:27.075053 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:18:27.076977 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:18:27.006923 => 2024-10-24 10:18:27.076907
[0m10:18:27.077883 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:18:27.083414 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:18:27.084449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbc8954-aa51-4add-88e4-4f8e3657f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa181bf6b30>]}
[0m10:18:27.085510 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.09s]
[0m10:18:27.087836 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:18:27.088787 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:18:27.089689 [info ] [Thread-1 (]: 2 of 3 START sql table model public.film_actors ................................ [RUN]
[0m10:18:27.091200 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:18:27.091947 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:18:27.095489 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:18:27.102847 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:18:27.092512 => 2024-10-24 10:18:27.102776
[0m10:18:27.103744 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:18:27.107598 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:18:27.114021 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:18:27.114767 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:18:27.115483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:27.127608 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:18:27.128491 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:18:27.129157 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:18:27.134694 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:18:27.135507 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:18:27.137325 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:18:27.104566 => 2024-10-24 10:18:27.137262
[0m10:18:27.138249 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:18:27.139728 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:18:27.140611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbc8954-aa51-4add-88e4-4f8e3657f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa181c3f910>]}
[0m10:18:27.141890 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.05s]
[0m10:18:27.143304 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:18:27.144130 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:18:27.145037 [info ] [Thread-1 (]: 3 of 3 START sql table model public.films ...................................... [RUN]
[0m10:18:27.146571 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:18:27.147452 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:18:27.149436 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:18:27.155883 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:18:27.148123 => 2024-10-24 10:18:27.155820
[0m10:18:27.156846 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:18:27.160654 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:18:27.166832 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:18:27.167547 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:18:27.168288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:27.180023 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:18:27.180908 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:18:27.181885 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM destination_db.public.films
  );
  
[0m10:18:27.185543 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM destination_db.public.films
                          ^

[0m10:18:27.188396 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:18:27.190139 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:18:27.157654 => 2024-10-24 10:18:27.190070
[0m10:18:27.191196 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:18:27.192573 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM destination_db.public.films
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:18:27.193874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbc8954-aa51-4add-88e4-4f8e3657f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa181bf6620>]}
[0m10:18:27.194984 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.05s]
[0m10:18:27.196235 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:18:27.198238 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:18:27.199170 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:27.200061 [debug] [MainThread]: On master: BEGIN
[0m10:18:27.200815 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:18:27.211871 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:18:27.212888 [debug] [MainThread]: On master: COMMIT
[0m10:18:27.214020 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:27.215012 [debug] [MainThread]: On master: COMMIT
[0m10:18:27.216700 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:18:27.217665 [debug] [MainThread]: On master: Close
[0m10:18:27.218903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:27.219489 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:18:27.220208 [info ] [MainThread]: 
[0m10:18:27.221918 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m10:18:27.223427 [debug] [MainThread]: Command end result
[0m10:18:27.255386 [info ] [MainThread]: 
[0m10:18:27.257681 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:18:27.259001 [info ] [MainThread]: 
[0m10:18:27.260449 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:18:27.262308 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:18:27.264405 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:18:27.266628 [error] [MainThread]:                             ^
[0m10:18:27.268450 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:18:27.270633 [info ] [MainThread]: 
[0m10:18:27.272917 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:18:27.274950 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:18:27.276340 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:18:27.278534 [error] [MainThread]:                             ^
[0m10:18:27.279609 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:18:27.280634 [info ] [MainThread]: 
[0m10:18:27.281589 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:18:27.283528 [error] [MainThread]:   relation "public.films" does not exist
[0m10:18:27.284746 [error] [MainThread]:   LINE 8:     SELECT * FROM destination_db.public.films
[0m10:18:27.285862 [error] [MainThread]:                             ^
[0m10:18:27.286821 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:18:27.287816 [info ] [MainThread]: 
[0m10:18:27.289044 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m10:18:27.290408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa181baeb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa181c3d990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa181c3c580>]}
[0m10:18:27.291726 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:19:24.004137 | b372e1a1-34e9-46b2-8f47-348da5444535 ==============================
[0m10:19:24.004137 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:19:24.007428 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:19:24.008220 [debug] [MainThread]: Tracking: tracking
[0m10:19:24.014424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c49690f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c49697b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c4969390>]}
[0m10:19:24.027359 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:19:24.166286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:19:24.167552 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/films.sql
[0m10:19:24.182703 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m10:19:24.235106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b372e1a1-34e9-46b2-8f47-348da5444535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c0f32560>]}
[0m10:19:24.426941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b372e1a1-34e9-46b2-8f47-348da5444535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c0ef7a00>]}
[0m10:19:24.428539 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:19:24.434306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b372e1a1-34e9-46b2-8f47-348da5444535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c49813f0>]}
[0m10:19:24.437954 [info ] [MainThread]: 
[0m10:19:24.442987 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:19:24.450219 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:19:24.462725 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:19:24.465229 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:19:24.467464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:24.497091 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:19:24.499071 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:19:24.501405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:19:24.507360 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:19:24.508357 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:19:24.509211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:24.521958 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:19:24.523029 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:19:24.523955 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:19:24.527670 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:19:24.529428 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:19:24.531454 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:19:24.536009 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:24.537059 [debug] [MainThread]: On master: BEGIN
[0m10:19:24.538002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:24.548959 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:19:24.549858 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:24.550792 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:19:24.554626 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:19:24.556234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b372e1a1-34e9-46b2-8f47-348da5444535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c0ef41f0>]}
[0m10:19:24.557330 [debug] [MainThread]: On master: ROLLBACK
[0m10:19:24.559058 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:24.559923 [debug] [MainThread]: On master: BEGIN
[0m10:19:24.562599 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:19:24.563300 [debug] [MainThread]: On master: COMMIT
[0m10:19:24.564134 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:24.564888 [debug] [MainThread]: On master: COMMIT
[0m10:19:24.566761 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:19:24.567524 [debug] [MainThread]: On master: Close
[0m10:19:24.568792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:19:24.570241 [info ] [MainThread]: 
[0m10:19:24.584485 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:19:24.590041 [info ] [Thread-1 (]: 1 of 3 START sql table model public.actors ..................................... [RUN]
[0m10:19:24.592928 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:19:24.608309 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:19:24.622262 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:19:24.752252 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:19:24.618041 => 2024-10-24 10:19:24.752090
[0m10:19:24.754039 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:19:24.784344 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:19:24.804687 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:19:24.805672 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:19:24.806639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:24.817376 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:19:24.818400 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:19:24.819377 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:19:24.822057 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:19:24.830747 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:19:24.832697 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:19:24.755089 => 2024-10-24 10:19:24.832627
[0m10:19:24.833649 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:19:24.839499 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:19:24.840771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b372e1a1-34e9-46b2-8f47-348da5444535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c0f9e9e0>]}
[0m10:19:24.842163 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.25s]
[0m10:19:24.844860 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:19:24.845874 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:19:24.846809 [info ] [Thread-1 (]: 2 of 3 START sql table model public.film_actors ................................ [RUN]
[0m10:19:24.848486 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:19:24.849359 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:19:24.853313 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:19:24.865577 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:19:24.850119 => 2024-10-24 10:19:24.865490
[0m10:19:24.866819 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:19:24.870905 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:19:24.879775 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:19:24.880946 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:19:24.882019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:24.896889 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:19:24.897841 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:19:24.898872 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:19:24.903558 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:19:24.910761 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:19:24.913605 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:19:24.867858 => 2024-10-24 10:19:24.913538
[0m10:19:24.914897 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:19:24.916868 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:19:24.918473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b372e1a1-34e9-46b2-8f47-348da5444535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c0f43220>]}
[0m10:19:24.921190 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m10:19:24.922858 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:19:24.924441 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:19:24.926355 [info ] [Thread-1 (]: 3 of 3 START sql table model public.films ...................................... [RUN]
[0m10:19:24.928189 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:19:24.929906 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:19:24.933860 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:19:24.952012 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:19:24.931673 => 2024-10-24 10:19:24.951915
[0m10:19:24.953695 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:19:24.959651 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:19:24.977448 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:19:24.978925 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:19:24.980669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:25.001533 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:19:25.002709 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:19:25.004475 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:19:25.009373 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m10:19:25.010639 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:19:25.013995 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:19:24.955303 => 2024-10-24 10:19:25.013910
[0m10:19:25.015459 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:19:25.017683 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:19:25.019350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b372e1a1-34e9-46b2-8f47-348da5444535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c0f42c80>]}
[0m10:19:25.021950 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.09s]
[0m10:19:25.023370 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:19:25.025855 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:19:25.027361 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:25.028953 [debug] [MainThread]: On master: BEGIN
[0m10:19:25.030641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:25.046019 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:19:25.047358 [debug] [MainThread]: On master: COMMIT
[0m10:19:25.048728 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:25.050228 [debug] [MainThread]: On master: COMMIT
[0m10:19:25.052751 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:19:25.054153 [debug] [MainThread]: On master: Close
[0m10:19:25.055807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:25.056858 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:19:25.058037 [info ] [MainThread]: 
[0m10:19:25.059204 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m10:19:25.060678 [debug] [MainThread]: Command end result
[0m10:19:25.078713 [info ] [MainThread]: 
[0m10:19:25.080301 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:19:25.082504 [info ] [MainThread]: 
[0m10:19:25.085289 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:19:25.087598 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:19:25.089492 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:19:25.091677 [error] [MainThread]:                             ^
[0m10:19:25.093820 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:19:25.095165 [info ] [MainThread]: 
[0m10:19:25.096390 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:19:25.097529 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:19:25.098514 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:19:25.099737 [error] [MainThread]:                             ^
[0m10:19:25.100876 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:19:25.102187 [info ] [MainThread]: 
[0m10:19:25.103480 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:19:25.105009 [error] [MainThread]:   relation "public.films" does not exist
[0m10:19:25.106153 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m10:19:25.107575 [error] [MainThread]:                             ^
[0m10:19:25.108682 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:19:25.109750 [info ] [MainThread]: 
[0m10:19:25.110968 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m10:19:25.112657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c0f42c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c0f420b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c0f9e890>]}
[0m10:19:25.114070 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:20:56.931540 | 9e26e6f2-67bc-4fa6-9e9a-21a0a5d01cbf ==============================
[0m10:20:56.931540 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:20:56.934099 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:20:56.934909 [debug] [MainThread]: Tracking: tracking
[0m10:20:56.940564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446962d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446962d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446962d390>]}
[0m10:20:56.952464 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:20:57.190715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:20:57.197026 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:20:57.208451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e26e6f2-67bc-4fa6-9e9a-21a0a5d01cbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4467d580d0>]}
[0m10:20:57.269512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e26e6f2-67bc-4fa6-9e9a-21a0a5d01cbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4467d21210>]}
[0m10:20:57.271529 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:20:57.273273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e26e6f2-67bc-4fa6-9e9a-21a0a5d01cbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4467d21240>]}
[0m10:20:57.276259 [info ] [MainThread]: 
[0m10:20:57.291993 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:20:57.296571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:20:57.308262 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:20:57.310449 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:20:57.312387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:57.337187 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:20:57.339109 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:20:57.341359 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:20:57.347378 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:20:57.348734 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:20:57.349580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:57.360702 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:20:57.363126 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:20:57.364182 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:20:57.368107 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:20:57.369848 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:20:57.371792 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:20:57.376884 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:57.377885 [debug] [MainThread]: On master: BEGIN
[0m10:20:57.378905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:20:57.390399 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:20:57.391632 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:57.392449 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:20:57.396721 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:20:57.398501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e26e6f2-67bc-4fa6-9e9a-21a0a5d01cbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4467d1e5f0>]}
[0m10:20:57.399454 [debug] [MainThread]: On master: ROLLBACK
[0m10:20:57.401139 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:57.401984 [debug] [MainThread]: On master: BEGIN
[0m10:20:57.404732 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:20:57.405641 [debug] [MainThread]: On master: COMMIT
[0m10:20:57.406515 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:57.407402 [debug] [MainThread]: On master: COMMIT
[0m10:20:57.409271 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:20:57.410231 [debug] [MainThread]: On master: Close
[0m10:20:57.411433 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:20:57.412733 [info ] [MainThread]: 
[0m10:20:57.427298 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:20:57.428846 [info ] [Thread-1 (]: 1 of 3 START sql table model public.actors ..................................... [RUN]
[0m10:20:57.430858 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:20:57.432015 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:20:57.435045 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:20:57.442687 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:20:57.432973 => 2024-10-24 10:20:57.442601
[0m10:20:57.443623 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:20:57.473934 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:20:57.480151 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:20:57.480794 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:20:57.481245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:57.493036 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:20:57.494471 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:20:57.495082 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:20:57.499599 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:20:57.501186 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:20:57.502661 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:20:57.444314 => 2024-10-24 10:20:57.502596
[0m10:20:57.504234 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:20:57.509059 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:20:57.510026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e26e6f2-67bc-4fa6-9e9a-21a0a5d01cbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4467c15270>]}
[0m10:20:57.510740 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.08s]
[0m10:20:57.513330 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:20:57.514130 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:20:57.514794 [info ] [Thread-1 (]: 2 of 3 START sql table model public.film_actors ................................ [RUN]
[0m10:20:57.515972 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:20:57.516441 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:20:57.520654 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:20:57.525217 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:20:57.516859 => 2024-10-24 10:20:57.525155
[0m10:20:57.526182 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:20:57.529720 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:20:57.533858 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:20:57.534529 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:20:57.535030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:57.546909 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:20:57.547888 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:20:57.548915 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:20:57.553753 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:20:57.554580 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:20:57.556052 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:20:57.527139 => 2024-10-24 10:20:57.555993
[0m10:20:57.556933 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:20:57.558131 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:20:57.559198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e26e6f2-67bc-4fa6-9e9a-21a0a5d01cbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4467bc8940>]}
[0m10:20:57.560236 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.04s]
[0m10:20:57.561548 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:20:57.562410 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:20:57.563191 [info ] [Thread-1 (]: 3 of 3 START sql table model public.films ...................................... [RUN]
[0m10:20:57.564845 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:20:57.565622 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:20:57.568312 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:20:57.575293 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:20:57.566140 => 2024-10-24 10:20:57.575206
[0m10:20:57.576030 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:20:57.580882 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:20:57.587489 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:20:57.588538 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:20:57.589299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:57.599749 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:20:57.600560 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:20:57.601403 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:20:57.607302 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m10:20:57.608179 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:20:57.610069 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:20:57.576914 => 2024-10-24 10:20:57.610003
[0m10:20:57.610954 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:20:57.612340 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:20:57.613138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e26e6f2-67bc-4fa6-9e9a-21a0a5d01cbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4467c15780>]}
[0m10:20:57.614212 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.05s]
[0m10:20:57.615589 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:20:57.617220 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:20:57.618094 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:57.618962 [debug] [MainThread]: On master: BEGIN
[0m10:20:57.619751 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:20:57.631009 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:20:57.632002 [debug] [MainThread]: On master: COMMIT
[0m10:20:57.632965 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:57.633643 [debug] [MainThread]: On master: COMMIT
[0m10:20:57.635298 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:20:57.636137 [debug] [MainThread]: On master: Close
[0m10:20:57.637272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:57.638026 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:20:57.639003 [info ] [MainThread]: 
[0m10:20:57.640732 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m10:20:57.642098 [debug] [MainThread]: Command end result
[0m10:20:57.653865 [info ] [MainThread]: 
[0m10:20:57.658568 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:20:57.662974 [info ] [MainThread]: 
[0m10:20:57.666873 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:20:57.668423 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:20:57.669770 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:20:57.671392 [error] [MainThread]:                             ^
[0m10:20:57.672551 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:20:57.673761 [info ] [MainThread]: 
[0m10:20:57.674885 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:20:57.675934 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:20:57.676957 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:20:57.678029 [error] [MainThread]:                             ^
[0m10:20:57.679001 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:20:57.680318 [info ] [MainThread]: 
[0m10:20:57.682074 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:20:57.683645 [error] [MainThread]:   relation "public.films" does not exist
[0m10:20:57.685302 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m10:20:57.687010 [error] [MainThread]:                             ^
[0m10:20:57.688358 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:20:57.689949 [info ] [MainThread]: 
[0m10:20:57.691717 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m10:20:57.693246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4467da2da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4467bc9de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4467bc9fc0>]}
[0m10:20:57.694656 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:21:49.903917 | 76fcb9a6-b50c-4715-ba06-168e6c830ded ==============================
[0m10:21:49.903917 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:21:49.907547 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:21:49.908347 [debug] [MainThread]: Tracking: tracking
[0m10:21:49.915495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a9bf0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a9bf3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a9bf0af0>]}
[0m10:21:49.998741 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:21:50.388787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:21:50.390181 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:21:50.396115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76fcb9a6-b50c-4715-ba06-168e6c830ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a82880d0>]}
[0m10:21:50.409524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76fcb9a6-b50c-4715-ba06-168e6c830ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a8339090>]}
[0m10:21:50.410224 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:21:50.438631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76fcb9a6-b50c-4715-ba06-168e6c830ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ab599b70>]}
[0m10:21:50.443056 [info ] [MainThread]: 
[0m10:21:50.447139 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:21:50.451657 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:21:50.462340 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:21:50.464849 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:21:50.466345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:50.491466 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:21:50.493494 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:21:50.504931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:21:50.520680 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:21:50.533824 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:21:50.553921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:21:50.653698 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:21:50.654939 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:21:50.656170 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:21:50.669145 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m10:21:50.671716 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:21:50.674349 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:21:50.681504 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:50.682720 [debug] [MainThread]: On master: BEGIN
[0m10:21:50.683564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:21:50.694897 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:21:50.695813 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:50.696744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:21:50.704317 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:21:50.706375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76fcb9a6-b50c-4715-ba06-168e6c830ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a8288e50>]}
[0m10:21:50.707385 [debug] [MainThread]: On master: ROLLBACK
[0m10:21:50.709337 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:50.710241 [debug] [MainThread]: On master: BEGIN
[0m10:21:50.713032 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:21:50.713948 [debug] [MainThread]: On master: COMMIT
[0m10:21:50.714821 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:50.715702 [debug] [MainThread]: On master: COMMIT
[0m10:21:50.717413 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:21:50.718300 [debug] [MainThread]: On master: Close
[0m10:21:50.719498 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:21:50.721621 [info ] [MainThread]: 
[0m10:21:50.725765 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:21:50.726996 [info ] [Thread-1 (]: 1 of 3 START sql table model public.actors ..................................... [RUN]
[0m10:21:50.728301 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:21:50.729284 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:21:50.732447 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:21:50.739792 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:21:50.730175 => 2024-10-24 10:21:50.739723
[0m10:21:50.740674 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:21:50.771463 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:21:50.782459 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:21:50.783145 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:21:50.783971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:50.795728 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:21:50.796720 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:21:50.797606 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:21:50.801940 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m10:21:50.808091 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:21:50.808934 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m10:21:50.811812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:21:50.814398 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:21:50.815205 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m10:21:50.816960 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:21:50.835644 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m10:21:50.837178 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:21:50.838538 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m10:21:50.841742 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m10:21:50.846324 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:21:50.847114 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m10:21:50.851469 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m10:21:50.853119 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:21:50.741291 => 2024-10-24 10:21:50.853073
[0m10:21:50.853911 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:21:50.855148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76fcb9a6-b50c-4715-ba06-168e6c830ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a82dd090>]}
[0m10:21:50.856024 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.13s]
[0m10:21:50.859175 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:21:50.860209 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:21:50.861163 [info ] [Thread-1 (]: 2 of 3 START sql table model public.film_actors ................................ [RUN]
[0m10:21:50.862258 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:21:50.863153 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:21:50.866036 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:21:50.872739 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:21:50.863918 => 2024-10-24 10:21:50.872596
[0m10:21:50.873562 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:21:50.877441 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:21:50.884039 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:21:50.884903 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:21:50.885642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:50.896202 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:21:50.897261 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:21:50.897947 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:21:50.901199 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m10:21:50.904491 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:21:50.905479 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m10:21:50.923594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:21:50.934780 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:21:50.985965 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m10:21:51.019695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:21:51.045181 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m10:21:51.068456 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:21:51.071134 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m10:21:51.076874 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m10:21:51.081121 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:21:51.082676 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m10:21:51.087120 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m10:21:51.089966 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:21:50.874185 => 2024-10-24 10:21:51.089908
[0m10:21:51.091512 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:21:51.093439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76fcb9a6-b50c-4715-ba06-168e6c830ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a82dd180>]}
[0m10:21:51.095078 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.23s]
[0m10:21:51.097287 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:21:51.098722 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:21:51.100069 [info ] [Thread-1 (]: 3 of 3 START sql table model public.films ...................................... [RUN]
[0m10:21:51.101790 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:21:51.103230 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:21:51.106793 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:21:51.119070 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:21:51.104447 => 2024-10-24 10:21:51.118991
[0m10:21:51.120236 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:21:51.126148 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:21:51.135874 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:21:51.136785 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:21:51.137437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:51.151007 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:21:51.151898 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:21:51.152799 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:21:51.155662 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m10:21:51.158686 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:21:51.159422 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m10:21:51.161587 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:21:51.164474 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:21:51.165364 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m10:21:51.167212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:21:51.169455 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m10:21:51.170279 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:21:51.170976 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m10:21:51.173655 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m10:21:51.175968 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:21:51.176765 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m10:21:51.180627 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m10:21:51.182266 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:21:51.121391 => 2024-10-24 10:21:51.182222
[0m10:21:51.183071 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:21:51.184284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76fcb9a6-b50c-4715-ba06-168e6c830ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a81b7d30>]}
[0m10:21:51.185131 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.08s]
[0m10:21:51.186936 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:21:51.188970 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:21:51.189983 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:51.190695 [debug] [MainThread]: On master: BEGIN
[0m10:21:51.191401 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:21:51.202120 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:21:51.203187 [debug] [MainThread]: On master: COMMIT
[0m10:21:51.204011 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:51.204875 [debug] [MainThread]: On master: COMMIT
[0m10:21:51.206276 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:21:51.207004 [debug] [MainThread]: On master: Close
[0m10:21:51.208039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:21:51.208763 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:21:51.209560 [info ] [MainThread]: 
[0m10:21:51.210568 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m10:21:51.211490 [debug] [MainThread]: Command end result
[0m10:21:51.223630 [info ] [MainThread]: 
[0m10:21:51.225331 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:21:51.227040 [info ] [MainThread]: 
[0m10:21:51.240225 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:21:51.241476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a8338eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a8338e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a81d6b90>]}
[0m10:21:51.242567 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:26:20.946301 | 2e7d15a2-b51a-42cf-8d5d-01b684468114 ==============================
[0m10:26:20.946301 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:26:20.949813 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:26:20.950774 [debug] [MainThread]: Tracking: tracking
[0m10:26:20.956923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98258110c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9825811780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9825811360>]}
[0m10:26:20.968318 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:26:21.308024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:26:21.336540 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:26:21.358049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e7d15a2-b51a-42cf-8d5d-01b684468114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9823f400d0>]}
[0m10:26:21.421738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e7d15a2-b51a-42cf-8d5d-01b684468114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9823f09270>]}
[0m10:26:21.423490 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:26:21.425320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7d15a2-b51a-42cf-8d5d-01b684468114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9823f092a0>]}
[0m10:26:21.428570 [info ] [MainThread]: 
[0m10:26:21.455764 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:26:21.476072 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:26:21.489994 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:26:21.491273 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:26:21.492387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:21.517815 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:26:21.519751 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:26:21.522141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:26:21.528282 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:26:21.529328 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:26:21.530172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:21.541341 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:26:21.542203 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:26:21.542965 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:26:21.546549 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:26:21.548402 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:26:21.550198 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:26:21.554900 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:21.555965 [debug] [MainThread]: On master: BEGIN
[0m10:26:21.556690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:26:21.579520 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:26:21.580633 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:21.581645 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:26:21.585891 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:26:21.587662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7d15a2-b51a-42cf-8d5d-01b684468114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9823f072e0>]}
[0m10:26:21.588809 [debug] [MainThread]: On master: ROLLBACK
[0m10:26:21.590663 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:21.591373 [debug] [MainThread]: On master: BEGIN
[0m10:26:21.593767 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:26:21.594589 [debug] [MainThread]: On master: COMMIT
[0m10:26:21.595399 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:21.596149 [debug] [MainThread]: On master: COMMIT
[0m10:26:21.597829 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:26:21.598654 [debug] [MainThread]: On master: Close
[0m10:26:21.599722 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:26:21.601618 [info ] [MainThread]: 
[0m10:26:21.616745 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:26:21.617887 [info ] [Thread-1 (]: 1 of 3 START sql table model public.actors ..................................... [RUN]
[0m10:26:21.619334 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:26:21.620222 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:26:21.623061 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:26:21.629920 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:26:21.620927 => 2024-10-24 10:26:21.629850
[0m10:26:21.630839 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:26:21.660875 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:26:21.812585 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:26:21.813966 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:26:21.815205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:21.831676 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:26:21.832815 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:26:21.833641 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:26:21.836004 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:26:21.836800 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:26:21.838746 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:26:21.631549 => 2024-10-24 10:26:21.838679
[0m10:26:21.839413 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:26:21.845287 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:26:21.846268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7d15a2-b51a-42cf-8d5d-01b684468114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9823e01210>]}
[0m10:26:21.847527 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.23s]
[0m10:26:21.849738 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:26:21.850671 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:26:21.851810 [info ] [Thread-1 (]: 2 of 3 START sql table model public.film_actors ................................ [RUN]
[0m10:26:21.852787 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:26:21.853697 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:26:21.857291 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:26:21.864224 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:26:21.854423 => 2024-10-24 10:26:21.864157
[0m10:26:21.865385 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:26:21.869521 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:26:21.876290 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:26:21.877103 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:26:21.877788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:21.888931 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:26:21.889843 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:26:21.890817 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:26:21.892932 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:26:21.893867 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:26:21.895578 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:26:21.866128 => 2024-10-24 10:26:21.895517
[0m10:26:21.896391 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:26:21.897562 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:26:21.898428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7d15a2-b51a-42cf-8d5d-01b684468114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9823db45e0>]}
[0m10:26:21.899415 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.05s]
[0m10:26:21.903247 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:26:21.907326 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:26:21.911720 [info ] [Thread-1 (]: 3 of 3 START sql table model public.films ...................................... [RUN]
[0m10:26:21.913304 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:26:21.914617 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:26:21.917839 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:26:21.925551 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:26:21.915660 => 2024-10-24 10:26:21.925483
[0m10:26:21.926327 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:26:21.930243 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:26:21.937390 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:26:21.938226 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:26:21.939098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:21.950945 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:26:21.951972 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:26:21.952924 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:26:21.955162 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m10:26:21.955937 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:26:21.957883 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:26:21.927069 => 2024-10-24 10:26:21.957812
[0m10:26:21.958730 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:26:21.960076 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:26:21.961080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7d15a2-b51a-42cf-8d5d-01b684468114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9823e01720>]}
[0m10:26:21.962032 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.05s]
[0m10:26:21.962957 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:26:21.964810 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:26:21.965848 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:21.966678 [debug] [MainThread]: On master: BEGIN
[0m10:26:21.967520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:26:21.980323 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:26:21.981394 [debug] [MainThread]: On master: COMMIT
[0m10:26:21.982228 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:21.982945 [debug] [MainThread]: On master: COMMIT
[0m10:26:21.984560 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:26:21.985640 [debug] [MainThread]: On master: Close
[0m10:26:21.986791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:21.987466 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:26:21.988538 [info ] [MainThread]: 
[0m10:26:21.989398 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m10:26:21.990250 [debug] [MainThread]: Command end result
[0m10:26:22.002812 [info ] [MainThread]: 
[0m10:26:22.017087 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:26:22.019149 [info ] [MainThread]: 
[0m10:26:22.021869 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:26:22.023256 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:26:22.024718 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:26:22.025600 [error] [MainThread]:                             ^
[0m10:26:22.026429 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:26:22.027280 [info ] [MainThread]: 
[0m10:26:22.028132 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:26:22.029040 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:26:22.030411 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:26:22.031508 [error] [MainThread]:                             ^
[0m10:26:22.032493 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:26:22.033604 [info ] [MainThread]: 
[0m10:26:22.034890 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:26:22.036084 [error] [MainThread]:   relation "public.films" does not exist
[0m10:26:22.037292 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m10:26:22.038454 [error] [MainThread]:                             ^
[0m10:26:22.039494 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:26:22.040543 [info ] [MainThread]: 
[0m10:26:22.041581 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m10:26:22.042655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9823d90ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9823db6f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9823db60b0>]}
[0m10:26:22.043858 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:26:31.812496 | 508d0116-d427-4ea3-93fc-bff2425d3b79 ==============================
[0m10:26:31.812496 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:26:31.815118 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:26:31.816095 [debug] [MainThread]: Tracking: tracking
[0m10:26:31.818120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94f850ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94f853010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94f850a60>]}
[0m10:26:31.856451 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:26:32.151011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:26:32.153605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:26:32.162145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '508d0116-d427-4ea3-93fc-bff2425d3b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94dee40d0>]}
[0m10:26:32.188786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '508d0116-d427-4ea3-93fc-bff2425d3b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94df9d0c0>]}
[0m10:26:32.190680 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:26:32.192897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '508d0116-d427-4ea3-93fc-bff2425d3b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9512ce620>]}
[0m10:26:32.196214 [info ] [MainThread]: 
[0m10:26:32.200131 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:26:32.203870 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:26:32.217836 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:26:32.220372 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:26:32.223169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:32.243476 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:26:32.245886 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:26:32.248861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:26:32.255109 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:26:32.256467 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:26:32.257673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:32.271567 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:26:32.273162 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:26:32.274215 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:26:32.279098 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m10:26:32.281187 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:26:32.283938 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:26:32.291021 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:32.292289 [debug] [MainThread]: On master: BEGIN
[0m10:26:32.293582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:26:32.308646 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:26:32.310259 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:32.311213 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:26:32.316783 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:26:32.318950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '508d0116-d427-4ea3-93fc-bff2425d3b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94dee4e50>]}
[0m10:26:32.320388 [debug] [MainThread]: On master: ROLLBACK
[0m10:26:32.322992 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:32.324281 [debug] [MainThread]: On master: BEGIN
[0m10:26:32.327992 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:26:32.329072 [debug] [MainThread]: On master: COMMIT
[0m10:26:32.329979 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:32.330822 [debug] [MainThread]: On master: COMMIT
[0m10:26:32.332913 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:26:32.333821 [debug] [MainThread]: On master: Close
[0m10:26:32.335172 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:26:32.336496 [info ] [MainThread]: 
[0m10:26:32.341295 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:26:32.342665 [info ] [Thread-1 (]: 1 of 3 START sql table model public.actors ..................................... [RUN]
[0m10:26:32.344224 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:26:32.345386 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:26:32.348402 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:26:32.359491 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:26:32.346293 => 2024-10-24 10:26:32.359387
[0m10:26:32.360775 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:26:32.392482 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:26:32.416355 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:26:32.417826 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:26:32.418994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:32.438518 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:26:32.440823 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:26:32.441939 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:26:32.446382 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m10:26:32.454720 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:26:32.456334 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m10:26:32.460764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:26:32.464562 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:26:32.466039 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m10:26:32.469575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:26:32.489466 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m10:26:32.491713 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:26:32.493698 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m10:26:32.498478 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m10:26:32.503696 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:26:32.505148 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m10:26:32.510229 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m10:26:32.512466 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:26:32.362062 => 2024-10-24 10:26:32.512421
[0m10:26:32.513557 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:26:32.515234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '508d0116-d427-4ea3-93fc-bff2425d3b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94df3d090>]}
[0m10:26:32.516842 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.17s]
[0m10:26:32.520402 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:26:32.521440 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:26:32.522769 [info ] [Thread-1 (]: 2 of 3 START sql table model public.film_actors ................................ [RUN]
[0m10:26:32.524749 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:26:32.526242 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:26:32.529609 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:26:32.537773 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:26:32.527367 => 2024-10-24 10:26:32.537693
[0m10:26:32.538655 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:26:32.543378 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:26:32.550821 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:26:32.551690 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:26:32.552696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:32.564368 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:26:32.565702 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:26:32.566674 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:26:32.569710 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m10:26:32.573041 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:26:32.573898 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m10:26:32.575798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:26:32.578843 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:26:32.579799 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m10:26:32.581630 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:26:32.583812 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m10:26:32.584898 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:26:32.585948 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m10:26:32.589687 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m10:26:32.592234 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:26:32.593002 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m10:26:32.596596 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m10:26:32.598278 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:26:32.539410 => 2024-10-24 10:26:32.598233
[0m10:26:32.599107 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:26:32.600323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '508d0116-d427-4ea3-93fc-bff2425d3b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94df3d180>]}
[0m10:26:32.601154 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.08s]
[0m10:26:32.602487 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:26:32.603396 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:26:32.604475 [info ] [Thread-1 (]: 3 of 3 START sql table model public.films ...................................... [RUN]
[0m10:26:32.605990 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:26:32.606948 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:26:32.609771 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:26:32.616641 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:26:32.607645 => 2024-10-24 10:26:32.616581
[0m10:26:32.617410 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:26:32.622475 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:26:32.629624 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:26:32.630491 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:26:32.631252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:32.644005 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:26:32.644923 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:26:32.645769 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:26:32.648572 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m10:26:32.651811 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:26:32.653031 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m10:26:32.655048 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:26:32.658217 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:26:32.659126 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m10:26:32.661001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:26:32.663128 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m10:26:32.664223 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:26:32.665213 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m10:26:32.668530 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m10:26:32.671315 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:26:32.672299 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m10:26:32.676375 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m10:26:32.678253 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:26:32.618063 => 2024-10-24 10:26:32.678206
[0m10:26:32.679517 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:26:32.680641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '508d0116-d427-4ea3-93fc-bff2425d3b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94de0be50>]}
[0m10:26:32.681483 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.07s]
[0m10:26:32.683066 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:26:32.685322 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:26:32.686389 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:32.687352 [debug] [MainThread]: On master: BEGIN
[0m10:26:32.688164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:26:32.701929 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:26:32.702982 [debug] [MainThread]: On master: COMMIT
[0m10:26:32.703815 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:32.704592 [debug] [MainThread]: On master: COMMIT
[0m10:26:32.706311 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:26:32.707220 [debug] [MainThread]: On master: Close
[0m10:26:32.708380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:32.709100 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:26:32.710179 [info ] [MainThread]: 
[0m10:26:32.711657 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m10:26:32.712930 [debug] [MainThread]: Command end result
[0m10:26:32.725931 [info ] [MainThread]: 
[0m10:26:32.728647 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:26:32.734547 [info ] [MainThread]: 
[0m10:26:32.736228 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:26:32.738311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94df9cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94df9cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94de2abc0>]}
[0m10:26:32.740908 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:33:58.523918 | 8a10fdb6-4ad5-41a5-b766-4dd87d364efd ==============================
[0m10:33:58.523918 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:33:58.527325 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:33:58.527982 [debug] [MainThread]: Tracking: tracking
[0m10:33:58.534587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04bde1d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04bde1d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04bde1d390>]}
[0m10:33:58.547388 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:33:58.560483 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:33:58.561806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a10fdb6-4ad5-41a5-b766-4dd87d364efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04bde1c0a0>]}
[0m10:33:59.093915 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m10:33:59.105380 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m10:33:59.109612 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m10:33:59.112856 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m10:33:59.210451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a10fdb6-4ad5-41a5-b766-4dd87d364efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04bc52f580>]}
[0m10:33:59.240228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a10fdb6-4ad5-41a5-b766-4dd87d364efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04bde1cd90>]}
[0m10:33:59.242944 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:33:59.246423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a10fdb6-4ad5-41a5-b766-4dd87d364efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04bde1c3d0>]}
[0m10:33:59.253969 [info ] [MainThread]: 
[0m10:33:59.258955 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:33:59.262965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:33:59.273524 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:33:59.275350 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:33:59.277017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:59.305773 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:33:59.308112 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:33:59.310768 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:33:59.317336 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:33:59.319060 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:33:59.320615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:33:59.335588 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:33:59.336917 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:33:59.338407 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:33:59.343432 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:33:59.346221 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:33:59.348924 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:33:59.353994 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:59.355312 [debug] [MainThread]: On master: BEGIN
[0m10:33:59.356512 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:33:59.370322 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:33:59.372240 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:59.373309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:33:59.377345 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:33:59.379613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a10fdb6-4ad5-41a5-b766-4dd87d364efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04bde1c6a0>]}
[0m10:33:59.380988 [debug] [MainThread]: On master: ROLLBACK
[0m10:33:59.383348 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:59.384894 [debug] [MainThread]: On master: BEGIN
[0m10:33:59.388117 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:33:59.389479 [debug] [MainThread]: On master: COMMIT
[0m10:33:59.390394 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:59.391586 [debug] [MainThread]: On master: COMMIT
[0m10:33:59.394431 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:33:59.395336 [debug] [MainThread]: On master: Close
[0m10:33:59.396867 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:33:59.398658 [info ] [MainThread]: 
[0m10:33:59.413469 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:33:59.415246 [info ] [Thread-1 (]: 1 of 3 START sql table model public.actors ..................................... [RUN]
[0m10:33:59.417002 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:33:59.418636 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:33:59.422081 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:33:59.434435 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:33:59.419878 => 2024-10-24 10:33:59.434333
[0m10:33:59.435853 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:33:59.470446 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:33:59.482212 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:33:59.483419 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:33:59.484323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:59.497695 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:33:59.498785 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:33:59.499863 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:33:59.504942 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:33:59.510141 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:33:59.512503 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:33:59.437760 => 2024-10-24 10:33:59.512427
[0m10:33:59.513560 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:33:59.518791 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:33:59.520119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a10fdb6-4ad5-41a5-b766-4dd87d364efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ba444ee0>]}
[0m10:33:59.521949 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.10s]
[0m10:33:59.525126 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:33:59.526636 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:33:59.527745 [info ] [Thread-1 (]: 2 of 3 START sql table model public.film_actors ................................ [RUN]
[0m10:33:59.529649 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:33:59.530853 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:33:59.534515 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:33:59.543653 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:33:59.532210 => 2024-10-24 10:33:59.543558
[0m10:33:59.544697 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:33:59.549191 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:33:59.557585 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:33:59.558855 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:33:59.559914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:59.574291 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:33:59.575469 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:33:59.576354 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:33:59.579093 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:33:59.583180 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:33:59.586454 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:33:59.545910 => 2024-10-24 10:33:59.586383
[0m10:33:59.587679 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:33:59.589152 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:33:59.590477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a10fdb6-4ad5-41a5-b766-4dd87d364efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ba483010>]}
[0m10:33:59.592427 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.06s]
[0m10:33:59.593986 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:33:59.595185 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:33:59.596285 [info ] [Thread-1 (]: 3 of 3 START sql table model public.films ...................................... [RUN]
[0m10:33:59.598309 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:33:59.599463 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:33:59.602941 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:33:59.613611 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:33:59.600559 => 2024-10-24 10:33:59.613525
[0m10:33:59.614707 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:33:59.619998 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:33:59.632283 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:33:59.633619 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:33:59.634596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:59.650175 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:33:59.651467 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:33:59.652946 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:33:59.656689 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m10:33:59.657959 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:33:59.660802 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:33:59.615593 => 2024-10-24 10:33:59.660718
[0m10:33:59.662178 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:33:59.663998 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:33:59.666414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a10fdb6-4ad5-41a5-b766-4dd87d364efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ba300dc0>]}
[0m10:33:59.667835 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m10:33:59.669070 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:33:59.671328 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:33:59.672757 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:59.673986 [debug] [MainThread]: On master: BEGIN
[0m10:33:59.675306 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:33:59.691010 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:33:59.692714 [debug] [MainThread]: On master: COMMIT
[0m10:33:59.693716 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:59.694560 [debug] [MainThread]: On master: COMMIT
[0m10:33:59.697104 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:33:59.698389 [debug] [MainThread]: On master: Close
[0m10:33:59.699742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:59.700902 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:33:59.702133 [info ] [MainThread]: 
[0m10:33:59.703934 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m10:33:59.705556 [debug] [MainThread]: Command end result
[0m10:33:59.724245 [info ] [MainThread]: 
[0m10:33:59.726645 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:33:59.728856 [info ] [MainThread]: 
[0m10:33:59.730779 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:33:59.732928 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:33:59.735311 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:33:59.737056 [error] [MainThread]:                             ^
[0m10:33:59.739289 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:33:59.741436 [info ] [MainThread]: 
[0m10:33:59.744144 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:33:59.746226 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:33:59.747415 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:33:59.748675 [error] [MainThread]:                             ^
[0m10:33:59.750753 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:33:59.752614 [info ] [MainThread]: 
[0m10:33:59.754923 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:33:59.757372 [error] [MainThread]:   relation "public.films" does not exist
[0m10:33:59.759831 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m10:33:59.761450 [error] [MainThread]:                             ^
[0m10:33:59.762907 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:33:59.764489 [info ] [MainThread]: 
[0m10:33:59.765605 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m10:33:59.767530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ba3016c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ba3016f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04bc57bf10>]}
[0m10:33:59.769180 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:38:16.135482 | 97c6a86e-c30f-4ddf-a5be-bbd5e7e638ee ==============================
[0m10:38:16.135482 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:38:16.139750 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:38:16.141024 [debug] [MainThread]: Tracking: tracking
[0m10:38:16.147749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5eb061360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5eb0617e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5eb0613c0>]}
[0m10:38:16.159811 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:38:16.304593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:38:16.305478 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:38:16.311484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97c6a86e-c30f-4ddf-a5be-bbd5e7e638ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e97940d0>]}
[0m10:38:16.321984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97c6a86e-c30f-4ddf-a5be-bbd5e7e638ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e97652d0>]}
[0m10:38:16.322683 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:38:16.324516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97c6a86e-c30f-4ddf-a5be-bbd5e7e638ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e9765300>]}
[0m10:38:16.326754 [info ] [MainThread]: 
[0m10:38:16.330130 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:38:16.332695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:38:16.341504 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:38:16.342847 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:38:16.343482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:16.371580 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:38:16.374198 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:38:16.376785 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:38:16.382671 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:38:16.384098 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:38:16.385286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:16.399071 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:38:16.400704 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:38:16.402217 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:38:16.406969 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:38:16.409280 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:38:16.411707 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:38:16.416953 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:16.418381 [debug] [MainThread]: On master: BEGIN
[0m10:38:16.419675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:38:16.433872 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:38:16.435130 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:16.435930 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:38:16.440513 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:38:16.442706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97c6a86e-c30f-4ddf-a5be-bbd5e7e638ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e974bd30>]}
[0m10:38:16.444161 [debug] [MainThread]: On master: ROLLBACK
[0m10:38:16.446915 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:16.448244 [debug] [MainThread]: On master: BEGIN
[0m10:38:16.451808 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:38:16.452915 [debug] [MainThread]: On master: COMMIT
[0m10:38:16.453947 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:16.455017 [debug] [MainThread]: On master: COMMIT
[0m10:38:16.456862 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:38:16.458048 [debug] [MainThread]: On master: Close
[0m10:38:16.459695 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:38:16.462515 [info ] [MainThread]: 
[0m10:38:16.477014 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:38:16.478968 [info ] [Thread-1 (]: 1 of 3 START sql table model public.actors ..................................... [RUN]
[0m10:38:16.478774 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:38:16.480384 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:38:16.483672 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:38:16.493183 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:38:16.481487 => 2024-10-24 10:38:16.493063
[0m10:38:16.494388 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:38:16.525606 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:38:16.538324 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:38:16.539044 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:38:16.539852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:16.550834 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:38:16.551922 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:38:16.552795 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:38:16.555366 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:38:16.561235 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:38:16.563126 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:38:16.495447 => 2024-10-24 10:38:16.563053
[0m10:38:16.564061 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:38:16.569756 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:38:16.570954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97c6a86e-c30f-4ddf-a5be-bbd5e7e638ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e962eb00>]}
[0m10:38:16.572474 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.09s]
[0m10:38:16.575011 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:38:16.576576 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:38:16.578114 [info ] [Thread-1 (]: 2 of 3 START sql table model public.film_actors ................................ [RUN]
[0m10:38:16.579813 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:38:16.580894 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:38:16.585019 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:38:16.596860 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:38:16.582005 => 2024-10-24 10:38:16.596761
[0m10:38:16.602582 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:38:16.620453 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:38:16.770198 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:38:16.771950 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:38:16.773322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:16.791295 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:38:16.792731 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:38:16.793800 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:38:16.796048 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:38:16.798677 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:38:16.804261 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:38:16.614759 => 2024-10-24 10:38:16.804188
[0m10:38:16.805260 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:38:16.806794 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:38:16.807780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97c6a86e-c30f-4ddf-a5be-bbd5e7e638ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e96085b0>]}
[0m10:38:16.808868 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.23s]
[0m10:38:16.810238 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:38:16.811324 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:38:16.812455 [info ] [Thread-1 (]: 3 of 3 START sql table model public.films ...................................... [RUN]
[0m10:38:16.814481 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:38:16.815534 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:38:16.818337 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:38:16.825787 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:38:16.816226 => 2024-10-24 10:38:16.825691
[0m10:38:16.826978 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:38:16.830957 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:38:16.838000 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:38:16.838903 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:38:16.839628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:16.852255 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:38:16.853483 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:38:16.854492 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:38:16.857467 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m10:38:16.860414 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:38:16.865714 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:38:16.827823 => 2024-10-24 10:38:16.865447
[0m10:38:16.868781 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:38:16.874331 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:38:16.875846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97c6a86e-c30f-4ddf-a5be-bbd5e7e638ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e962e5f0>]}
[0m10:38:16.877217 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.06s]
[0m10:38:16.878697 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:38:16.881382 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:38:16.882633 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:16.883626 [debug] [MainThread]: On master: BEGIN
[0m10:38:16.884611 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:38:16.898646 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:38:16.900119 [debug] [MainThread]: On master: COMMIT
[0m10:38:16.901695 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:16.902976 [debug] [MainThread]: On master: COMMIT
[0m10:38:16.905637 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:38:16.907006 [debug] [MainThread]: On master: Close
[0m10:38:16.908818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:16.910254 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:38:16.911510 [info ] [MainThread]: 
[0m10:38:16.913587 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m10:38:16.916699 [debug] [MainThread]: Command end result
[0m10:38:16.937554 [info ] [MainThread]: 
[0m10:38:16.940791 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:38:16.943425 [info ] [MainThread]: 
[0m10:38:16.945488 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:38:16.948505 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:38:16.952318 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:38:16.953577 [error] [MainThread]:                             ^
[0m10:38:16.955915 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:38:16.957989 [info ] [MainThread]: 
[0m10:38:16.959950 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:38:16.961588 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:38:16.963614 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:38:16.965301 [error] [MainThread]:                             ^
[0m10:38:16.966673 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:38:16.968886 [info ] [MainThread]: 
[0m10:38:16.971180 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:38:16.972742 [error] [MainThread]:   relation "public.films" does not exist
[0m10:38:16.974543 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m10:38:16.977499 [error] [MainThread]:                             ^
[0m10:38:16.979153 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:38:16.980659 [info ] [MainThread]: 
[0m10:38:16.982698 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m10:38:16.984296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e9664e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e960a380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e9608160>]}
[0m10:38:16.985600 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:43:00.988862 | ad7035f1-2ed4-4817-9f08-bdf7d431ba93 ==============================
[0m10:43:00.988862 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:43:00.992835 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:43:00.994018 [debug] [MainThread]: Tracking: tracking
[0m10:43:01.000535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ea7ed0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ea7ed7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ea7ed390>]}
[0m10:43:01.016169 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:43:01.217577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:43:01.219348 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:43:01.227790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad7035f1-2ed4-4817-9f08-bdf7d431ba93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e8f200d0>]}
[0m10:43:01.246184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad7035f1-2ed4-4817-9f08-bdf7d431ba93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e8ee92a0>]}
[0m10:43:01.264653 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:43:01.273875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad7035f1-2ed4-4817-9f08-bdf7d431ba93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e8ee92d0>]}
[0m10:43:01.278714 [info ] [MainThread]: 
[0m10:43:01.283025 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:43:01.286504 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:43:01.299447 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:43:01.301979 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:43:01.304380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:01.347119 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:43:01.349377 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:43:01.352344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:43:01.358537 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:43:01.360042 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:43:01.361640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:01.377324 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:43:01.378248 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:43:01.379166 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:43:01.384409 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:43:01.386355 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:43:01.388624 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:43:01.393314 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:01.394315 [debug] [MainThread]: On master: BEGIN
[0m10:43:01.395178 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:01.407709 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:43:01.408698 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:01.409661 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:43:01.416524 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:43:01.418529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad7035f1-2ed4-4817-9f08-bdf7d431ba93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e8ed7d00>]}
[0m10:43:01.419686 [debug] [MainThread]: On master: ROLLBACK
[0m10:43:01.421713 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:01.422682 [debug] [MainThread]: On master: BEGIN
[0m10:43:01.425502 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:43:01.426493 [debug] [MainThread]: On master: COMMIT
[0m10:43:01.427411 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:01.428339 [debug] [MainThread]: On master: COMMIT
[0m10:43:01.430248 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:43:01.431050 [debug] [MainThread]: On master: Close
[0m10:43:01.432165 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:43:01.433521 [info ] [MainThread]: 
[0m10:43:01.449224 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:43:01.451800 [info ] [Thread-1 (]: 1 of 3 START sql table model public.actors ..................................... [RUN]
[0m10:43:01.453168 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:43:01.454081 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:43:01.457222 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:43:01.464924 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:43:01.455053 => 2024-10-24 10:43:01.464782
[0m10:43:01.466399 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:43:01.495931 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:43:01.520564 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:43:01.522231 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:43:01.523563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:01.540162 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:43:01.541657 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:43:01.542848 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:43:01.547627 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:43:01.552062 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:43:01.554244 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:43:01.467281 => 2024-10-24 10:43:01.554175
[0m10:43:01.555272 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:43:01.560933 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:43:01.562265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7035f1-2ed4-4817-9f08-bdf7d431ba93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e8d9f520>]}
[0m10:43:01.563779 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m10:43:01.566535 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:43:01.568016 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:43:01.569274 [info ] [Thread-1 (]: 2 of 3 START sql table model public.film_actors ................................ [RUN]
[0m10:43:01.571045 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:43:01.572320 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:43:01.576558 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:43:01.585227 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:43:01.573543 => 2024-10-24 10:43:01.585152
[0m10:43:01.586180 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:43:01.590048 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:43:01.597117 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:43:01.598090 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:43:01.598814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:01.612805 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:43:01.613819 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:43:01.614923 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:43:01.618206 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:43:01.624575 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:43:01.626616 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:43:01.587054 => 2024-10-24 10:43:01.626547
[0m10:43:01.627642 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:43:01.629033 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:43:01.629875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7035f1-2ed4-4817-9f08-bdf7d431ba93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e8dff730>]}
[0m10:43:01.630979 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.06s]
[0m10:43:01.633670 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:43:01.634621 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:43:01.635597 [info ] [Thread-1 (]: 3 of 3 START sql table model public.films ...................................... [RUN]
[0m10:43:01.637181 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:43:01.638172 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:43:01.641166 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:43:01.648605 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:43:01.639026 => 2024-10-24 10:43:01.648518
[0m10:43:01.649625 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:43:01.653457 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:43:01.659623 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:43:01.660468 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:43:01.661327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:01.686407 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:43:01.687459 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:43:01.688884 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:43:01.692012 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m10:43:01.695670 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:43:01.700154 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:43:01.650438 => 2024-10-24 10:43:01.700066
[0m10:43:01.701898 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:43:01.704055 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:43:01.705474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7035f1-2ed4-4817-9f08-bdf7d431ba93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e8d9fa30>]}
[0m10:43:01.707012 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m10:43:01.708184 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:43:01.710565 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:43:01.711934 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:01.713263 [debug] [MainThread]: On master: BEGIN
[0m10:43:01.714358 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:43:01.729127 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:43:01.730711 [debug] [MainThread]: On master: COMMIT
[0m10:43:01.731809 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:01.733333 [debug] [MainThread]: On master: COMMIT
[0m10:43:01.736235 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:43:01.737804 [debug] [MainThread]: On master: Close
[0m10:43:01.739608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:01.740775 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:43:01.742213 [info ] [MainThread]: 
[0m10:43:01.743507 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m10:43:01.745124 [debug] [MainThread]: Command end result
[0m10:43:01.764928 [info ] [MainThread]: 
[0m10:43:01.766730 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:43:01.768164 [info ] [MainThread]: 
[0m10:43:01.769400 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:43:01.770684 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:43:01.771863 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:43:01.774680 [error] [MainThread]:                             ^
[0m10:43:01.776633 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:43:01.778170 [info ] [MainThread]: 
[0m10:43:01.779426 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:43:01.780545 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:43:01.782101 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:43:01.783785 [error] [MainThread]:                             ^
[0m10:43:01.785041 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:43:01.786326 [info ] [MainThread]: 
[0m10:43:01.787438 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:43:01.788607 [error] [MainThread]:   relation "public.films" does not exist
[0m10:43:01.789621 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m10:43:01.790524 [error] [MainThread]:                             ^
[0m10:43:01.791521 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:43:01.792464 [info ] [MainThread]: 
[0m10:43:01.793318 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m10:43:01.794501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e8df1240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e8dffa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e8dfdfc0>]}
[0m10:43:01.795699 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:49:06.104556 | d1a55ba4-9967-41ef-a8c2-d8cfb4b82034 ==============================
[0m10:49:06.104556 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:49:06.107255 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:49:06.108529 [debug] [MainThread]: Tracking: tracking
[0m10:49:06.114857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67539c10f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67539c17b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67539c1390>]}
[0m10:49:06.131185 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:49:06.148965 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:49:06.150447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd1a55ba4-9967-41ef-a8c2-d8cfb4b82034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67539c00a0>]}
[0m10:49:06.720857 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m10:49:06.730960 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m10:49:06.733937 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m10:49:06.737289 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m10:49:06.815733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1a55ba4-9967-41ef-a8c2-d8cfb4b82034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67520cb580>]}
[0m10:49:06.853607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1a55ba4-9967-41ef-a8c2-d8cfb4b82034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67520cb4f0>]}
[0m10:49:06.858779 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:49:06.866502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1a55ba4-9967-41ef-a8c2-d8cfb4b82034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67539d84f0>]}
[0m10:49:06.889300 [info ] [MainThread]: 
[0m10:49:06.893697 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:49:06.897670 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:49:06.913254 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:49:06.914829 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:49:06.915628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:06.941707 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:49:06.943551 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:49:06.946159 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:49:06.952214 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:49:06.953225 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:49:06.954263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:06.965291 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:49:06.966707 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:49:06.967906 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:49:06.972417 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:49:06.974671 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:49:06.976798 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:49:06.981872 [debug] [MainThread]: Using postgres connection "master"
[0m10:49:06.983072 [debug] [MainThread]: On master: BEGIN
[0m10:49:06.983996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:49:06.995904 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:49:06.996816 [debug] [MainThread]: Using postgres connection "master"
[0m10:49:06.997817 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:49:07.001932 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:49:07.003601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1a55ba4-9967-41ef-a8c2-d8cfb4b82034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6713f3f8b0>]}
[0m10:49:07.004805 [debug] [MainThread]: On master: ROLLBACK
[0m10:49:07.006464 [debug] [MainThread]: Using postgres connection "master"
[0m10:49:07.007313 [debug] [MainThread]: On master: BEGIN
[0m10:49:07.010454 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:49:07.011657 [debug] [MainThread]: On master: COMMIT
[0m10:49:07.012456 [debug] [MainThread]: Using postgres connection "master"
[0m10:49:07.013320 [debug] [MainThread]: On master: COMMIT
[0m10:49:07.015098 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:49:07.016043 [debug] [MainThread]: On master: Close
[0m10:49:07.017100 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:49:07.018315 [info ] [MainThread]: 
[0m10:49:07.033300 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:49:07.034711 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m10:49:07.036350 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:49:07.037325 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:49:07.040290 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:49:07.049361 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:49:07.038045 => 2024-10-24 10:49:07.049258
[0m10:49:07.050374 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:49:07.082492 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:49:07.130098 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:49:07.132794 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:49:07.135194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:07.156212 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:49:07.157339 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:49:07.158628 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:49:07.161652 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:49:07.166471 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:49:07.169254 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:49:07.051185 => 2024-10-24 10:49:07.169167
[0m10:49:07.170160 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:49:07.176493 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:49:07.178258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1a55ba4-9967-41ef-a8c2-d8cfb4b82034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6713fc4eb0>]}
[0m10:49:07.180010 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m10:49:07.182638 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:49:07.183901 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:49:07.185180 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m10:49:07.186679 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:49:07.187725 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:49:07.190881 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:49:07.199985 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:49:07.188502 => 2024-10-24 10:49:07.199893
[0m10:49:07.201157 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:49:07.205479 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:49:07.215707 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:49:07.216746 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:49:07.218210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:07.233329 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:49:07.234817 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:49:07.235957 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:49:07.238965 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:49:07.240367 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:49:07.246926 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:49:07.202100 => 2024-10-24 10:49:07.246700
[0m10:49:07.249063 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:49:07.251162 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:49:07.252555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1a55ba4-9967-41ef-a8c2-d8cfb4b82034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6713fa7010>]}
[0m10:49:07.253760 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m10:49:07.254756 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:49:07.255692 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:49:07.257032 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m10:49:07.259003 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:49:07.260176 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:49:07.263365 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:49:07.273651 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:49:07.261173 => 2024-10-24 10:49:07.273568
[0m10:49:07.275590 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:49:07.281107 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:49:07.305372 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:49:07.307248 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:49:07.309097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:07.331558 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:49:07.334187 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:49:07.335733 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:49:07.339571 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m10:49:07.344494 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:49:07.348210 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:49:07.276902 => 2024-10-24 10:49:07.348140
[0m10:49:07.349907 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:49:07.351630 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:49:07.352948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1a55ba4-9967-41ef-a8c2-d8cfb4b82034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6713e7cdc0>]}
[0m10:49:07.354272 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.09s]
[0m10:49:07.355771 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:49:07.357313 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m10:49:07.358336 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m10:49:07.359827 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m10:49:07.362053 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:49:07.363210 [debug] [MainThread]: Using postgres connection "master"
[0m10:49:07.364306 [debug] [MainThread]: On master: BEGIN
[0m10:49:07.365250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:49:07.378608 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:49:07.379644 [debug] [MainThread]: On master: COMMIT
[0m10:49:07.380940 [debug] [MainThread]: Using postgres connection "master"
[0m10:49:07.381984 [debug] [MainThread]: On master: COMMIT
[0m10:49:07.384648 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:49:07.385955 [debug] [MainThread]: On master: Close
[0m10:49:07.387631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:07.388592 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:49:07.389627 [info ] [MainThread]: 
[0m10:49:07.391007 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m10:49:07.392443 [debug] [MainThread]: Command end result
[0m10:49:07.413612 [info ] [MainThread]: 
[0m10:49:07.415583 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:49:07.417556 [info ] [MainThread]: 
[0m10:49:07.419556 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:49:07.421318 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:49:07.423266 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:49:07.425156 [error] [MainThread]:                             ^
[0m10:49:07.426877 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:49:07.428581 [info ] [MainThread]: 
[0m10:49:07.430329 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:49:07.431810 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:49:07.433074 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:49:07.434316 [error] [MainThread]:                             ^
[0m10:49:07.435532 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:49:07.436593 [info ] [MainThread]: 
[0m10:49:07.437858 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:49:07.438935 [error] [MainThread]:   relation "public.films" does not exist
[0m10:49:07.439895 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m10:49:07.441158 [error] [MainThread]:                             ^
[0m10:49:07.442261 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:49:07.443574 [info ] [MainThread]: 
[0m10:49:07.444551 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m10:49:07.445571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6713e7d6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6713e7cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6713e7d780>]}
[0m10:49:07.446586 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:51:05.483633 | f53528bb-e58e-4f67-8606-77cdf490aced ==============================
[0m10:51:05.483633 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:51:05.486658 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:51:05.488106 [debug] [MainThread]: Tracking: tracking
[0m10:51:05.495030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabe4490f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabe4497b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabe449390>]}
[0m10:51:05.508638 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:51:05.523441 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:51:05.524894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f53528bb-e58e-4f67-8606-77cdf490aced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabe448130>]}
[0m10:51:06.062024 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m10:51:06.073469 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m10:51:06.077644 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m10:51:06.082189 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m10:51:06.147830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabcb9fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabcb80f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabcb803a0>]}
[0m10:51:06.180314 [debug] [MainThread]: Flushing usage events
[0m10:51:07.531418 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.custom_postgres.actors' (models/example/actors.sql) depends on a source named 'destination_db.actors' which was not found


============================== 2024-10-24 10:51:45.491164 | e8c38b80-65f5-46d5-8f9c-c545d88be333 ==============================
[0m10:51:45.491164 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:51:45.493786 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:51:45.494699 [debug] [MainThread]: Tracking: tracking
[0m10:51:45.496513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dea5d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dea5d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dea5d3c0>]}
[0m10:51:45.508588 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:51:45.522229 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:51:45.523655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e8c38b80-65f5-46d5-8f9c-c545d88be333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dea5c0a0>]}
[0m10:51:46.106475 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m10:51:46.116948 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m10:51:46.120487 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m10:51:46.124904 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m10:51:46.263801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dd1b3b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dd195cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dd194340>]}
[0m10:51:46.266182 [debug] [MainThread]: Flushing usage events
[0m10:51:47.362062 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.custom_postgres.actors' (models/example/actors.sql) depends on a source named 'destination_db.actors' which was not found


============================== 2024-10-24 10:54:55.129964 | 73293357-5247-433a-af7d-03e38cfb4c0a ==============================
[0m10:54:55.129964 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:54:55.133057 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:54:55.134502 [debug] [MainThread]: Tracking: tracking
[0m10:54:55.142705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcaeb50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcaeb57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcaeb5390>]}
[0m10:54:55.156078 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:54:55.171868 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:54:55.173103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '73293357-5247-433a-af7d-03e38cfb4c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcaeb4130>]}
[0m10:54:55.697155 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m10:54:55.708051 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m10:54:55.711809 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m10:54:55.716217 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m10:54:55.803033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73293357-5247-433a-af7d-03e38cfb4c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc95c34f0>]}
[0m10:54:55.876706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73293357-5247-433a-af7d-03e38cfb4c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcb0362c0>]}
[0m10:54:55.881234 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:54:55.886278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73293357-5247-433a-af7d-03e38cfb4c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcaeb4460>]}
[0m10:54:55.889632 [info ] [MainThread]: 
[0m10:54:55.895360 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:54:55.898374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:54:55.909280 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:54:55.911870 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:54:55.914001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:55.948646 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:54:55.951488 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:54:55.954469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:54:55.961839 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:54:55.963375 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:54:55.964855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:54:55.979368 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:54:55.980865 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:54:55.981854 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:54:55.986100 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:54:55.988299 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:54:55.990721 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:54:55.995903 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:55.996942 [debug] [MainThread]: On master: BEGIN
[0m10:54:55.997881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:54:56.010159 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:54:56.011405 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:56.012253 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:54:56.016637 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:54:56.018367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73293357-5247-433a-af7d-03e38cfb4c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc805b8b0>]}
[0m10:54:56.019413 [debug] [MainThread]: On master: ROLLBACK
[0m10:54:56.021764 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:56.022597 [debug] [MainThread]: On master: BEGIN
[0m10:54:56.026125 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:54:56.028461 [debug] [MainThread]: On master: COMMIT
[0m10:54:56.031192 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:56.031937 [debug] [MainThread]: On master: COMMIT
[0m10:54:56.034238 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:54:56.035171 [debug] [MainThread]: On master: Close
[0m10:54:56.036438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:54:56.039585 [info ] [MainThread]: 
[0m10:54:56.060516 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:54:56.061875 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m10:54:56.064214 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:54:56.065662 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:54:56.069144 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:54:56.091714 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:54:56.066586 => 2024-10-24 10:54:56.091510
[0m10:54:56.094199 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:54:56.128285 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:54:56.147036 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:54:56.148544 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:54:56.149954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:56.166053 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:54:56.167618 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:54:56.168602 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:54:56.172967 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:54:56.175991 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:54:56.179434 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:54:56.095955 => 2024-10-24 10:54:56.179357
[0m10:54:56.180649 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:54:56.186413 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:54:56.188072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73293357-5247-433a-af7d-03e38cfb4c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc80e4f40>]}
[0m10:54:56.189859 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.12s]
[0m10:54:56.192133 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:54:56.193799 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:54:56.194896 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m10:54:56.196474 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:54:56.197638 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:54:56.200910 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:54:56.209995 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:54:56.198680 => 2024-10-24 10:54:56.209918
[0m10:54:56.211453 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:54:56.215923 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:54:56.225870 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:54:56.227009 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:54:56.228016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:56.243281 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:54:56.244854 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:54:56.246118 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:54:56.248997 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:54:56.251156 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:54:56.255198 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:54:56.212715 => 2024-10-24 10:54:56.255045
[0m10:54:56.256730 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:54:56.258744 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:54:56.260095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73293357-5247-433a-af7d-03e38cfb4c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc8107010>]}
[0m10:54:56.261512 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.06s]
[0m10:54:56.263193 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:54:56.264315 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:54:56.265472 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m10:54:56.267199 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:54:56.268411 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:54:56.271700 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:54:56.281093 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:54:56.269294 => 2024-10-24 10:54:56.281019
[0m10:54:56.282312 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:54:56.287344 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:54:56.296925 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:54:56.298110 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:54:56.299233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:56.339195 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:54:56.340268 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:54:56.341258 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:54:56.344056 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m10:54:56.349301 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:54:56.352348 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:54:56.283422 => 2024-10-24 10:54:56.352272
[0m10:54:56.353877 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:54:56.355951 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:54:56.357408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73293357-5247-433a-af7d-03e38cfb4c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefa3369720>]}
[0m10:54:56.359945 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.09s]
[0m10:54:56.361439 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:54:56.363302 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m10:54:56.364592 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m10:54:56.366524 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m10:54:56.368790 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:54:56.370125 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:56.371548 [debug] [MainThread]: On master: BEGIN
[0m10:54:56.372674 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:54:56.429380 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:54:56.431072 [debug] [MainThread]: On master: COMMIT
[0m10:54:56.432193 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:56.433320 [debug] [MainThread]: On master: COMMIT
[0m10:54:56.435455 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:54:56.436413 [debug] [MainThread]: On master: Close
[0m10:54:56.437780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:54:56.438732 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:54:56.440259 [info ] [MainThread]: 
[0m10:54:56.441890 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m10:54:56.443516 [debug] [MainThread]: Command end result
[0m10:54:56.465775 [info ] [MainThread]: 
[0m10:54:56.467553 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:54:56.469271 [info ] [MainThread]: 
[0m10:54:56.470837 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:54:56.472814 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:54:56.474214 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:54:56.475951 [error] [MainThread]:                             ^
[0m10:54:56.477562 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:54:56.479170 [info ] [MainThread]: 
[0m10:54:56.480643 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:54:56.481895 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:54:56.482854 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:54:56.484107 [error] [MainThread]:                             ^
[0m10:54:56.485212 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:54:56.486569 [info ] [MainThread]: 
[0m10:54:56.487789 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:54:56.488778 [error] [MainThread]:   relation "public.films" does not exist
[0m10:54:56.489861 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m10:54:56.491008 [error] [MainThread]:                             ^
[0m10:54:56.492235 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:54:56.493435 [info ] [MainThread]: 
[0m10:54:56.494813 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m10:54:56.496224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefa3380130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc96108e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc9610ca0>]}
[0m10:54:56.497788 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:55:21.921334 | 32ed6e0b-5889-444b-8062-716993162967 ==============================
[0m10:55:21.921334 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:55:21.925410 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:55:21.926671 [debug] [MainThread]: Tracking: tracking
[0m10:55:21.928457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3342d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3342d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3342d3c0>]}
[0m10:55:21.942694 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:55:22.069306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:55:22.070230 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:55:22.075967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32ed6e0b-5889-444b-8062-716993162967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac31b5c0d0>]}
[0m10:55:22.090782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32ed6e0b-5889-444b-8062-716993162967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac31b291b0>]}
[0m10:55:22.108216 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:55:22.113336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ed6e0b-5889-444b-8062-716993162967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac31b29210>]}
[0m10:55:22.116755 [info ] [MainThread]: 
[0m10:55:22.119792 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:55:22.122395 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:55:22.133668 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:55:22.135640 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:55:22.136692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:22.152127 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:55:22.154079 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:55:22.156375 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:55:22.162202 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:55:22.163174 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:55:22.164043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:55:22.176464 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:55:22.177990 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:55:22.178890 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:55:22.182557 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m10:55:22.184427 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:55:22.186244 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:55:22.192904 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:22.194132 [debug] [MainThread]: On master: BEGIN
[0m10:55:22.195060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:55:22.207215 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:55:22.208335 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:22.209352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:55:22.214146 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:55:22.215835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ed6e0b-5889-444b-8062-716993162967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac31b225c0>]}
[0m10:55:22.216846 [debug] [MainThread]: On master: ROLLBACK
[0m10:55:22.218700 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:22.219448 [debug] [MainThread]: On master: BEGIN
[0m10:55:22.222859 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:55:22.223722 [debug] [MainThread]: On master: COMMIT
[0m10:55:22.224552 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:22.225284 [debug] [MainThread]: On master: COMMIT
[0m10:55:22.226819 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:55:22.227639 [debug] [MainThread]: On master: Close
[0m10:55:22.228825 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:55:22.231684 [info ] [MainThread]: 
[0m10:55:22.244826 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:55:22.246390 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m10:55:22.248205 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:55:22.249320 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:55:22.252788 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:55:22.261077 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:55:22.250544 => 2024-10-24 10:55:22.260985
[0m10:55:22.262050 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:55:22.296057 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:55:22.305223 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:55:22.306329 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:55:22.307620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:22.319193 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:55:22.320050 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:55:22.320826 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:55:22.323661 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m10:55:22.330632 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:55:22.331684 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m10:55:22.334179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:55:22.337997 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:55:22.338962 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m10:55:22.341039 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:55:22.361798 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m10:55:22.363685 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:55:22.364721 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m10:55:22.368159 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m10:55:22.373261 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:55:22.374351 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m10:55:22.378798 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m10:55:22.380559 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:55:22.262802 => 2024-10-24 10:55:22.380512
[0m10:55:22.381484 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:55:22.383200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ed6e0b-5889-444b-8062-716993162967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac31a0e950>]}
[0m10:55:22.384016 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.14s]
[0m10:55:22.386761 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:55:22.388338 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:55:22.389397 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m10:55:22.390829 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:55:22.391713 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:55:22.394632 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:55:22.401069 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:55:22.392475 => 2024-10-24 10:55:22.401001
[0m10:55:22.401955 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:55:22.406440 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:55:22.412611 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:55:22.413444 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:55:22.414178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:22.427193 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:55:22.428349 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:55:22.429482 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:55:22.432243 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m10:55:22.435468 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:55:22.436342 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m10:55:22.438574 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:55:22.441362 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:55:22.442609 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m10:55:22.444390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:55:22.446832 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m10:55:22.448053 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:55:22.449401 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m10:55:22.452660 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m10:55:22.455741 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:55:22.456757 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m10:55:22.460537 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m10:55:22.462013 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:55:22.403118 => 2024-10-24 10:55:22.461969
[0m10:55:22.462947 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:55:22.464192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ed6e0b-5889-444b-8062-716993162967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac31a0ece0>]}
[0m10:55:22.465240 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.07s]
[0m10:55:22.466843 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:55:22.467926 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:55:22.468660 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m10:55:22.470389 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:55:22.471251 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:55:22.475140 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:55:22.481314 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:55:22.471895 => 2024-10-24 10:55:22.481215
[0m10:55:22.482155 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:55:22.487316 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:55:22.493097 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:55:22.493913 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:55:22.494667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:22.506082 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:55:22.507821 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:55:22.508801 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:55:22.511387 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m10:55:22.514485 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:55:22.515331 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m10:55:22.517024 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:55:22.520133 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:55:22.521293 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m10:55:22.523516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m10:55:22.525679 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m10:55:22.526630 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:55:22.527371 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m10:55:22.530291 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m10:55:22.532733 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:55:22.533655 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m10:55:22.537330 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m10:55:22.539473 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:55:22.482718 => 2024-10-24 10:55:22.539429
[0m10:55:22.540449 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:55:22.541545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ed6e0b-5889-444b-8062-716993162967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac31a91ed0>]}
[0m10:55:22.542352 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.07s]
[0m10:55:22.543681 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:55:22.545043 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m10:55:22.546067 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m10:55:22.547792 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m10:55:22.548680 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m10:55:22.552033 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m10:55:22.560501 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-10-24 10:55:22.549363 => 2024-10-24 10:55:22.560408
[0m10:55:22.561402 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m10:55:22.565542 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m10:55:22.581019 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m10:55:22.582265 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m10:55:22.583386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:22.599045 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:55:22.600130 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m10:55:22.601160 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings as (
    SELECT film_id,
            title,
            release_date,
            price,
            rating,
            user_rating,
            CASE WHEN user_rating >= 4.5 THEN 'Excellent'
                WHEN user_rating BETWEEN 4 AND 4.5 THEN 'Good'
                WHEN user_rating BETWEEN 3 AND 4 THEN 'Average'
                ELSE 'Bad' 
                END as rating_category
    FROM "destination_db"."public"."films"

)
films_with_actors AS (
  SELECT
    f.film_id,
    f.title,
    STRING_AGG(a.actor_name, ',') AS actors
  FROM "destination_db"."public"."films" f
  LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
  LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
  GROUP BY f.film_id, f.title
)

SELECT fwr.*,
       fwa.actors
FROM films_with_ratings fwr
LEFT JOIN films_with_actors fwa
ON fwr.film_id = fwa. film_id
  );
  
[0m10:55:22.604848 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "films_with_actors"
LINE 23: films_with_actors AS (
         ^

[0m10:55:22.605950 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m10:55:22.608296 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-10-24 10:55:22.562266 => 2024-10-24 10:55:22.608224
[0m10:55:22.609152 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m10:55:22.612082 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near "films_with_actors"
  LINE 23: films_with_actors AS (
           ^
  compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m10:55:22.613386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ed6e0b-5889-444b-8062-716993162967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac300824d0>]}
[0m10:55:22.614306 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.07s]
[0m10:55:22.615271 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m10:55:22.617749 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:55:22.618717 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:22.619483 [debug] [MainThread]: On master: BEGIN
[0m10:55:22.620455 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:55:22.634013 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:55:22.635630 [debug] [MainThread]: On master: COMMIT
[0m10:55:22.636825 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:22.638084 [debug] [MainThread]: On master: COMMIT
[0m10:55:22.640399 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:55:22.641625 [debug] [MainThread]: On master: Close
[0m10:55:22.643117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:55:22.646038 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m10:55:22.647381 [info ] [MainThread]: 
[0m10:55:22.648858 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m10:55:22.650466 [debug] [MainThread]: Command end result
[0m10:55:22.686666 [info ] [MainThread]: 
[0m10:55:22.696105 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:55:22.701330 [info ] [MainThread]: 
[0m10:55:22.709178 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m10:55:22.711157 [error] [MainThread]:   syntax error at or near "films_with_actors"
[0m10:55:22.713340 [error] [MainThread]:   LINE 23: films_with_actors AS (
[0m10:55:22.715101 [error] [MainThread]:            ^
[0m10:55:22.717180 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m10:55:22.719138 [info ] [MainThread]: 
[0m10:55:22.720832 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m10:55:22.722902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac31b28d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac31a91ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac319bd690>]}
[0m10:55:22.723903 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:57:05.157855 | b6663d4a-1df0-4daf-a467-1d926b951819 ==============================
[0m10:57:05.157855 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:57:05.162109 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:57:05.163387 [debug] [MainThread]: Tracking: tracking
[0m10:57:05.170042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86c05d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86c05d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86c05d3c0>]}
[0m10:57:05.182568 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:57:05.310339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:57:05.311309 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m10:57:05.327535 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m10:57:05.351237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6663d4a-1df0-4daf-a467-1d926b951819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86a7cd600>]}
[0m10:57:05.376377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6663d4a-1df0-4daf-a467-1d926b951819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86a73fd60>]}
[0m10:57:05.377213 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:57:05.378597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6663d4a-1df0-4daf-a467-1d926b951819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86c0693c0>]}
[0m10:57:05.380870 [info ] [MainThread]: 
[0m10:57:05.398884 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:57:05.402246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:57:05.413382 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:57:05.415324 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:57:05.417468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:05.457018 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:57:05.471344 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:57:05.487136 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:57:05.495051 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:57:05.496669 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:57:05.498377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:05.552690 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:57:05.554512 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:57:05.556094 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:57:05.564520 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:57:05.582892 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:57:05.602390 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:57:05.607920 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:05.608966 [debug] [MainThread]: On master: BEGIN
[0m10:57:05.609841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:05.621673 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:57:05.622719 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:05.623688 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:57:05.627639 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:57:05.629400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6663d4a-1df0-4daf-a467-1d926b951819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86860bc10>]}
[0m10:57:05.630600 [debug] [MainThread]: On master: ROLLBACK
[0m10:57:05.632604 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:05.633670 [debug] [MainThread]: On master: BEGIN
[0m10:57:05.636337 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:57:05.637319 [debug] [MainThread]: On master: COMMIT
[0m10:57:05.638237 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:05.639146 [debug] [MainThread]: On master: COMMIT
[0m10:57:05.640839 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:57:05.641794 [debug] [MainThread]: On master: Close
[0m10:57:05.642977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:05.644094 [info ] [MainThread]: 
[0m10:57:05.658269 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:57:05.659657 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m10:57:05.661253 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:57:05.662210 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:57:05.665147 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:57:05.671762 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:57:05.663017 => 2024-10-24 10:57:05.671683
[0m10:57:05.672847 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:57:05.703478 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:57:05.715417 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:57:05.717019 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:57:05.717805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:05.740496 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:57:05.741407 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:57:05.742325 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:57:05.748558 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:57:05.749533 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:57:05.751220 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:57:05.673589 => 2024-10-24 10:57:05.751146
[0m10:57:05.752095 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:57:05.758196 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:57:05.759389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6663d4a-1df0-4daf-a467-1d926b951819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8686204c0>]}
[0m10:57:05.760564 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.10s]
[0m10:57:05.762947 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:57:05.764065 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:57:05.765127 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m10:57:05.766816 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:57:05.767750 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:57:05.770666 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:57:05.777037 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:57:05.768519 => 2024-10-24 10:57:05.776971
[0m10:57:05.777835 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:57:05.781704 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:57:05.788333 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:57:05.789121 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:57:05.789989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:05.802819 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:57:05.803872 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:57:05.804854 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:57:05.808652 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:57:05.812435 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:57:05.814199 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:57:05.778643 => 2024-10-24 10:57:05.814129
[0m10:57:05.815221 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:57:05.817079 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:57:05.817984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6663d4a-1df0-4daf-a467-1d926b951819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86868b7c0>]}
[0m10:57:05.819121 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.05s]
[0m10:57:05.820606 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:57:05.821623 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:57:05.822454 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m10:57:05.823874 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:57:05.824804 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:57:05.827774 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:57:05.834745 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:57:05.825514 => 2024-10-24 10:57:05.834659
[0m10:57:05.835692 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:57:05.840719 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:57:05.846991 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:57:05.847954 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:57:05.848676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:05.861083 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:57:05.862147 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:57:05.863160 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:57:05.867190 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m10:57:05.870760 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:57:05.872850 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:57:05.836521 => 2024-10-24 10:57:05.872784
[0m10:57:05.873762 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:57:05.875271 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:57:05.876006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6663d4a-1df0-4daf-a467-1d926b951819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff868520880>]}
[0m10:57:05.877015 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.05s]
[0m10:57:05.878242 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:57:05.879655 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m10:57:05.880600 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m10:57:05.881843 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m10:57:05.883807 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:57:05.884730 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:05.885626 [debug] [MainThread]: On master: BEGIN
[0m10:57:05.886469 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:05.897524 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:57:05.898442 [debug] [MainThread]: On master: COMMIT
[0m10:57:05.899408 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:05.900292 [debug] [MainThread]: On master: COMMIT
[0m10:57:05.902112 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:57:05.903086 [debug] [MainThread]: On master: Close
[0m10:57:05.904303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:05.904949 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:57:05.905854 [info ] [MainThread]: 
[0m10:57:05.907417 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m10:57:05.908633 [debug] [MainThread]: Command end result
[0m10:57:05.920946 [info ] [MainThread]: 
[0m10:57:05.922239 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:57:05.931993 [info ] [MainThread]: 
[0m10:57:05.935788 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:57:05.937496 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:57:05.939267 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:57:05.941070 [error] [MainThread]:                             ^
[0m10:57:05.942373 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:57:05.943600 [info ] [MainThread]: 
[0m10:57:05.944907 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:57:05.946126 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:57:05.947634 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:57:05.949180 [error] [MainThread]:                             ^
[0m10:57:05.950470 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:57:05.951729 [info ] [MainThread]: 
[0m10:57:05.952742 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:57:05.953862 [error] [MainThread]:   relation "public.films" does not exist
[0m10:57:05.955059 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m10:57:05.956410 [error] [MainThread]:                             ^
[0m10:57:05.957834 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:57:05.959004 [info ] [MainThread]: 
[0m10:57:05.960215 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m10:57:05.961684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86860b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86860bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86860a740>]}
[0m10:57:05.962555 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:58:06.212320 | 99d8c9ae-b7f7-4223-b6f4-6cd0f056cfc6 ==============================
[0m10:58:06.212320 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:58:06.217208 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:58:06.218598 [debug] [MainThread]: Tracking: tracking
[0m10:58:06.223115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeda3c10f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeda3c17b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeda3c1390>]}
[0m10:58:06.245543 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:58:06.503333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:58:06.504721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:58:06.513960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99d8c9ae-b7f7-4223-b6f4-6cd0f056cfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed8aec0d0>]}
[0m10:58:06.540276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99d8c9ae-b7f7-4223-b6f4-6cd0f056cfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed8ab91e0>]}
[0m10:58:06.541992 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:58:06.544379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99d8c9ae-b7f7-4223-b6f4-6cd0f056cfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed8ab9240>]}
[0m10:58:06.547326 [info ] [MainThread]: 
[0m10:58:06.551002 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:58:06.554026 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:58:06.568677 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:58:06.570353 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:58:06.571637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:06.622079 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:58:06.624455 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:58:06.627975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:58:06.635235 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:58:06.636741 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:58:06.638020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:06.658697 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:58:06.660602 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:58:06.661793 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:58:06.667920 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:58:06.670290 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:58:06.673236 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:58:06.679237 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:06.680695 [debug] [MainThread]: On master: BEGIN
[0m10:58:06.681955 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:58:06.705269 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:58:06.706946 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:06.708266 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:58:06.714369 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:58:06.717198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99d8c9ae-b7f7-4223-b6f4-6cd0f056cfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed8ab8040>]}
[0m10:58:06.718778 [debug] [MainThread]: On master: ROLLBACK
[0m10:58:06.721894 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:06.723164 [debug] [MainThread]: On master: BEGIN
[0m10:58:06.729014 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:58:06.730715 [debug] [MainThread]: On master: COMMIT
[0m10:58:06.732132 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:06.733471 [debug] [MainThread]: On master: COMMIT
[0m10:58:06.736560 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:58:06.737826 [debug] [MainThread]: On master: Close
[0m10:58:06.739583 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:58:06.741673 [info ] [MainThread]: 
[0m10:58:06.761494 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:58:06.763559 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m10:58:06.765846 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:58:06.767410 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:58:06.771116 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:58:06.783726 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:58:06.768536 => 2024-10-24 10:58:06.783594
[0m10:58:06.785055 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:58:06.829894 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:58:06.846764 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:58:06.848147 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:58:06.849327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:06.868184 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:58:06.869737 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:58:06.871196 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:58:06.875027 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:58:06.877234 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:58:06.880784 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:58:06.786450 => 2024-10-24 10:58:06.880673
[0m10:58:06.882333 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:58:06.894578 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:58:06.896809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99d8c9ae-b7f7-4223-b6f4-6cd0f056cfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed8986b00>]}
[0m10:58:06.898858 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.13s]
[0m10:58:06.901974 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:58:06.903305 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:58:06.904690 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m10:58:06.906298 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:58:06.907551 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:58:06.912908 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:58:06.926240 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:58:06.908719 => 2024-10-24 10:58:06.926088
[0m10:58:06.927901 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:58:06.933209 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:58:06.945350 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:58:06.946745 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:58:06.947882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:06.968603 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:58:06.970553 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:58:06.971846 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:58:06.975349 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:58:06.976819 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:58:06.980899 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:58:06.929174 => 2024-10-24 10:58:06.980737
[0m10:58:06.982698 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:58:06.984969 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:58:06.986667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99d8c9ae-b7f7-4223-b6f4-6cd0f056cfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed8960970>]}
[0m10:58:06.988338 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.08s]
[0m10:58:06.989893 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:58:06.991569 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:58:06.993050 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m10:58:06.994836 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:58:06.996416 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:58:07.000236 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:58:07.012834 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:58:06.997541 => 2024-10-24 10:58:07.012653
[0m10:58:07.014249 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:58:07.019749 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:58:07.030546 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:58:07.031921 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:58:07.033308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:07.054251 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:58:07.056035 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:58:07.057491 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:58:07.060778 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m10:58:07.062349 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:58:07.066524 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:58:07.015315 => 2024-10-24 10:58:07.066260
[0m10:58:07.068113 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:58:07.070065 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:58:07.071612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99d8c9ae-b7f7-4223-b6f4-6cd0f056cfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed89865f0>]}
[0m10:58:07.073193 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.08s]
[0m10:58:07.074898 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:58:07.077274 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m10:58:07.078650 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m10:58:07.080111 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m10:58:07.082861 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:58:07.084255 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:07.085530 [debug] [MainThread]: On master: BEGIN
[0m10:58:07.086801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:58:07.107283 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:58:07.108929 [debug] [MainThread]: On master: COMMIT
[0m10:58:07.110242 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:07.111430 [debug] [MainThread]: On master: COMMIT
[0m10:58:07.114486 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:58:07.115780 [debug] [MainThread]: On master: Close
[0m10:58:07.117507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:07.118850 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:58:07.120420 [info ] [MainThread]: 
[0m10:58:07.122022 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m10:58:07.123667 [debug] [MainThread]: Command end result
[0m10:58:07.145184 [info ] [MainThread]: 
[0m10:58:07.146981 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:58:07.149314 [info ] [MainThread]: 
[0m10:58:07.150869 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:58:07.152348 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:58:07.153801 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:58:07.155582 [error] [MainThread]:                             ^
[0m10:58:07.157233 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:58:07.158832 [info ] [MainThread]: 
[0m10:58:07.160164 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:58:07.161515 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:58:07.162815 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:58:07.164739 [error] [MainThread]:                             ^
[0m10:58:07.166304 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:58:07.167639 [info ] [MainThread]: 
[0m10:58:07.169104 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:58:07.170325 [error] [MainThread]:   relation "public.films" does not exist
[0m10:58:07.171720 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m10:58:07.173282 [error] [MainThread]:                             ^
[0m10:58:07.174900 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:58:07.177024 [info ] [MainThread]: 
[0m10:58:07.178581 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m10:58:07.181024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed8b3e860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed8961db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeda3c2590>]}
[0m10:58:07.182591 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 10:59:18.210699 | e7dbf12f-6531-4ead-ba87-7362e1de87a0 ==============================
[0m10:59:18.210699 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:59:18.214536 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:59:18.215822 [debug] [MainThread]: Tracking: tracking
[0m10:59:18.217956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9373e90f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9373e97b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9373e9390>]}
[0m10:59:18.231441 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:59:18.339211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m10:59:18.341016 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/sources.yml
[0m10:59:18.342291 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/films.sql
[0m10:59:18.343093 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/actors.sql
[0m10:59:18.343779 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_actors.sql
[0m10:59:18.369457 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m10:59:18.381498 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m10:59:18.385205 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m10:59:18.389088 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m10:59:18.457176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7dbf12f-6531-4ead-ba87-7362e1de87a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff935b75750>]}
[0m10:59:18.495870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7dbf12f-6531-4ead-ba87-7362e1de87a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9373cd300>]}
[0m10:59:18.514936 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:59:18.517084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7dbf12f-6531-4ead-ba87-7362e1de87a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff938d27be0>]}
[0m10:59:18.520736 [info ] [MainThread]: 
[0m10:59:18.525235 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:59:18.528378 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m10:59:18.538477 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m10:59:18.540329 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m10:59:18.542054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:18.567732 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m10:59:18.569815 [debug] [ThreadPool]: On list_destination_db: Close
[0m10:59:18.572129 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m10:59:18.577551 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:59:18.578363 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m10:59:18.579621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:59:18.592332 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m10:59:18.593455 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m10:59:18.594415 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:59:18.598537 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m10:59:18.600385 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m10:59:18.602333 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m10:59:18.607070 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:18.608195 [debug] [MainThread]: On master: BEGIN
[0m10:59:18.609176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:59:18.620677 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:59:18.621856 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:18.622831 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:59:18.628263 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m10:59:18.630109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7dbf12f-6531-4ead-ba87-7362e1de87a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff903963730>]}
[0m10:59:18.631356 [debug] [MainThread]: On master: ROLLBACK
[0m10:59:18.633231 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:18.634119 [debug] [MainThread]: On master: BEGIN
[0m10:59:18.636650 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:59:18.638005 [debug] [MainThread]: On master: COMMIT
[0m10:59:18.638846 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:18.639692 [debug] [MainThread]: On master: COMMIT
[0m10:59:18.641582 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:59:18.642488 [debug] [MainThread]: On master: Close
[0m10:59:18.643576 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:59:18.644789 [info ] [MainThread]: 
[0m10:59:18.659962 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m10:59:18.661756 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m10:59:18.663454 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m10:59:18.664842 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m10:59:18.668168 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m10:59:18.675214 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 10:59:18.666051 => 2024-10-24 10:59:18.675137
[0m10:59:18.676059 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m10:59:18.706458 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m10:59:18.718173 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:59:18.719017 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m10:59:18.720596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:18.738665 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:59:18.740089 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m10:59:18.740994 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m10:59:18.746518 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m10:59:18.748188 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m10:59:18.751533 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 10:59:18.676836 => 2024-10-24 10:59:18.751451
[0m10:59:18.753185 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m10:59:18.756685 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:59:18.758619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7dbf12f-6531-4ead-ba87-7362e1de87a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9039102e0>]}
[0m10:59:18.760150 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.10s]
[0m10:59:18.762903 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m10:59:18.764505 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m10:59:18.765729 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m10:59:18.767530 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m10:59:18.769239 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m10:59:18.773536 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m10:59:18.791896 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 10:59:18.770953 => 2024-10-24 10:59:18.791765
[0m10:59:18.793853 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m10:59:18.799985 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m10:59:18.819896 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:59:18.821610 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m10:59:18.823252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:18.842872 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:59:18.844683 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m10:59:18.846330 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m10:59:18.851001 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m10:59:18.852893 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m10:59:18.856122 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 10:59:18.795206 => 2024-10-24 10:59:18.856003
[0m10:59:18.857591 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m10:59:18.860359 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:59:18.861992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7dbf12f-6531-4ead-ba87-7362e1de87a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff903971570>]}
[0m10:59:18.863552 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.09s]
[0m10:59:18.865081 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m10:59:18.866794 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m10:59:18.868656 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m10:59:18.870370 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m10:59:18.871870 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m10:59:18.875708 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m10:59:18.887473 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 10:59:18.873063 => 2024-10-24 10:59:18.887365
[0m10:59:18.889151 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m10:59:18.895046 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m10:59:18.911992 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:59:18.913581 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m10:59:18.915023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:18.935362 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m10:59:18.936769 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m10:59:18.937840 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m10:59:18.940784 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m10:59:18.943136 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m10:59:18.946448 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 10:59:18.890829 => 2024-10-24 10:59:18.946356
[0m10:59:18.948519 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m10:59:18.950182 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:59:18.951680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7dbf12f-6531-4ead-ba87-7362e1de87a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff903911900>]}
[0m10:59:18.953970 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.08s]
[0m10:59:18.955625 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m10:59:18.958060 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m10:59:18.959632 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m10:59:18.960991 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m10:59:18.963824 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:59:18.965468 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:18.967073 [debug] [MainThread]: On master: BEGIN
[0m10:59:18.968796 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:59:18.989017 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m10:59:18.990533 [debug] [MainThread]: On master: COMMIT
[0m10:59:18.991849 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:18.993270 [debug] [MainThread]: On master: COMMIT
[0m10:59:18.996450 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m10:59:18.998012 [debug] [MainThread]: On master: Close
[0m10:59:18.999654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:19.000798 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m10:59:19.002368 [info ] [MainThread]: 
[0m10:59:19.003860 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m10:59:19.005267 [debug] [MainThread]: Command end result
[0m10:59:19.029217 [info ] [MainThread]: 
[0m10:59:19.030904 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:59:19.032351 [info ] [MainThread]: 
[0m10:59:19.033669 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m10:59:19.035166 [error] [MainThread]:   relation "public.actors" does not exist
[0m10:59:19.036488 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m10:59:19.037881 [error] [MainThread]:                             ^
[0m10:59:19.039171 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m10:59:19.040206 [info ] [MainThread]: 
[0m10:59:19.041540 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m10:59:19.042747 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m10:59:19.043857 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m10:59:19.045007 [error] [MainThread]:                             ^
[0m10:59:19.046098 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m10:59:19.047114 [info ] [MainThread]: 
[0m10:59:19.048309 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m10:59:19.049578 [error] [MainThread]:   relation "public.films" does not exist
[0m10:59:19.050538 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m10:59:19.051687 [error] [MainThread]:                             ^
[0m10:59:19.052825 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m10:59:19.053964 [info ] [MainThread]: 
[0m10:59:19.054922 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m10:59:19.055996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9039e2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9039e0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9039e0a00>]}
[0m10:59:19.057136 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 11:02:48.646875 | 0b331077-4750-47ff-a106-eb415b5579d2 ==============================
[0m11:02:48.646875 [info ] [MainThread]: Running with dbt=1.4.7
[0m11:02:48.650385 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:02:48.652264 [debug] [MainThread]: Tracking: tracking
[0m11:02:48.655268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595fe9d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595fe9d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595fe9d3c0>]}
[0m11:02:48.676263 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m11:02:48.870136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:02:48.871169 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/actors.sql
[0m11:02:48.887038 [debug] [MainThread]: 1603: static parser failed on example/actors.sql
[0m11:02:48.890368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e5a1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e5d9870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e5d9900>]}
[0m11:02:48.892390 [debug] [MainThread]: Flushing usage events
[0m11:02:54.878404 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m11:02:54.880557 [error] [MainThread]: Encountered an error:
Compilation Error in model actors (models/example/actors.sql)
  unexpected '%'
    line 1
      SELECT * FROM {{% source('destination_db','actors') %}}


============================== 2024-10-24 11:03:33.760905 | 9faeb907-4f9b-484e-9c18-9e158164f9e5 ==============================
[0m11:03:33.760905 [info ] [MainThread]: Running with dbt=1.4.7
[0m11:03:33.764786 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:03:33.766141 [debug] [MainThread]: Tracking: tracking
[0m11:03:33.768353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd867e290f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd867e297b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd867e29390>]}
[0m11:03:33.782325 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m11:03:33.908476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:03:33.909647 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/actors.sql
[0m11:03:33.925057 [debug] [MainThread]: 1603: static parser failed on example/actors.sql
[0m11:03:33.928165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd866521720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd866555840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8665558d0>]}
[0m11:03:33.929899 [debug] [MainThread]: Flushing usage events
[0m11:03:39.826414 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m11:03:39.828495 [error] [MainThread]: Encountered an error:
Compilation Error in model actors (models/example/actors.sql)
  unexpected '%'
    line 1
      SELECT * FROM {{% source('destination_db','actors') }}


============================== 2024-10-24 11:03:56.487871 | 59eb909f-d41f-4daa-9a24-1c8fc5990d99 ==============================
[0m11:03:56.487871 [info ] [MainThread]: Running with dbt=1.4.7
[0m11:03:56.493231 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:03:56.495209 [debug] [MainThread]: Tracking: tracking
[0m11:03:56.498866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d392150f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d392157b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d39215390>]}
[0m11:03:56.523518 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m11:03:56.713632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:03:56.714775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:03:56.721587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59eb909f-d41f-4daa-9a24-1c8fc5990d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d379480d0>]}
[0m11:03:56.735582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59eb909f-d41f-4daa-9a24-1c8fc5990d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d37911240>]}
[0m11:03:56.736317 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:03:56.738602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59eb909f-d41f-4daa-9a24-1c8fc5990d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d379112a0>]}
[0m11:03:56.741026 [info ] [MainThread]: 
[0m11:03:56.744439 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:03:56.746512 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m11:03:56.755932 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m11:03:56.757212 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m11:03:56.758301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:56.783065 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m11:03:56.785214 [debug] [ThreadPool]: On list_destination_db: Close
[0m11:03:56.787634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m11:03:56.793660 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:03:56.794935 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m11:03:56.795880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:56.811233 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m11:03:56.812417 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:03:56.813391 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:03:56.820776 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m11:03:56.822693 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m11:03:56.824698 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m11:03:56.829792 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:56.831032 [debug] [MainThread]: On master: BEGIN
[0m11:03:56.832023 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:03:56.843607 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:03:56.844961 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:56.845844 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:03:56.851716 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m11:03:56.853492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59eb909f-d41f-4daa-9a24-1c8fc5990d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d37910670>]}
[0m11:03:56.854751 [debug] [MainThread]: On master: ROLLBACK
[0m11:03:56.856714 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:56.857600 [debug] [MainThread]: On master: BEGIN
[0m11:03:56.860254 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:03:56.861120 [debug] [MainThread]: On master: COMMIT
[0m11:03:56.861996 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:56.862726 [debug] [MainThread]: On master: COMMIT
[0m11:03:56.864459 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:03:56.865342 [debug] [MainThread]: On master: Close
[0m11:03:56.866458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:03:56.867628 [info ] [MainThread]: 
[0m11:03:56.880852 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m11:03:56.882337 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m11:03:56.884390 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m11:03:56.885352 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m11:03:56.888318 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m11:03:56.895266 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 11:03:56.886115 => 2024-10-24 11:03:56.895101
[0m11:03:56.896241 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m11:03:56.926885 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m11:03:56.937072 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:03:56.937899 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m11:03:56.938605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:56.949882 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:03:56.950953 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:03:56.951937 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m11:03:56.958355 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m11:03:56.959395 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m11:03:56.961507 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 11:03:56.897055 => 2024-10-24 11:03:56.961429
[0m11:03:56.962386 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m11:03:56.966937 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:03:56.968110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59eb909f-d41f-4daa-9a24-1c8fc5990d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d377e2b00>]}
[0m11:03:56.969297 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.08s]
[0m11:03:56.971786 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m11:03:56.972640 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m11:03:56.973651 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m11:03:56.975351 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m11:03:56.976231 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m11:03:56.980095 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m11:03:56.986466 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 11:03:56.976838 => 2024-10-24 11:03:56.986397
[0m11:03:56.987205 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m11:03:56.991388 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m11:03:56.997518 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:03:56.998420 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m11:03:56.999280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:57.010650 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:03:57.011641 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:03:57.012521 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m11:03:57.015916 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m11:03:57.019336 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m11:03:57.021890 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 11:03:56.988357 => 2024-10-24 11:03:57.021781
[0m11:03:57.023166 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m11:03:57.025543 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:03:57.027240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59eb909f-d41f-4daa-9a24-1c8fc5990d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d377bc970>]}
[0m11:03:57.028643 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.05s]
[0m11:03:57.029984 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m11:03:57.031483 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m11:03:57.033221 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m11:03:57.035510 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m11:03:57.037110 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m11:03:57.040855 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m11:03:57.054951 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 11:03:57.038568 => 2024-10-24 11:03:57.054857
[0m11:03:57.056576 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m11:03:57.061422 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m11:03:57.079334 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:03:57.081269 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m11:03:57.082948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:57.102045 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:03:57.103754 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:03:57.105324 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m11:03:57.110044 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m11:03:57.114753 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m11:03:57.117666 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 11:03:57.058112 => 2024-10-24 11:03:57.117595
[0m11:03:57.119100 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m11:03:57.121198 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:03:57.122743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59eb909f-d41f-4daa-9a24-1c8fc5990d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d377e25f0>]}
[0m11:03:57.124431 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.09s]
[0m11:03:57.126397 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m11:03:57.128820 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m11:03:57.130410 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m11:03:57.132088 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m11:03:57.134712 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:03:57.136474 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:57.137620 [debug] [MainThread]: On master: BEGIN
[0m11:03:57.138939 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:03:57.152608 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:03:57.153831 [debug] [MainThread]: On master: COMMIT
[0m11:03:57.154948 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:57.155794 [debug] [MainThread]: On master: COMMIT
[0m11:03:57.157721 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:03:57.158656 [debug] [MainThread]: On master: Close
[0m11:03:57.160041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:57.161202 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m11:03:57.162135 [info ] [MainThread]: 
[0m11:03:57.163737 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m11:03:57.165018 [debug] [MainThread]: Command end result
[0m11:03:57.183889 [info ] [MainThread]: 
[0m11:03:57.185469 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:03:57.186660 [info ] [MainThread]: 
[0m11:03:57.187690 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m11:03:57.189023 [error] [MainThread]:   relation "public.actors" does not exist
[0m11:03:57.190317 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m11:03:57.191535 [error] [MainThread]:                             ^
[0m11:03:57.192740 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:03:57.194278 [info ] [MainThread]: 
[0m11:03:57.195748 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m11:03:57.197054 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m11:03:57.198387 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m11:03:57.199747 [error] [MainThread]:                             ^
[0m11:03:57.200989 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:03:57.202314 [info ] [MainThread]: 
[0m11:03:57.203715 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m11:03:57.205015 [error] [MainThread]:   relation "public.films" does not exist
[0m11:03:57.206125 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m11:03:57.207113 [error] [MainThread]:                             ^
[0m11:03:57.208128 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:03:57.209270 [info ] [MainThread]: 
[0m11:03:57.210505 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m11:03:57.211825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d37790bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d377bddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d39215120>]}
[0m11:03:57.212839 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 11:06:00.213006 | 4ffacf2e-7ea8-4f6e-8de7-13173bcd0a68 ==============================
[0m11:06:00.213006 [info ] [MainThread]: Running with dbt=1.4.7
[0m11:06:00.215455 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:06:00.216001 [debug] [MainThread]: Tracking: tracking
[0m11:06:00.217984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a13f50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a13f57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a13f5390>]}
[0m11:06:00.232570 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m11:06:00.362195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:06:00.362972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:06:00.368500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ffacf2e-7ea8-4f6e-8de7-13173bcd0a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f339fb1c0d0>]}
[0m11:06:00.379035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ffacf2e-7ea8-4f6e-8de7-13173bcd0a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f339fae5240>]}
[0m11:06:00.380723 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:06:00.383384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ffacf2e-7ea8-4f6e-8de7-13173bcd0a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f339fae52a0>]}
[0m11:06:00.385284 [info ] [MainThread]: 
[0m11:06:00.388544 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:06:00.391290 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m11:06:00.403006 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m11:06:00.404899 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m11:06:00.407156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:00.428910 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m11:06:00.431227 [debug] [ThreadPool]: On list_destination_db: Close
[0m11:06:00.433971 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m11:06:00.439809 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:06:00.441217 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m11:06:00.442454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:00.456808 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m11:06:00.458296 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:06:00.459532 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:06:00.464359 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m11:06:00.466315 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m11:06:00.468687 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m11:06:00.474421 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:00.475815 [debug] [MainThread]: On master: BEGIN
[0m11:06:00.476904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:06:00.491254 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:06:00.492740 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:00.493965 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:06:00.499114 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m11:06:00.501124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ffacf2e-7ea8-4f6e-8de7-13173bcd0a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f339fae4670>]}
[0m11:06:00.502416 [debug] [MainThread]: On master: ROLLBACK
[0m11:06:00.505212 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:00.506290 [debug] [MainThread]: On master: BEGIN
[0m11:06:00.510020 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:06:00.511139 [debug] [MainThread]: On master: COMMIT
[0m11:06:00.512236 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:00.513285 [debug] [MainThread]: On master: COMMIT
[0m11:06:00.515817 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:06:00.517032 [debug] [MainThread]: On master: Close
[0m11:06:00.518259 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:06:00.519668 [info ] [MainThread]: 
[0m11:06:00.533745 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m11:06:00.535086 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m11:06:00.537303 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m11:06:00.538612 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m11:06:00.542031 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m11:06:00.552925 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 11:06:00.539814 => 2024-10-24 11:06:00.552802
[0m11:06:00.554214 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m11:06:00.585109 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m11:06:00.604778 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:06:00.605741 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m11:06:00.606478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:00.617532 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:06:00.618591 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:06:00.619673 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m11:06:00.621940 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m11:06:00.624786 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m11:06:00.626564 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 11:06:00.555335 => 2024-10-24 11:06:00.626478
[0m11:06:00.627420 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m11:06:00.629912 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:06:00.632356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ffacf2e-7ea8-4f6e-8de7-13173bcd0a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f339f9b6b00>]}
[0m11:06:00.633548 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.10s]
[0m11:06:00.636276 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m11:06:00.637897 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m11:06:00.639062 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m11:06:00.640394 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m11:06:00.641336 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m11:06:00.645804 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m11:06:00.652321 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 11:06:00.642090 => 2024-10-24 11:06:00.652193
[0m11:06:00.653374 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m11:06:00.657587 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m11:06:00.664304 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:06:00.665189 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m11:06:00.665858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:00.678932 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:06:00.680154 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:06:00.681135 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m11:06:00.683263 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m11:06:00.686110 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m11:06:00.688140 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 11:06:00.654264 => 2024-10-24 11:06:00.688060
[0m11:06:00.689176 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m11:06:00.690676 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:06:00.693106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ffacf2e-7ea8-4f6e-8de7-13173bcd0a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f339f990970>]}
[0m11:06:00.694429 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.05s]
[0m11:06:00.696032 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m11:06:00.697028 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m11:06:00.697995 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m11:06:00.699323 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m11:06:00.700262 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m11:06:00.703558 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m11:06:00.715479 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 11:06:00.701007 => 2024-10-24 11:06:00.715371
[0m11:06:00.716734 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m11:06:00.721295 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m11:06:00.730388 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:06:00.731384 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m11:06:00.732326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:00.747658 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:06:00.749444 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:06:00.750587 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m11:06:00.753423 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m11:06:00.756358 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m11:06:00.758788 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 11:06:00.717957 => 2024-10-24 11:06:00.758689
[0m11:06:00.760267 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m11:06:00.761968 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:06:00.766131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ffacf2e-7ea8-4f6e-8de7-13173bcd0a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f339f9b65f0>]}
[0m11:06:00.768026 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m11:06:00.770121 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m11:06:00.772002 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m11:06:00.773662 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m11:06:00.775504 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m11:06:00.778310 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:06:00.780227 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:00.783265 [debug] [MainThread]: On master: BEGIN
[0m11:06:00.784953 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:06:00.801395 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:06:00.803003 [debug] [MainThread]: On master: COMMIT
[0m11:06:00.804302 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:00.805657 [debug] [MainThread]: On master: COMMIT
[0m11:06:00.808163 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:06:00.809566 [debug] [MainThread]: On master: Close
[0m11:06:00.811501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:00.813637 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m11:06:00.814761 [info ] [MainThread]: 
[0m11:06:00.815761 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m11:06:00.817241 [debug] [MainThread]: Command end result
[0m11:06:00.833003 [info ] [MainThread]: 
[0m11:06:00.834650 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:06:00.837281 [info ] [MainThread]: 
[0m11:06:00.838842 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m11:06:00.840277 [error] [MainThread]:   relation "public.actors" does not exist
[0m11:06:00.841405 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m11:06:00.843160 [error] [MainThread]:                             ^
[0m11:06:00.844395 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:06:00.845661 [info ] [MainThread]: 
[0m11:06:00.846932 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m11:06:00.848114 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m11:06:00.849204 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m11:06:00.850790 [error] [MainThread]:                             ^
[0m11:06:00.853259 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:06:00.855055 [info ] [MainThread]: 
[0m11:06:00.856430 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m11:06:00.858546 [error] [MainThread]:   relation "public.films" does not exist
[0m11:06:00.860031 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m11:06:00.861102 [error] [MainThread]:                             ^
[0m11:06:00.862263 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:06:00.863296 [info ] [MainThread]: 
[0m11:06:00.864594 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m11:06:00.865630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f339fb6fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f339f991db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a13f5ba0>]}
[0m11:06:00.866857 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 11:11:22.548376 | 790d7f4f-1647-4357-9e60-bf0a995a4635 ==============================
[0m11:11:22.548376 [info ] [MainThread]: Running with dbt=1.4.7
[0m11:11:22.550770 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:11:22.551419 [debug] [MainThread]: Tracking: tracking
[0m11:11:22.561574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff376f99360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff376f997e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff376f993c0>]}
[0m11:11:22.584773 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m11:11:22.816670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:11:22.817962 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:11:22.828716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '790d7f4f-1647-4357-9e60-bf0a995a4635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3756cc0d0>]}
[0m11:11:22.867030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '790d7f4f-1647-4357-9e60-bf0a995a4635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff375699210>]}
[0m11:11:22.884689 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:11:22.890412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '790d7f4f-1647-4357-9e60-bf0a995a4635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff375699270>]}
[0m11:11:22.895736 [info ] [MainThread]: 
[0m11:11:22.901047 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:11:22.905218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m11:11:22.921037 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m11:11:22.923205 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m11:11:22.924929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:22.962457 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m11:11:22.964822 [debug] [ThreadPool]: On list_destination_db: Close
[0m11:11:22.968281 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m11:11:22.974595 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:11:22.976073 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m11:11:22.977111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:22.992998 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m11:11:22.994210 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:11:22.995226 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:11:23.002988 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m11:11:23.005682 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m11:11:23.008919 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m11:11:23.014978 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:23.016289 [debug] [MainThread]: On master: BEGIN
[0m11:11:23.017217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:23.033290 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:11:23.035162 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:23.036439 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:11:23.041340 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m11:11:23.043500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '790d7f4f-1647-4357-9e60-bf0a995a4635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3756981c0>]}
[0m11:11:23.044704 [debug] [MainThread]: On master: ROLLBACK
[0m11:11:23.047408 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:23.048621 [debug] [MainThread]: On master: BEGIN
[0m11:11:23.052459 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:11:23.054011 [debug] [MainThread]: On master: COMMIT
[0m11:11:23.055406 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:23.056685 [debug] [MainThread]: On master: COMMIT
[0m11:11:23.059180 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:11:23.060483 [debug] [MainThread]: On master: Close
[0m11:11:23.062199 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:11:23.063332 [info ] [MainThread]: 
[0m11:11:23.078069 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m11:11:23.079554 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m11:11:23.081537 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m11:11:23.083264 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m11:11:23.087103 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m11:11:23.100566 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 11:11:23.084583 => 2024-10-24 11:11:23.100460
[0m11:11:23.101892 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m11:11:23.132154 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m11:11:23.143945 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:11:23.144861 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m11:11:23.145711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:23.157798 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:11:23.158772 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:11:23.159658 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m11:11:23.162844 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m11:11:23.164852 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m11:11:23.167541 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 11:11:23.103144 => 2024-10-24 11:11:23.167456
[0m11:11:23.169456 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m11:11:23.177613 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:11:23.179101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790d7f4f-1647-4357-9e60-bf0a995a4635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff375589240>]}
[0m11:11:23.180144 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.10s]
[0m11:11:23.182278 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m11:11:23.183444 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m11:11:23.184476 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m11:11:23.186341 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m11:11:23.187746 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m11:11:23.192395 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m11:11:23.199298 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 11:11:23.188958 => 2024-10-24 11:11:23.199217
[0m11:11:23.200196 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m11:11:23.204825 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m11:11:23.211821 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:11:23.212592 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m11:11:23.213486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:23.226123 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:11:23.227341 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:11:23.228387 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m11:11:23.230352 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m11:11:23.231626 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m11:11:23.235844 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 11:11:23.201102 => 2024-10-24 11:11:23.235735
[0m11:11:23.237069 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m11:11:23.240116 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:11:23.241754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790d7f4f-1647-4357-9e60-bf0a995a4635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3755abe50>]}
[0m11:11:23.244102 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.06s]
[0m11:11:23.245426 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m11:11:23.246568 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m11:11:23.247918 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m11:11:23.249786 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m11:11:23.251271 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m11:11:23.255121 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m11:11:23.270231 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 11:11:23.252403 => 2024-10-24 11:11:23.270093
[0m11:11:23.271604 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m11:11:23.275997 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m11:11:23.287366 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:11:23.288561 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m11:11:23.289416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:23.302377 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:11:23.303309 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:11:23.304016 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m11:11:23.307449 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m11:11:23.309533 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m11:11:23.311730 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 11:11:23.272549 => 2024-10-24 11:11:23.311649
[0m11:11:23.312976 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m11:11:23.314820 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:11:23.316688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790d7f4f-1647-4357-9e60-bf0a995a4635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff375589750>]}
[0m11:11:23.318473 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m11:11:23.320316 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m11:11:23.322552 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m11:11:23.324344 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m11:11:23.326140 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m11:11:23.328849 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:11:23.331026 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:23.332452 [debug] [MainThread]: On master: BEGIN
[0m11:11:23.333213 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:11:23.349176 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:11:23.350883 [debug] [MainThread]: On master: COMMIT
[0m11:11:23.352014 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:23.353221 [debug] [MainThread]: On master: COMMIT
[0m11:11:23.356357 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:11:23.357765 [debug] [MainThread]: On master: Close
[0m11:11:23.359649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:23.360781 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m11:11:23.362262 [info ] [MainThread]: 
[0m11:11:23.363894 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m11:11:23.365270 [debug] [MainThread]: Command end result
[0m11:11:23.386712 [info ] [MainThread]: 
[0m11:11:23.388202 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:11:23.389459 [info ] [MainThread]: 
[0m11:11:23.391178 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m11:11:23.392404 [error] [MainThread]:   relation "public.actors" does not exist
[0m11:11:23.393970 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m11:11:23.395111 [error] [MainThread]:                             ^
[0m11:11:23.396315 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:11:23.398153 [info ] [MainThread]: 
[0m11:11:23.399619 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m11:11:23.401179 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m11:11:23.402811 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m11:11:23.404541 [error] [MainThread]:                             ^
[0m11:11:23.406360 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:11:23.407531 [info ] [MainThread]: 
[0m11:11:23.408663 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m11:11:23.409753 [error] [MainThread]:   relation "public.films" does not exist
[0m11:11:23.410713 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m11:11:23.411803 [error] [MainThread]:                             ^
[0m11:11:23.413090 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:11:23.414142 [info ] [MainThread]: 
[0m11:11:23.415323 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m11:11:23.417099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3755a9900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3755a9c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff376f9bb20>]}
[0m11:11:23.418370 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 11:15:36.571940 | 91c7864e-6032-4444-972b-f2a6374804f3 ==============================
[0m11:15:36.571940 [info ] [MainThread]: Running with dbt=1.4.7
[0m11:15:36.574500 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:15:36.575770 [debug] [MainThread]: Tracking: tracking
[0m11:15:36.583122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9897f91360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9897f917e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9897f913c0>]}
[0m11:15:36.597760 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m11:15:36.613831 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:15:36.615402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '91c7864e-6032-4444-972b-f2a6374804f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9897f90130>]}
[0m11:15:37.126990 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m11:15:37.137053 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m11:15:37.140800 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m11:15:37.145034 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m11:15:37.320350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91c7864e-6032-4444-972b-f2a6374804f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f989669f520>]}
[0m11:15:37.365418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91c7864e-6032-4444-972b-f2a6374804f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f989669f490>]}
[0m11:15:37.368418 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:15:37.371632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91c7864e-6032-4444-972b-f2a6374804f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9897fa8550>]}
[0m11:15:37.380942 [info ] [MainThread]: 
[0m11:15:37.384664 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:15:37.388981 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m11:15:37.402633 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m11:15:37.404544 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m11:15:37.406569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:37.410862 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "destination_postgres" (172.20.0.3), port 5434 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m11:15:37.413041 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m11:15:37.414593 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:15:37.416177 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m11:15:37.417612 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:15:37.419252 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m11:15:37.421363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:37.422739 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m11:15:37.424471 [info ] [MainThread]: 
[0m11:15:37.426177 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m11:15:37.427626 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "destination_postgres" (172.20.0.3), port 5434 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m11:15:37.429031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f989669f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f989452f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f989452fa60>]}
[0m11:15:37.430259 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 11:17:13.774248 | f229543b-f6e3-4bac-86fc-c76820467eb8 ==============================
[0m11:17:13.774248 [info ] [MainThread]: Running with dbt=1.4.7
[0m11:17:13.776297 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:17:13.776934 [debug] [MainThread]: Tracking: tracking
[0m11:17:13.781861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7279d410f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7279d417b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7279d41390>]}
[0m11:17:13.796332 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m11:17:13.812445 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:17:13.813706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f229543b-f6e3-4bac-86fc-c76820467eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7279d40130>]}
[0m11:17:14.345974 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m11:17:14.357318 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m11:17:14.360949 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m11:17:14.365815 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m11:17:14.449979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f229543b-f6e3-4bac-86fc-c76820467eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727844b4f0>]}
[0m11:17:14.467146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f229543b-f6e3-4bac-86fc-c76820467eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7279ebe2c0>]}
[0m11:17:14.471610 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:17:14.478901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f229543b-f6e3-4bac-86fc-c76820467eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7279d40460>]}
[0m11:17:14.481421 [info ] [MainThread]: 
[0m11:17:14.486092 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:17:14.487573 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m11:17:14.497172 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m11:17:14.499220 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m11:17:14.500968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:14.524614 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m11:17:14.526770 [debug] [ThreadPool]: On list_destination_db: Close
[0m11:17:14.529095 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m11:17:14.535064 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:17:14.535982 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m11:17:14.536824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:14.548633 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m11:17:14.549652 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:17:14.550359 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:17:14.554243 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m11:17:14.556177 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m11:17:14.558598 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m11:17:14.563834 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:14.564772 [debug] [MainThread]: On master: BEGIN
[0m11:17:14.565610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:17:14.577550 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:17:14.578692 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:14.579515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:17:14.584384 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m11:17:14.586730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f229543b-f6e3-4bac-86fc-c76820467eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72762ef8b0>]}
[0m11:17:14.588178 [debug] [MainThread]: On master: ROLLBACK
[0m11:17:14.591189 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:14.592419 [debug] [MainThread]: On master: BEGIN
[0m11:17:14.596572 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:17:14.597381 [debug] [MainThread]: On master: COMMIT
[0m11:17:14.599042 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:14.600064 [debug] [MainThread]: On master: COMMIT
[0m11:17:14.602586 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:17:14.603733 [debug] [MainThread]: On master: Close
[0m11:17:14.605091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:17:14.606362 [info ] [MainThread]: 
[0m11:17:14.621683 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m11:17:14.623094 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m11:17:14.624747 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m11:17:14.625968 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m11:17:14.629200 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m11:17:14.638576 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 11:17:14.626929 => 2024-10-24 11:17:14.638471
[0m11:17:14.639735 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m11:17:14.671211 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m11:17:14.686463 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:17:14.687188 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m11:17:14.688122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:14.699703 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:17:14.700666 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:17:14.701481 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m11:17:14.704640 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m11:17:14.705864 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m11:17:14.707584 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 11:17:14.640763 => 2024-10-24 11:17:14.707521
[0m11:17:14.708376 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m11:17:14.715248 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:17:14.717461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f229543b-f6e3-4bac-86fc-c76820467eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7276364f40>]}
[0m11:17:14.718810 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.09s]
[0m11:17:14.721004 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m11:17:14.722079 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m11:17:14.722965 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m11:17:14.724286 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m11:17:14.725087 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m11:17:14.728144 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m11:17:14.737053 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 11:17:14.725872 => 2024-10-24 11:17:14.736940
[0m11:17:14.738147 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m11:17:14.742147 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m11:17:14.748603 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:17:14.749453 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m11:17:14.750283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:14.762461 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:17:14.763874 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:17:14.765139 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m11:17:14.768102 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m11:17:14.770799 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m11:17:14.772805 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 11:17:14.738943 => 2024-10-24 11:17:14.772718
[0m11:17:14.774031 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m11:17:14.776015 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:17:14.777062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f229543b-f6e3-4bac-86fc-c76820467eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727631f010>]}
[0m11:17:14.778978 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.05s]
[0m11:17:14.780619 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m11:17:14.781819 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m11:17:14.783120 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m11:17:14.784839 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m11:17:14.785615 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m11:17:14.788677 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m11:17:14.797608 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 11:17:14.786251 => 2024-10-24 11:17:14.797490
[0m11:17:14.798988 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m11:17:14.804459 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m11:17:14.815120 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:17:14.816271 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m11:17:14.817110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:14.830806 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:17:14.832202 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:17:14.833706 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m11:17:14.838982 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m11:17:14.841931 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m11:17:14.845070 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 11:17:14.800260 => 2024-10-24 11:17:14.844972
[0m11:17:14.846542 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m11:17:14.848775 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:17:14.849780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f229543b-f6e3-4bac-86fc-c76820467eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7276221720>]}
[0m11:17:14.852590 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m11:17:14.854332 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m11:17:14.856390 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m11:17:14.858136 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m11:17:14.860489 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m11:17:14.862653 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:17:14.863995 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:14.864966 [debug] [MainThread]: On master: BEGIN
[0m11:17:14.866098 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:17:14.882805 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:17:14.883991 [debug] [MainThread]: On master: COMMIT
[0m11:17:14.885460 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:14.886614 [debug] [MainThread]: On master: COMMIT
[0m11:17:14.888898 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:17:14.890057 [debug] [MainThread]: On master: Close
[0m11:17:14.891470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:14.892463 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m11:17:14.894222 [info ] [MainThread]: 
[0m11:17:14.895425 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m11:17:14.896798 [debug] [MainThread]: Command end result
[0m11:17:14.928689 [info ] [MainThread]: 
[0m11:17:14.931075 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:17:14.936999 [info ] [MainThread]: 
[0m11:17:14.938786 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m11:17:14.939934 [error] [MainThread]:   relation "public.actors" does not exist
[0m11:17:14.941027 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m11:17:14.942118 [error] [MainThread]:                             ^
[0m11:17:14.943281 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:17:14.944335 [info ] [MainThread]: 
[0m11:17:14.945669 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m11:17:14.946685 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m11:17:14.947790 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m11:17:14.948784 [error] [MainThread]:                             ^
[0m11:17:14.949835 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:17:14.951816 [info ] [MainThread]: 
[0m11:17:14.953641 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m11:17:14.954891 [error] [MainThread]:   relation "public.films" does not exist
[0m11:17:14.956131 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m11:17:14.957150 [error] [MainThread]:                             ^
[0m11:17:14.958128 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:17:14.959226 [info ] [MainThread]: 
[0m11:17:14.960672 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m11:17:14.961704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7276240130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727849afe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727849ac20>]}
[0m11:17:14.962897 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 11:23:33.000244 | 1143777a-c3be-45ae-a7b6-bada46b7d990 ==============================
[0m11:23:33.000244 [info ] [MainThread]: Running with dbt=1.4.7
[0m11:23:33.015434 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:23:33.017885 [debug] [MainThread]: Tracking: tracking
[0m11:23:33.030754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd3eb5360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd3eb57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd3eb53c0>]}
[0m11:23:33.062697 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m11:23:33.327839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:23:33.329081 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:23:33.336303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1143777a-c3be-45ae-a7b6-bada46b7d990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd25e00d0>]}
[0m11:23:33.356375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1143777a-c3be-45ae-a7b6-bada46b7d990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd25b1180>]}
[0m11:23:33.357402 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:23:33.359632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1143777a-c3be-45ae-a7b6-bada46b7d990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd25b11e0>]}
[0m11:23:33.367429 [info ] [MainThread]: 
[0m11:23:33.377306 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:23:33.380313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m11:23:33.391396 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m11:23:33.393342 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m11:23:33.394873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:33.423391 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m11:23:33.426194 [debug] [ThreadPool]: On list_destination_db: Close
[0m11:23:33.429256 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m11:23:33.435159 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:23:33.436755 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m11:23:33.438394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:33.452768 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m11:23:33.454415 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:23:33.456221 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:23:33.461685 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m11:23:33.464223 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m11:23:33.467467 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m11:23:33.473015 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:33.474218 [debug] [MainThread]: On master: BEGIN
[0m11:23:33.475422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:33.488239 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:23:33.489746 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:33.490797 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:23:33.495685 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m11:23:33.497624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1143777a-c3be-45ae-a7b6-bada46b7d990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd25b0130>]}
[0m11:23:33.498837 [debug] [MainThread]: On master: ROLLBACK
[0m11:23:33.501214 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:33.502658 [debug] [MainThread]: On master: BEGIN
[0m11:23:33.505752 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:23:33.507292 [debug] [MainThread]: On master: COMMIT
[0m11:23:33.508494 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:33.509790 [debug] [MainThread]: On master: COMMIT
[0m11:23:33.512136 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:23:33.513271 [debug] [MainThread]: On master: Close
[0m11:23:33.514591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:33.515667 [info ] [MainThread]: 
[0m11:23:33.530187 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m11:23:33.531591 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m11:23:33.533253 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m11:23:33.534357 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m11:23:33.538048 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m11:23:33.559500 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 11:23:33.535369 => 2024-10-24 11:23:33.559357
[0m11:23:33.564722 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m11:23:33.594476 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m11:23:33.738285 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:23:33.749122 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m11:23:33.755098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:33.787848 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:23:33.789513 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:23:33.790718 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m11:23:33.794398 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m11:23:33.795406 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m11:23:33.797883 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 11:23:33.566482 => 2024-10-24 11:23:33.797788
[0m11:23:33.798986 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m11:23:33.805932 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:23:33.807287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1143777a-c3be-45ae-a7b6-bada46b7d990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd24634c0>]}
[0m11:23:33.808847 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.27s]
[0m11:23:33.811403 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m11:23:33.812578 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m11:23:33.813529 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m11:23:33.815039 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m11:23:33.815916 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m11:23:33.819707 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m11:23:33.826076 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 11:23:33.816487 => 2024-10-24 11:23:33.825987
[0m11:23:33.828497 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m11:23:33.843273 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m11:23:33.850660 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:23:33.851386 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m11:23:33.852123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:33.875752 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:23:33.876842 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:23:33.878008 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m11:23:33.880375 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m11:23:33.881398 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m11:23:33.883242 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 11:23:33.838844 => 2024-10-24 11:23:33.883171
[0m11:23:33.884175 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m11:23:33.885653 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:23:33.886462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1143777a-c3be-45ae-a7b6-bada46b7d990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd2455e10>]}
[0m11:23:33.887825 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m11:23:33.889049 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m11:23:33.890110 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m11:23:33.891120 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m11:23:33.892317 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m11:23:33.893067 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m11:23:33.896266 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m11:23:33.909002 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 11:23:33.893870 => 2024-10-24 11:23:33.908891
[0m11:23:33.916103 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m11:23:33.921172 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m11:23:33.929246 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:23:33.930288 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m11:23:33.931007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:33.949053 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:23:33.950300 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:23:33.951169 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m11:23:33.953254 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m11:23:33.954014 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m11:23:33.956039 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 11:23:33.917394 => 2024-10-24 11:23:33.955961
[0m11:23:33.956782 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m11:23:33.958175 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:23:33.960060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1143777a-c3be-45ae-a7b6-bada46b7d990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd24639d0>]}
[0m11:23:33.961199 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m11:23:33.962794 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m11:23:33.964433 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m11:23:33.965408 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m11:23:33.966161 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m11:23:33.967985 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:23:33.969220 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:33.970112 [debug] [MainThread]: On master: BEGIN
[0m11:23:33.970807 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:23:33.982972 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:23:33.984158 [debug] [MainThread]: On master: COMMIT
[0m11:23:33.985239 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:33.986104 [debug] [MainThread]: On master: COMMIT
[0m11:23:33.987798 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:23:33.988641 [debug] [MainThread]: On master: Close
[0m11:23:33.989723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:33.990600 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m11:23:33.991393 [info ] [MainThread]: 
[0m11:23:33.993392 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m11:23:33.994645 [debug] [MainThread]: Command end result
[0m11:23:34.010330 [info ] [MainThread]: 
[0m11:23:34.018526 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:23:34.022180 [info ] [MainThread]: 
[0m11:23:34.024537 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m11:23:34.026929 [error] [MainThread]:   relation "public.actors" does not exist
[0m11:23:34.030407 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m11:23:34.031597 [error] [MainThread]:                             ^
[0m11:23:34.032887 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:23:34.034155 [info ] [MainThread]: 
[0m11:23:34.040353 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m11:23:34.042993 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m11:23:34.046066 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m11:23:34.048720 [error] [MainThread]:                             ^
[0m11:23:34.050801 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:23:34.052985 [info ] [MainThread]: 
[0m11:23:34.055062 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m11:23:34.057414 [error] [MainThread]:   relation "public.films" does not exist
[0m11:23:34.059585 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m11:23:34.062323 [error] [MainThread]:                             ^
[0m11:23:34.064076 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:23:34.066044 [info ] [MainThread]: 
[0m11:23:34.068195 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m11:23:34.070057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd2455900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd2454730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd3eb44c0>]}
[0m11:23:34.072433 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 11:38:58.095032 | b164727c-df8f-4bfc-b7ec-9f57bee386be ==============================
[0m11:38:58.095032 [info ] [MainThread]: Running with dbt=1.4.7
[0m11:38:58.099300 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:38:58.100861 [debug] [MainThread]: Tracking: tracking
[0m11:38:58.116087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dfe3550f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dfe3557b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dfe355390>]}
[0m11:38:58.137501 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m11:38:58.470201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:58.471769 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:58.481357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b164727c-df8f-4bfc-b7ec-9f57bee386be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dfca800d0>]}
[0m11:38:58.500704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b164727c-df8f-4bfc-b7ec-9f57bee386be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dfca49210>]}
[0m11:38:58.501677 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:38:58.504574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b164727c-df8f-4bfc-b7ec-9f57bee386be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dfca49270>]}
[0m11:38:58.509383 [info ] [MainThread]: 
[0m11:38:58.512753 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:38:58.515405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m11:38:58.525854 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m11:38:58.528712 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m11:38:58.531136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:58.583161 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m11:38:58.587201 [debug] [ThreadPool]: On list_destination_db: Close
[0m11:38:58.591583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m11:38:58.597739 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:38:58.599460 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m11:38:58.601700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:58.646646 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m11:38:58.649748 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:38:58.652110 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:38:58.668799 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m11:38:58.671377 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m11:38:58.674166 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m11:38:58.679665 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:58.681050 [debug] [MainThread]: On master: BEGIN
[0m11:38:58.682442 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:58.698258 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:38:58.699775 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:58.701481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:38:58.710418 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m11:38:58.712825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b164727c-df8f-4bfc-b7ec-9f57bee386be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dfca481c0>]}
[0m11:38:58.714536 [debug] [MainThread]: On master: ROLLBACK
[0m11:38:58.718360 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:58.720019 [debug] [MainThread]: On master: BEGIN
[0m11:38:58.724128 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:38:58.725454 [debug] [MainThread]: On master: COMMIT
[0m11:38:58.727043 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:58.728720 [debug] [MainThread]: On master: COMMIT
[0m11:38:58.731894 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:38:58.733386 [debug] [MainThread]: On master: Close
[0m11:38:58.735547 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:58.738357 [info ] [MainThread]: 
[0m11:38:58.753274 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m11:38:58.755464 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m11:38:58.757408 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m11:38:58.758650 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m11:38:58.762185 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m11:38:58.772362 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 11:38:58.759941 => 2024-10-24 11:38:58.772282
[0m11:38:58.773298 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m11:38:58.805989 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m11:38:58.814991 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:38:58.815858 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m11:38:58.816677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:58.828616 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:38:58.829763 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:38:58.830800 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m11:38:58.832964 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m11:38:58.833886 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m11:38:58.835669 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 11:38:58.774157 => 2024-10-24 11:38:58.835605
[0m11:38:58.836504 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m11:38:58.842317 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:38:58.843518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b164727c-df8f-4bfc-b7ec-9f57bee386be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dfc8ff4c0>]}
[0m11:38:58.844707 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.09s]
[0m11:38:58.846686 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m11:38:58.847725 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m11:38:58.848616 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m11:38:58.849682 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m11:38:58.850507 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m11:38:58.854093 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m11:38:58.861362 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 11:38:58.851122 => 2024-10-24 11:38:58.861301
[0m11:38:58.862239 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m11:38:58.865851 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m11:38:58.872353 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:38:58.873066 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m11:38:58.873746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:58.884993 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:38:58.885959 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:38:58.886622 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m11:38:58.888443 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m11:38:58.889418 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m11:38:58.891127 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 11:38:58.862924 => 2024-10-24 11:38:58.891068
[0m11:38:58.892008 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m11:38:58.893432 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:38:58.894293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b164727c-df8f-4bfc-b7ec-9f57bee386be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dfc95f6d0>]}
[0m11:38:58.895314 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.04s]
[0m11:38:58.896091 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m11:38:58.896926 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m11:38:58.897816 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m11:38:58.898946 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m11:38:58.899720 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m11:38:58.902544 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m11:38:58.908405 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 11:38:58.900364 => 2024-10-24 11:38:58.908344
[0m11:38:58.909113 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m11:38:58.913279 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m11:38:58.919140 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:38:58.919915 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m11:38:58.920492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:58.931620 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:38:58.932588 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:38:58.933386 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m11:38:58.935301 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m11:38:58.936111 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m11:38:58.937761 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 11:38:58.909773 => 2024-10-24 11:38:58.937697
[0m11:38:58.938521 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m11:38:58.939753 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:38:58.940544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b164727c-df8f-4bfc-b7ec-9f57bee386be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dfc8ff9d0>]}
[0m11:38:58.941553 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.04s]
[0m11:38:58.942498 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m11:38:58.943756 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m11:38:58.944547 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m11:38:58.945213 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m11:38:58.946677 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:38:58.947541 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:58.949051 [debug] [MainThread]: On master: BEGIN
[0m11:38:58.950518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:58.971793 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:38:58.973607 [debug] [MainThread]: On master: COMMIT
[0m11:38:58.981892 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:58.983757 [debug] [MainThread]: On master: COMMIT
[0m11:38:59.007695 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:38:59.010262 [debug] [MainThread]: On master: Close
[0m11:38:59.015634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:59.017838 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m11:38:59.020016 [info ] [MainThread]: 
[0m11:38:59.021504 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m11:38:59.023811 [debug] [MainThread]: Command end result
[0m11:38:59.072284 [info ] [MainThread]: 
[0m11:38:59.076054 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:38:59.079549 [info ] [MainThread]: 
[0m11:38:59.082556 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m11:38:59.085305 [error] [MainThread]:   relation "public.actors" does not exist
[0m11:38:59.088469 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m11:38:59.091002 [error] [MainThread]:                             ^
[0m11:38:59.092642 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:38:59.093996 [info ] [MainThread]: 
[0m11:38:59.095771 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m11:38:59.097170 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m11:38:59.098328 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m11:38:59.099493 [error] [MainThread]:                             ^
[0m11:38:59.100450 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:38:59.101973 [info ] [MainThread]: 
[0m11:38:59.103101 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m11:38:59.104354 [error] [MainThread]:   relation "public.films" does not exist
[0m11:38:59.105493 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m11:38:59.106637 [error] [MainThread]:                             ^
[0m11:38:59.107658 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:38:59.108611 [info ] [MainThread]: 
[0m11:38:59.109583 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m11:38:59.110761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dfcacffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dfc95e1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dfe3557b0>]}
[0m11:38:59.111925 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 11:45:09.755336 | 92051c64-0ceb-4a1b-b5ed-b7fb05dee6e0 ==============================
[0m11:45:09.755336 [info ] [MainThread]: Running with dbt=1.4.7
[0m11:45:09.758325 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:45:09.759789 [debug] [MainThread]: Tracking: tracking
[0m11:45:09.766365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701e1610f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701e1617b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701e161390>]}
[0m11:45:09.786973 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m11:45:09.948649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:45:09.949467 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:45:09.955638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92051c64-0ceb-4a1b-b5ed-b7fb05dee6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701c8880d0>]}
[0m11:45:10.010262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92051c64-0ceb-4a1b-b5ed-b7fb05dee6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701c851210>]}
[0m11:45:10.020343 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:45:10.022524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92051c64-0ceb-4a1b-b5ed-b7fb05dee6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701c851270>]}
[0m11:45:10.026040 [info ] [MainThread]: 
[0m11:45:10.029333 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:45:10.031872 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m11:45:10.043977 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m11:45:10.046541 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m11:45:10.049390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:10.082243 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m11:45:10.084766 [debug] [ThreadPool]: On list_destination_db: Close
[0m11:45:10.087700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m11:45:10.094002 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:45:10.096279 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m11:45:10.097988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:10.113466 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m11:45:10.114640 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:45:10.115880 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:45:10.120884 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m11:45:10.123188 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m11:45:10.125980 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m11:45:10.131835 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:10.133448 [debug] [MainThread]: On master: BEGIN
[0m11:45:10.134563 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:45:10.149485 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:45:10.151156 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:10.152344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:45:10.157024 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m11:45:10.159180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92051c64-0ceb-4a1b-b5ed-b7fb05dee6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701c8501c0>]}
[0m11:45:10.160577 [debug] [MainThread]: On master: ROLLBACK
[0m11:45:10.162750 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:10.164039 [debug] [MainThread]: On master: BEGIN
[0m11:45:10.168638 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:45:10.169885 [debug] [MainThread]: On master: COMMIT
[0m11:45:10.170964 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:10.171832 [debug] [MainThread]: On master: COMMIT
[0m11:45:10.174417 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:45:10.175600 [debug] [MainThread]: On master: Close
[0m11:45:10.177021 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:45:10.178414 [info ] [MainThread]: 
[0m11:45:10.194219 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m11:45:10.196445 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m11:45:10.198414 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m11:45:10.199981 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m11:45:10.203613 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m11:45:10.219280 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 11:45:10.201408 => 2024-10-24 11:45:10.219163
[0m11:45:10.221141 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m11:45:10.251024 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m11:45:10.277575 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:45:10.279769 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m11:45:10.282014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:10.297841 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:45:10.298785 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:45:10.299594 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m11:45:10.305654 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m11:45:10.306614 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m11:45:10.308070 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 11:45:10.222772 => 2024-10-24 11:45:10.308010
[0m11:45:10.308809 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m11:45:10.314464 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:45:10.316002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92051c64-0ceb-4a1b-b5ed-b7fb05dee6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701c722b30>]}
[0m11:45:10.317170 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.12s]
[0m11:45:10.319482 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m11:45:10.320468 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m11:45:10.321424 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m11:45:10.322796 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m11:45:10.323656 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m11:45:10.327206 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m11:45:10.333532 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 11:45:10.324327 => 2024-10-24 11:45:10.333470
[0m11:45:10.334320 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m11:45:10.338071 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m11:45:10.344745 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:45:10.345544 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m11:45:10.346067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:10.360684 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:45:10.361565 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:45:10.362374 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m11:45:10.372289 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m11:45:10.373692 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m11:45:10.376239 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 11:45:10.335127 => 2024-10-24 11:45:10.376170
[0m11:45:10.377121 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m11:45:10.378489 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:45:10.379493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92051c64-0ceb-4a1b-b5ed-b7fb05dee6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701c7676d0>]}
[0m11:45:10.380485 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.06s]
[0m11:45:10.381807 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m11:45:10.382612 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m11:45:10.383543 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m11:45:10.385328 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m11:45:10.386367 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m11:45:10.389275 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m11:45:10.395948 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 11:45:10.387055 => 2024-10-24 11:45:10.395879
[0m11:45:10.398201 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m11:45:10.402138 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m11:45:10.409173 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:45:10.410061 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m11:45:10.410957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:10.422848 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:45:10.423982 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:45:10.424803 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m11:45:10.427790 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m11:45:10.430962 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m11:45:10.433573 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 11:45:10.399081 => 2024-10-24 11:45:10.433507
[0m11:45:10.434558 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m11:45:10.435952 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:45:10.436977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92051c64-0ceb-4a1b-b5ed-b7fb05dee6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701c722620>]}
[0m11:45:10.438154 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.05s]
[0m11:45:10.439490 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m11:45:10.440889 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m11:45:10.442433 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m11:45:10.443573 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m11:45:10.445156 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:45:10.446111 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:10.446823 [debug] [MainThread]: On master: BEGIN
[0m11:45:10.447665 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:45:10.489259 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:45:10.490382 [debug] [MainThread]: On master: COMMIT
[0m11:45:10.491421 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:10.492348 [debug] [MainThread]: On master: COMMIT
[0m11:45:10.494260 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:45:10.495030 [debug] [MainThread]: On master: Close
[0m11:45:10.496199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:10.496767 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m11:45:10.497547 [info ] [MainThread]: 
[0m11:45:10.499014 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m11:45:10.500260 [debug] [MainThread]: Command end result
[0m11:45:10.513986 [info ] [MainThread]: 
[0m11:45:10.520138 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:45:10.528318 [info ] [MainThread]: 
[0m11:45:10.530146 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m11:45:10.533391 [error] [MainThread]:   relation "public.actors" does not exist
[0m11:45:10.535324 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m11:45:10.537058 [error] [MainThread]:                             ^
[0m11:45:10.539208 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:45:10.540790 [info ] [MainThread]: 
[0m11:45:10.542397 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m11:45:10.544158 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m11:45:10.545936 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m11:45:10.547959 [error] [MainThread]:                             ^
[0m11:45:10.549824 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:45:10.551715 [info ] [MainThread]: 
[0m11:45:10.553161 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m11:45:10.554493 [error] [MainThread]:   relation "public.films" does not exist
[0m11:45:10.555797 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m11:45:10.557243 [error] [MainThread]:                             ^
[0m11:45:10.558460 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:45:10.559785 [info ] [MainThread]: 
[0m11:45:10.561005 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m11:45:10.562604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701c765960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701c7661a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701e163250>]}
[0m11:45:10.564304 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 11:53:55.658998 | f69fee30-74f5-458e-ad17-8ec7bf9ef20d ==============================
[0m11:53:55.658998 [info ] [MainThread]: Running with dbt=1.4.7
[0m11:53:55.662491 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:53:55.663931 [debug] [MainThread]: Tracking: tracking
[0m11:53:55.670704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1ea790f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1ea797b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1ea79390>]}
[0m11:53:55.685622 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m11:53:55.859709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:53:55.860798 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:53:55.868181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f69fee30-74f5-458e-ad17-8ec7bf9ef20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1d1ac0d0>]}
[0m11:53:55.893591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f69fee30-74f5-458e-ad17-8ec7bf9ef20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1d17d1b0>]}
[0m11:53:55.898936 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:53:55.905553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f69fee30-74f5-458e-ad17-8ec7bf9ef20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1d17d210>]}
[0m11:53:55.914427 [info ] [MainThread]: 
[0m11:53:55.919906 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:53:55.924379 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m11:53:55.941774 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m11:53:55.945161 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m11:53:55.947476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:55.981445 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m11:53:55.984023 [debug] [ThreadPool]: On list_destination_db: Close
[0m11:53:55.987137 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m11:53:55.993676 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:53:55.995199 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m11:53:55.996632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:56.013829 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m11:53:56.015120 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:53:56.016083 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:53:56.022573 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m11:53:56.025833 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m11:53:56.028867 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m11:53:56.034313 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:56.036077 [debug] [MainThread]: On master: BEGIN
[0m11:53:56.037533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:53:56.053943 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:53:56.055146 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:56.056064 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:53:56.060592 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m11:53:56.062959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f69fee30-74f5-458e-ad17-8ec7bf9ef20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1d17c370>]}
[0m11:53:56.064437 [debug] [MainThread]: On master: ROLLBACK
[0m11:53:56.067055 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:56.068325 [debug] [MainThread]: On master: BEGIN
[0m11:53:56.072348 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:53:56.073679 [debug] [MainThread]: On master: COMMIT
[0m11:53:56.075033 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:56.076281 [debug] [MainThread]: On master: COMMIT
[0m11:53:56.078975 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:53:56.080230 [debug] [MainThread]: On master: Close
[0m11:53:56.082011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:53:56.083933 [info ] [MainThread]: 
[0m11:53:56.099954 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m11:53:56.101898 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m11:53:56.103881 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m11:53:56.105592 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m11:53:56.109223 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m11:53:56.127278 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 11:53:56.106902 => 2024-10-24 11:53:56.127133
[0m11:53:56.129119 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m11:53:56.163396 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m11:53:56.177455 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:53:56.178273 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m11:53:56.179003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:56.191682 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:53:56.192871 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:53:56.194038 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m11:53:56.197388 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m11:53:56.199978 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m11:53:56.201820 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 11:53:56.130430 => 2024-10-24 11:53:56.201749
[0m11:53:56.202829 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m11:53:56.209175 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:53:56.210547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f69fee30-74f5-458e-ad17-8ec7bf9ef20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1d046ad0>]}
[0m11:53:56.211615 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m11:53:56.213720 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m11:53:56.214841 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m11:53:56.215909 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m11:53:56.217430 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m11:53:56.218428 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m11:53:56.222322 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m11:53:56.230318 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 11:53:56.219243 => 2024-10-24 11:53:56.230234
[0m11:53:56.231568 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m11:53:56.235868 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m11:53:56.250540 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:53:56.252802 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m11:53:56.254763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:56.274095 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:53:56.275940 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:53:56.277215 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m11:53:56.280114 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m11:53:56.281326 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m11:53:56.287247 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 11:53:56.232805 => 2024-10-24 11:53:56.287086
[0m11:53:56.292038 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m11:53:56.297850 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:53:56.299426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f69fee30-74f5-458e-ad17-8ec7bf9ef20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1d0201c0>]}
[0m11:53:56.300711 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.08s]
[0m11:53:56.302515 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m11:53:56.303917 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m11:53:56.305229 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m11:53:56.306836 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m11:53:56.307864 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m11:53:56.311424 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m11:53:56.326254 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 11:53:56.308930 => 2024-10-24 11:53:56.326144
[0m11:53:56.327800 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m11:53:56.332537 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m11:53:56.346784 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:53:56.348096 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m11:53:56.349516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:56.366285 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:53:56.367690 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:53:56.368993 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m11:53:56.371422 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m11:53:56.372378 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m11:53:56.377046 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 11:53:56.329191 => 2024-10-24 11:53:56.376727
[0m11:53:56.379656 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m11:53:56.382353 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:53:56.383507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f69fee30-74f5-458e-ad17-8ec7bf9ef20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1d0465c0>]}
[0m11:53:56.384830 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.08s]
[0m11:53:56.386109 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m11:53:56.388322 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m11:53:56.389641 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m11:53:56.390817 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m11:53:56.392879 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:53:56.394232 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:56.395715 [debug] [MainThread]: On master: BEGIN
[0m11:53:56.396958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:53:56.412619 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:53:56.413963 [debug] [MainThread]: On master: COMMIT
[0m11:53:56.415172 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:56.416225 [debug] [MainThread]: On master: COMMIT
[0m11:53:56.418530 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:53:56.419834 [debug] [MainThread]: On master: Close
[0m11:53:56.421332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:56.422383 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m11:53:56.423475 [info ] [MainThread]: 
[0m11:53:56.425369 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m11:53:56.426577 [debug] [MainThread]: Command end result
[0m11:53:56.443381 [info ] [MainThread]: 
[0m11:53:56.445144 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:53:56.446854 [info ] [MainThread]: 
[0m11:53:56.448265 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m11:53:56.451271 [error] [MainThread]:   relation "public.actors" does not exist
[0m11:53:56.452872 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m11:53:56.454922 [error] [MainThread]:                             ^
[0m11:53:56.456486 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:53:56.458296 [info ] [MainThread]: 
[0m11:53:56.459739 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m11:53:56.461340 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m11:53:56.463063 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m11:53:56.464404 [error] [MainThread]:                             ^
[0m11:53:56.465745 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:53:56.466944 [info ] [MainThread]: 
[0m11:53:56.468103 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m11:53:56.469062 [error] [MainThread]:   relation "public.films" does not exist
[0m11:53:56.470183 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m11:53:56.472137 [error] [MainThread]:                             ^
[0m11:53:56.473107 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:53:56.474623 [info ] [MainThread]: 
[0m11:53:56.476230 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m11:53:56.477396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1cffe2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1d0223b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1ea79150>]}
[0m11:53:56.478692 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 11:56:40.745421 | cfd9a3b3-babf-46d8-8b34-03918a9e7009 ==============================
[0m11:56:40.745421 [info ] [MainThread]: Running with dbt=1.4.7
[0m11:56:40.748654 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:56:40.750361 [debug] [MainThread]: Tracking: tracking
[0m11:56:40.753778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28ba8d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28ba8d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28ba8d390>]}
[0m11:56:40.773713 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m11:56:40.980027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:56:40.980851 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:56:40.986778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfd9a3b3-babf-46d8-8b34-03918a9e7009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28a1bc0d0>]}
[0m11:56:40.997129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfd9a3b3-babf-46d8-8b34-03918a9e7009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28a189210>]}
[0m11:56:40.998301 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:56:41.000063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfd9a3b3-babf-46d8-8b34-03918a9e7009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28a189270>]}
[0m11:56:41.004392 [info ] [MainThread]: 
[0m11:56:41.007653 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:56:41.011402 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m11:56:41.019925 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m11:56:41.022257 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m11:56:41.024774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:41.053197 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m11:56:41.055583 [debug] [ThreadPool]: On list_destination_db: Close
[0m11:56:41.057758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m11:56:41.063973 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:56:41.065547 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m11:56:41.067067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:41.083540 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m11:56:41.085002 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:56:41.086644 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:56:41.090945 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m11:56:41.092865 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m11:56:41.095410 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m11:56:41.100879 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:41.102557 [debug] [MainThread]: On master: BEGIN
[0m11:56:41.103687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:56:41.120534 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:56:41.121984 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:41.123216 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:56:41.128347 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m11:56:41.130799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfd9a3b3-babf-46d8-8b34-03918a9e7009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28a1881c0>]}
[0m11:56:41.131995 [debug] [MainThread]: On master: ROLLBACK
[0m11:56:41.134627 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:41.135660 [debug] [MainThread]: On master: BEGIN
[0m11:56:41.138467 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:56:41.139535 [debug] [MainThread]: On master: COMMIT
[0m11:56:41.140474 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:41.141292 [debug] [MainThread]: On master: COMMIT
[0m11:56:41.142851 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:56:41.143781 [debug] [MainThread]: On master: Close
[0m11:56:41.144973 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:56:41.146185 [info ] [MainThread]: 
[0m11:56:41.161635 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m11:56:41.163011 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m11:56:41.164978 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m11:56:41.166762 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m11:56:41.180010 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m11:56:41.337130 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 11:56:41.177179 => 2024-10-24 11:56:41.337024
[0m11:56:41.338512 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m11:56:41.370416 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m11:56:41.405869 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:56:41.409012 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m11:56:41.411968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:56:41.433139 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:56:41.434307 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:56:41.435465 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m11:56:41.440389 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m11:56:41.442475 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m11:56:41.446682 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 11:56:41.339547 => 2024-10-24 11:56:41.446575
[0m11:56:41.448439 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m11:56:41.454034 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:56:41.455981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfd9a3b3-babf-46d8-8b34-03918a9e7009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28a056b30>]}
[0m11:56:41.457589 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.29s]
[0m11:56:41.460414 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m11:56:41.461957 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m11:56:41.463027 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m11:56:41.464575 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m11:56:41.465863 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m11:56:41.470348 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m11:56:41.484339 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 11:56:41.467199 => 2024-10-24 11:56:41.484230
[0m11:56:41.486284 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m11:56:41.491684 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m11:56:41.505537 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:56:41.506910 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m11:56:41.508420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:56:41.527599 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:56:41.530726 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:56:41.533432 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m11:56:41.538380 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m11:56:41.540563 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m11:56:41.545969 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 11:56:41.487990 => 2024-10-24 11:56:41.545776
[0m11:56:41.548879 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m11:56:41.552057 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:56:41.554089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfd9a3b3-babf-46d8-8b34-03918a9e7009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28a034940>]}
[0m11:56:41.555675 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.09s]
[0m11:56:41.557644 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m11:56:41.560011 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m11:56:41.562179 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m11:56:41.565321 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m11:56:41.566935 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m11:56:41.570352 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m11:56:41.581665 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 11:56:41.568056 => 2024-10-24 11:56:41.581437
[0m11:56:41.584526 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m11:56:41.590338 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m11:56:41.606151 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:56:41.607832 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m11:56:41.609378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:56:41.629851 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:56:41.631691 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:56:41.633263 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m11:56:41.636580 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m11:56:41.637677 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m11:56:41.642015 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 11:56:41.586602 => 2024-10-24 11:56:41.641856
[0m11:56:41.643704 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m11:56:41.645722 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:56:41.647043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfd9a3b3-babf-46d8-8b34-03918a9e7009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28a056620>]}
[0m11:56:41.648704 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.08s]
[0m11:56:41.650174 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m11:56:41.651822 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m11:56:41.652899 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m11:56:41.654148 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m11:56:41.656452 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:56:41.657736 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:41.658875 [debug] [MainThread]: On master: BEGIN
[0m11:56:41.660050 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:56:41.676348 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:56:41.677829 [debug] [MainThread]: On master: COMMIT
[0m11:56:41.678955 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:41.680069 [debug] [MainThread]: On master: COMMIT
[0m11:56:41.682721 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:56:41.684033 [debug] [MainThread]: On master: Close
[0m11:56:41.685670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:41.686732 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m11:56:41.687835 [info ] [MainThread]: 
[0m11:56:41.689094 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m11:56:41.690910 [debug] [MainThread]: Command end result
[0m11:56:41.708283 [info ] [MainThread]: 
[0m11:56:41.709776 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:56:41.711584 [info ] [MainThread]: 
[0m11:56:41.713617 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m11:56:41.714759 [error] [MainThread]:   relation "public.actors" does not exist
[0m11:56:41.716942 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m11:56:41.718784 [error] [MainThread]:                             ^
[0m11:56:41.720001 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:56:41.721619 [info ] [MainThread]: 
[0m11:56:41.722729 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m11:56:41.723787 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m11:56:41.724918 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m11:56:41.725953 [error] [MainThread]:                             ^
[0m11:56:41.726766 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:56:41.727956 [info ] [MainThread]: 
[0m11:56:41.728901 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m11:56:41.729824 [error] [MainThread]:   relation "public.films" does not exist
[0m11:56:41.730668 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m11:56:41.731625 [error] [MainThread]:                             ^
[0m11:56:41.732501 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:56:41.733609 [info ] [MainThread]: 
[0m11:56:41.734733 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m11:56:41.735761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28a0366b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28a035e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28ba8c7f0>]}
[0m11:56:41.737015 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 11:58:07.602072 | 68c5ab97-2f58-4912-aa5e-6fa694a3c38d ==============================
[0m11:58:07.602072 [info ] [MainThread]: Running with dbt=1.4.7
[0m11:58:07.604821 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:58:07.605689 [debug] [MainThread]: Tracking: tracking
[0m11:58:07.612422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9dd7710f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9dd7717b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9dd771390>]}
[0m11:58:07.624920 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m11:58:07.762794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:58:07.763580 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:58:07.769535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68c5ab97-2f58-4912-aa5e-6fa694a3c38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9dbe980d0>]}
[0m11:58:07.802169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68c5ab97-2f58-4912-aa5e-6fa694a3c38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9dbe65180>]}
[0m11:58:07.809910 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:58:07.812181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68c5ab97-2f58-4912-aa5e-6fa694a3c38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9dbe651e0>]}
[0m11:58:07.826096 [info ] [MainThread]: 
[0m11:58:07.830155 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:58:07.832433 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m11:58:07.842034 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m11:58:07.844012 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m11:58:07.845677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:07.875623 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m11:58:07.877971 [debug] [ThreadPool]: On list_destination_db: Close
[0m11:58:07.880674 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m11:58:07.887157 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:58:07.888970 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m11:58:07.890139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:07.903713 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m11:58:07.905079 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:58:07.906155 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:58:07.910637 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m11:58:07.912910 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m11:58:07.914887 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m11:58:07.920435 [debug] [MainThread]: Using postgres connection "master"
[0m11:58:07.921875 [debug] [MainThread]: On master: BEGIN
[0m11:58:07.923003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:58:07.936561 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:58:07.938498 [debug] [MainThread]: Using postgres connection "master"
[0m11:58:07.939666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:58:07.944169 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m11:58:07.946273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68c5ab97-2f58-4912-aa5e-6fa694a3c38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9dbe64130>]}
[0m11:58:07.947431 [debug] [MainThread]: On master: ROLLBACK
[0m11:58:07.950060 [debug] [MainThread]: Using postgres connection "master"
[0m11:58:07.951277 [debug] [MainThread]: On master: BEGIN
[0m11:58:07.954551 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:58:07.956027 [debug] [MainThread]: On master: COMMIT
[0m11:58:07.957091 [debug] [MainThread]: Using postgres connection "master"
[0m11:58:07.958228 [debug] [MainThread]: On master: COMMIT
[0m11:58:07.960672 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:58:07.961652 [debug] [MainThread]: On master: Close
[0m11:58:07.963050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:58:07.964424 [info ] [MainThread]: 
[0m11:58:07.979706 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m11:58:07.981321 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m11:58:07.983202 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m11:58:07.984408 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m11:58:07.987332 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m11:58:07.996217 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 11:58:07.985292 => 2024-10-24 11:58:07.996121
[0m11:58:07.998236 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m11:58:08.028045 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m11:58:08.039525 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:58:08.040375 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m11:58:08.040908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:08.055409 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:58:08.056946 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:58:08.058200 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m11:58:08.062610 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m11:58:08.063749 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m11:58:08.068352 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 11:58:07.999160 => 2024-10-24 11:58:08.068236
[0m11:58:08.069902 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m11:58:08.076497 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:58:08.078096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68c5ab97-2f58-4912-aa5e-6fa694a3c38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9dbd59270>]}
[0m11:58:08.079703 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.10s]
[0m11:58:08.082199 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m11:58:08.083276 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m11:58:08.084342 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m11:58:08.085993 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m11:58:08.087178 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m11:58:08.091298 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m11:58:08.100823 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 11:58:08.088347 => 2024-10-24 11:58:08.100749
[0m11:58:08.101746 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m11:58:08.105616 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m11:58:08.116026 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:58:08.117526 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m11:58:08.119012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:08.137456 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:58:08.139715 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:58:08.140968 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m11:58:08.144412 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m11:58:08.147503 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m11:58:08.151008 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 11:58:08.102630 => 2024-10-24 11:58:08.150930
[0m11:58:08.152547 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m11:58:08.154980 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:58:08.156551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68c5ab97-2f58-4912-aa5e-6fa694a3c38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9dbd0de10>]}
[0m11:58:08.158086 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m11:58:08.159733 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m11:58:08.161178 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m11:58:08.162660 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m11:58:08.164371 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m11:58:08.165738 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m11:58:08.168976 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m11:58:08.178187 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 11:58:08.166834 => 2024-10-24 11:58:08.178117
[0m11:58:08.179096 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m11:58:08.182884 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m11:58:08.191350 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:58:08.192538 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m11:58:08.193793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:08.208590 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:58:08.209853 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:58:08.211174 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m11:58:08.214013 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m11:58:08.216445 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m11:58:08.220468 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 11:58:08.179916 => 2024-10-24 11:58:08.220386
[0m11:58:08.222723 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m11:58:08.224739 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:58:08.226034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68c5ab97-2f58-4912-aa5e-6fa694a3c38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9dbd59780>]}
[0m11:58:08.227186 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.06s]
[0m11:58:08.228706 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m11:58:08.230241 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m11:58:08.231591 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m11:58:08.233120 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m11:58:08.235210 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:58:08.236308 [debug] [MainThread]: Using postgres connection "master"
[0m11:58:08.237273 [debug] [MainThread]: On master: BEGIN
[0m11:58:08.238144 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:58:08.254207 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:58:08.256606 [debug] [MainThread]: On master: COMMIT
[0m11:58:08.258491 [debug] [MainThread]: Using postgres connection "master"
[0m11:58:08.260108 [debug] [MainThread]: On master: COMMIT
[0m11:58:08.263552 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:58:08.264994 [debug] [MainThread]: On master: Close
[0m11:58:08.266847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:08.268090 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m11:58:08.269077 [info ] [MainThread]: 
[0m11:58:08.270698 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m11:58:08.272293 [debug] [MainThread]: Command end result
[0m11:58:08.287775 [info ] [MainThread]: 
[0m11:58:08.289565 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:58:08.291430 [info ] [MainThread]: 
[0m11:58:08.292912 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m11:58:08.295564 [error] [MainThread]:   relation "public.actors" does not exist
[0m11:58:08.297084 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m11:58:08.298802 [error] [MainThread]:                             ^
[0m11:58:08.300201 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m11:58:08.301761 [info ] [MainThread]: 
[0m11:58:08.303046 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m11:58:08.304120 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m11:58:08.305139 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m11:58:08.306256 [error] [MainThread]:                             ^
[0m11:58:08.307394 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m11:58:08.308865 [info ] [MainThread]: 
[0m11:58:08.310168 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m11:58:08.311413 [error] [MainThread]:   relation "public.films" does not exist
[0m11:58:08.312375 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m11:58:08.313200 [error] [MainThread]:                             ^
[0m11:58:08.314192 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m11:58:08.315225 [info ] [MainThread]: 
[0m11:58:08.316279 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m11:58:08.317498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9dbee9f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9dbd0d900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9dd771150>]}
[0m11:58:08.318574 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 12:00:36.168266 | ccd50129-78b8-417b-b0d9-d802631102de ==============================
[0m12:00:36.168266 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:00:36.172985 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:00:36.174449 [debug] [MainThread]: Tracking: tracking
[0m12:00:36.180921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4d1e5360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4d1e57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4d1e53c0>]}
[0m12:00:36.195422 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m12:00:36.314371 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 6 files added, 0 files changed.
[0m12:00:36.315413 [debug] [MainThread]: Partial parsing: added file: custom_postgres://models/film_actors.sql
[0m12:00:36.316153 [debug] [MainThread]: Partial parsing: added file: custom_postgres://models/film_ratings.sql
[0m12:00:36.316678 [debug] [MainThread]: Partial parsing: added file: custom_postgres://models/films.sql
[0m12:00:36.317467 [debug] [MainThread]: Partial parsing: added file: custom_postgres://models/sources.yml
[0m12:00:36.318124 [debug] [MainThread]: Partial parsing: added file: custom_postgres://models/schema.yml
[0m12:00:36.318666 [debug] [MainThread]: Partial parsing: added file: custom_postgres://models/actors.sql
[0m12:00:36.319282 [debug] [MainThread]: Partial parsing: deleted file: custom_postgres://models/example/actors.sql
[0m12:00:36.319843 [debug] [MainThread]: Partial parsing: deleted file: custom_postgres://models/example/film_ratings.sql
[0m12:00:36.320273 [debug] [MainThread]: Partial parsing: deleted file: custom_postgres://models/example/film_actors.sql
[0m12:00:36.320699 [debug] [MainThread]: Partial parsing: deleted file: custom_postgres://models/example/films.sql
[0m12:00:36.337958 [debug] [MainThread]: 1699: static parser successfully parsed film_actors.sql
[0m12:00:36.351184 [debug] [MainThread]: 1699: static parser successfully parsed film_ratings.sql
[0m12:00:36.354342 [debug] [MainThread]: 1699: static parser successfully parsed films.sql
[0m12:00:36.357518 [debug] [MainThread]: 1699: static parser successfully parsed actors.sql
[0m12:00:36.420141 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m12:00:36.427352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccd50129-78b8-417b-b0d9-d802631102de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4998feb0>]}
[0m12:00:36.603787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccd50129-78b8-417b-b0d9-d802631102de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4d1ff730>]}
[0m12:00:36.616058 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:00:36.618017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccd50129-78b8-417b-b0d9-d802631102de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4d1fd1b0>]}
[0m12:00:36.622169 [info ] [MainThread]: 
[0m12:00:36.627046 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:00:36.631328 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m12:00:36.646194 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m12:00:36.648502 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m12:00:36.650308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:36.676247 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m12:00:36.678342 [debug] [ThreadPool]: On list_destination_db: Close
[0m12:00:36.680686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m12:00:36.686894 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m12:00:36.688052 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m12:00:36.688993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:36.700237 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:00:36.701355 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m12:00:36.702191 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:00:36.706351 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m12:00:36.708313 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m12:00:36.710258 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m12:00:36.715287 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:36.716447 [debug] [MainThread]: On master: BEGIN
[0m12:00:36.717336 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:00:36.728489 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:00:36.729737 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:36.730733 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:00:36.734969 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m12:00:36.736907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccd50129-78b8-417b-b0d9-d802631102de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b499d3730>]}
[0m12:00:36.738018 [debug] [MainThread]: On master: ROLLBACK
[0m12:00:36.739899 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:36.740921 [debug] [MainThread]: On master: BEGIN
[0m12:00:36.743848 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:00:36.745200 [debug] [MainThread]: On master: COMMIT
[0m12:00:36.746024 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:36.746747 [debug] [MainThread]: On master: COMMIT
[0m12:00:36.748796 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:00:36.749730 [debug] [MainThread]: On master: Close
[0m12:00:36.750797 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:00:36.752044 [info ] [MainThread]: 
[0m12:00:36.767228 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m12:00:36.768817 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m12:00:36.770690 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m12:00:36.771900 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m12:00:36.775537 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m12:00:36.782289 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 12:00:36.772767 => 2024-10-24 12:00:36.782210
[0m12:00:36.783183 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m12:00:36.814899 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m12:00:36.831059 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:00:36.832184 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m12:00:36.833118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:36.852567 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:00:36.853843 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:00:36.854650 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m12:00:36.860365 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m12:00:36.860980 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m12:00:36.862537 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 12:00:36.784103 => 2024-10-24 12:00:36.862469
[0m12:00:36.863391 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m12:00:36.868568 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m12:00:36.869888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd50129-78b8-417b-b0d9-d802631102de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b49a3a950>]}
[0m12:00:36.871181 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.10s]
[0m12:00:36.873555 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m12:00:36.874600 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m12:00:36.875532 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m12:00:36.876965 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m12:00:36.877722 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m12:00:36.880708 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m12:00:36.889936 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 12:00:36.878485 => 2024-10-24 12:00:36.889846
[0m12:00:36.890870 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m12:00:36.894668 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m12:00:36.900935 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:00:36.901674 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m12:00:36.902551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:36.929615 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:00:36.930640 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:00:36.931523 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m12:00:36.936090 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m12:00:36.937386 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m12:00:36.939332 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 12:00:36.891714 => 2024-10-24 12:00:36.939262
[0m12:00:36.940418 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m12:00:36.941786 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m12:00:36.942684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd50129-78b8-417b-b0d9-d802631102de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b49a2d8a0>]}
[0m12:00:36.943711 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.07s]
[0m12:00:36.945021 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m12:00:36.946100 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m12:00:36.947104 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m12:00:36.949177 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m12:00:36.950077 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m12:00:36.953200 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m12:00:36.959779 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 12:00:36.950742 => 2024-10-24 12:00:36.959708
[0m12:00:36.960705 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m12:00:36.964868 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m12:00:36.971047 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:00:36.971870 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m12:00:36.972725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:36.984778 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:00:36.985697 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:00:36.986817 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m12:00:36.989024 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m12:00:36.992299 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m12:00:36.994095 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 12:00:36.961489 => 2024-10-24 12:00:36.994029
[0m12:00:36.994970 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m12:00:36.996466 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m12:00:36.997431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd50129-78b8-417b-b0d9-d802631102de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b49a3af50>]}
[0m12:00:36.998382 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.05s]
[0m12:00:36.999986 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m12:00:37.001530 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m12:00:37.002447 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m12:00:37.004094 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m12:00:37.006080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:00:37.006999 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:37.007786 [debug] [MainThread]: On master: BEGIN
[0m12:00:37.008672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:00:37.020510 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:00:37.021633 [debug] [MainThread]: On master: COMMIT
[0m12:00:37.022453 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:37.023176 [debug] [MainThread]: On master: COMMIT
[0m12:00:37.026003 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:00:37.029150 [debug] [MainThread]: On master: Close
[0m12:00:37.030483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:37.031246 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m12:00:37.032054 [info ] [MainThread]: 
[0m12:00:37.033444 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m12:00:37.034923 [debug] [MainThread]: Command end result
[0m12:00:37.060090 [info ] [MainThread]: 
[0m12:00:37.063157 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:00:37.065597 [info ] [MainThread]: 
[0m12:00:37.067136 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m12:00:37.068560 [error] [MainThread]:   relation "public.actors" does not exist
[0m12:00:37.071665 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m12:00:37.073196 [error] [MainThread]:                             ^
[0m12:00:37.074456 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m12:00:37.075784 [info ] [MainThread]: 
[0m12:00:37.077093 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m12:00:37.078413 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m12:00:37.079590 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m12:00:37.080741 [error] [MainThread]:                             ^
[0m12:00:37.081978 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m12:00:37.083318 [info ] [MainThread]: 
[0m12:00:37.084428 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m12:00:37.085406 [error] [MainThread]:   relation "public.films" does not exist
[0m12:00:37.086626 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m12:00:37.087763 [error] [MainThread]:                             ^
[0m12:00:37.088958 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m12:00:37.090013 [info ] [MainThread]: 
[0m12:00:37.091070 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m12:00:37.092306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4d1b83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4d1ba4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4d1bacb0>]}
[0m12:00:37.093378 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 12:17:35.348541 | 910379ac-b81f-4887-9025-1ac094e54725 ==============================
[0m12:17:35.348541 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:17:35.353442 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:17:35.354967 [debug] [MainThread]: Tracking: tracking
[0m12:17:35.371341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3d7310f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3d7317b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3d731390>]}
[0m12:17:35.389631 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m12:17:35.482649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3d730dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3be28580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3be28430>]}
[0m12:17:35.483581 [debug] [MainThread]: Flushing usage events
[0m12:17:37.235336 [error] [MainThread]: Encountered an error:
Compilation Error
  The yml property file at models/schema.yml is invalid because its 'version:' tag is set to 3.  Only 2 is supported. Please consult the documentation for more information on yml property file syntax:
  
  https://docs.getdbt.com/reference/configs-and-properties


============================== 2024-10-24 12:18:20.595353 | cb4838ee-40ea-4365-b9ae-e35e8e8c66f4 ==============================
[0m12:18:20.595353 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:18:20.598483 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:18:20.599123 [debug] [MainThread]: Tracking: tracking
[0m12:18:20.601782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f867be21360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f867be217e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f867be213c0>]}
[0m12:18:20.617514 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m12:18:20.745319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:18:20.746138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:18:20.747006 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m12:18:20.755039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb4838ee-40ea-4365-b9ae-e35e8e8c66f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f867a5540d0>]}
[0m12:18:20.769962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb4838ee-40ea-4365-b9ae-e35e8e8c66f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f867a51d1e0>]}
[0m12:18:20.770626 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:18:20.772305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb4838ee-40ea-4365-b9ae-e35e8e8c66f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f867a51d240>]}
[0m12:18:20.774618 [info ] [MainThread]: 
[0m12:18:20.777397 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:18:20.779964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m12:18:20.791051 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m12:18:20.792282 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m12:18:20.793192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:20.826759 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m12:18:20.829257 [debug] [ThreadPool]: On list_destination_db: Close
[0m12:18:20.832714 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m12:18:20.838814 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m12:18:20.840194 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m12:18:20.841237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:20.866129 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:18:20.868115 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m12:18:20.869939 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:18:20.875705 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m12:18:20.877783 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m12:18:20.880554 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m12:18:20.886238 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:20.887805 [debug] [MainThread]: On master: BEGIN
[0m12:18:20.889386 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:20.904819 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:18:20.906499 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:20.908188 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:18:20.913082 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m12:18:20.915236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb4838ee-40ea-4365-b9ae-e35e8e8c66f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f867a51c610>]}
[0m12:18:20.916680 [debug] [MainThread]: On master: ROLLBACK
[0m12:18:20.919375 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:20.920399 [debug] [MainThread]: On master: BEGIN
[0m12:18:20.923881 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:18:20.925364 [debug] [MainThread]: On master: COMMIT
[0m12:18:20.926693 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:20.928180 [debug] [MainThread]: On master: COMMIT
[0m12:18:20.930864 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:18:20.932517 [debug] [MainThread]: On master: Close
[0m12:18:20.934497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:18:20.935679 [info ] [MainThread]: 
[0m12:18:20.950015 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m12:18:20.951659 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m12:18:20.953886 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m12:18:20.955563 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m12:18:20.959558 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m12:18:20.973213 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 12:18:20.957208 => 2024-10-24 12:18:20.973090
[0m12:18:20.974945 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m12:18:21.007164 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m12:18:21.024860 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:18:21.026490 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m12:18:21.027888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:21.042790 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:18:21.044089 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:18:21.045052 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m12:18:21.048671 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m12:18:21.049945 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m12:18:21.052182 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 12:18:20.976570 => 2024-10-24 12:18:21.052113
[0m12:18:21.053606 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m12:18:21.060506 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m12:18:21.061946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb4838ee-40ea-4365-b9ae-e35e8e8c66f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f867a3e6a40>]}
[0m12:18:21.063264 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.11s]
[0m12:18:21.065850 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m12:18:21.067390 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m12:18:21.068493 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m12:18:21.069850 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m12:18:21.071268 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m12:18:21.075610 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m12:18:21.088261 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 12:18:21.072481 => 2024-10-24 12:18:21.088165
[0m12:18:21.089995 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m12:18:21.094911 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m12:18:21.113626 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:18:21.115562 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m12:18:21.117387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:21.138847 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:18:21.140415 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:18:21.141761 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m12:18:21.144965 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m12:18:21.146310 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m12:18:21.148631 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 12:18:21.091611 => 2024-10-24 12:18:21.148547
[0m12:18:21.150155 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m12:18:21.152103 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m12:18:21.153299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb4838ee-40ea-4365-b9ae-e35e8e8c66f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f867a5981f0>]}
[0m12:18:21.155435 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.08s]
[0m12:18:21.156689 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m12:18:21.157637 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m12:18:21.159084 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m12:18:21.160479 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m12:18:21.161871 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m12:18:21.165331 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m12:18:21.175434 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 12:18:21.163098 => 2024-10-24 12:18:21.175353
[0m12:18:21.176492 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m12:18:21.180702 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m12:18:21.186218 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:18:21.186907 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m12:18:21.187587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:21.202680 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:18:21.204039 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:18:21.205166 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m12:18:21.207904 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m12:18:21.209038 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m12:18:21.211088 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 12:18:21.177450 => 2024-10-24 12:18:21.211029
[0m12:18:21.212317 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m12:18:21.213893 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m12:18:21.215174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb4838ee-40ea-4365-b9ae-e35e8e8c66f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f867a3e6560>]}
[0m12:18:21.217137 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.05s]
[0m12:18:21.218376 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m12:18:21.220037 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m12:18:21.221047 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m12:18:21.222310 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m12:18:21.224503 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:18:21.225750 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:21.227334 [debug] [MainThread]: On master: BEGIN
[0m12:18:21.235764 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:18:21.249430 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:18:21.250569 [debug] [MainThread]: On master: COMMIT
[0m12:18:21.251447 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:21.252167 [debug] [MainThread]: On master: COMMIT
[0m12:18:21.253780 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:18:21.254598 [debug] [MainThread]: On master: Close
[0m12:18:21.255864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:21.256909 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m12:18:21.258306 [info ] [MainThread]: 
[0m12:18:21.259250 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m12:18:21.260185 [debug] [MainThread]: Command end result
[0m12:18:21.276404 [info ] [MainThread]: 
[0m12:18:21.281808 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:18:21.287937 [info ] [MainThread]: 
[0m12:18:21.294371 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m12:18:21.296044 [error] [MainThread]:   relation "public.actors" does not exist
[0m12:18:21.297443 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m12:18:21.298714 [error] [MainThread]:                             ^
[0m12:18:21.299725 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m12:18:21.300755 [info ] [MainThread]: 
[0m12:18:21.301761 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m12:18:21.302656 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m12:18:21.304048 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m12:18:21.305221 [error] [MainThread]:                             ^
[0m12:18:21.306307 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m12:18:21.307566 [info ] [MainThread]: 
[0m12:18:21.308358 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m12:18:21.309046 [error] [MainThread]:   relation "public.films" does not exist
[0m12:18:21.309716 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m12:18:21.310394 [error] [MainThread]:                             ^
[0m12:18:21.311013 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m12:18:21.311639 [info ] [MainThread]: 
[0m12:18:21.312273 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m12:18:21.313138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f867a5a2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f867a5990c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f867a599b10>]}
[0m12:18:21.313867 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 12:21:37.634149 | 7e136ed8-245b-41c0-9325-f82912e85a39 ==============================
[0m12:21:37.634149 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:21:37.637855 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:21:37.639180 [debug] [MainThread]: Tracking: tracking
[0m12:21:37.646997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed4888b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed488b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed4888b20>]}
[0m12:21:37.666917 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m12:21:37.889091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:21:37.890082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:21:37.891026 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m12:21:37.896895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e136ed8-245b-41c0-9325-f82912e85a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed2f2c0d0>]}
[0m12:21:37.920933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e136ed8-245b-41c0-9325-f82912e85a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed2ef9180>]}
[0m12:21:37.925735 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:21:37.928046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e136ed8-245b-41c0-9325-f82912e85a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed6180a00>]}
[0m12:21:37.932979 [info ] [MainThread]: 
[0m12:21:37.936007 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:21:37.940853 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m12:21:37.953821 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m12:21:37.955919 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m12:21:37.957449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:38.001907 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m12:21:38.004402 [debug] [ThreadPool]: On list_destination_db: Close
[0m12:21:38.007243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m12:21:38.013834 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m12:21:38.015474 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m12:21:38.017156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:38.036875 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:21:38.038364 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m12:21:38.039313 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:21:38.047231 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m12:21:38.049544 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m12:21:38.052373 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m12:21:38.057588 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:38.059052 [debug] [MainThread]: On master: BEGIN
[0m12:21:38.059997 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:38.077968 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:21:38.079452 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:38.080732 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:21:38.089674 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m12:21:38.092041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e136ed8-245b-41c0-9325-f82912e85a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed2ef8130>]}
[0m12:21:38.093548 [debug] [MainThread]: On master: ROLLBACK
[0m12:21:38.096536 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:38.097990 [debug] [MainThread]: On master: BEGIN
[0m12:21:38.102449 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:21:38.104117 [debug] [MainThread]: On master: COMMIT
[0m12:21:38.105294 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:38.106295 [debug] [MainThread]: On master: COMMIT
[0m12:21:38.109324 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:21:38.110462 [debug] [MainThread]: On master: Close
[0m12:21:38.112018 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:21:38.114914 [info ] [MainThread]: 
[0m12:21:38.122404 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m12:21:38.124398 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m12:21:38.126048 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m12:21:38.127284 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m12:21:38.130857 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m12:21:38.142183 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 12:21:38.128333 => 2024-10-24 12:21:38.142061
[0m12:21:38.143719 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m12:21:38.176538 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m12:21:38.193638 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:21:38.195024 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m12:21:38.196229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:38.210851 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:21:38.212182 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:21:38.213399 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m12:21:38.216571 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m12:21:38.218302 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m12:21:38.223179 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 12:21:38.144945 => 2024-10-24 12:21:38.223089
[0m12:21:38.224638 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m12:21:38.233536 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m12:21:38.235330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e136ed8-245b-41c0-9325-f82912e85a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed2f857e0>]}
[0m12:21:38.236803 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.11s]
[0m12:21:38.239408 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m12:21:38.240768 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m12:21:38.242087 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m12:21:38.243642 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m12:21:38.244761 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m12:21:38.248395 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m12:21:38.258717 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 12:21:38.245754 => 2024-10-24 12:21:38.258597
[0m12:21:38.260291 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m12:21:38.266185 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m12:21:38.276034 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:21:38.277742 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m12:21:38.279053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:38.298565 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:21:38.300142 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:21:38.301272 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m12:21:38.304370 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m12:21:38.308939 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m12:21:38.313015 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 12:21:38.261609 => 2024-10-24 12:21:38.312903
[0m12:21:38.315465 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m12:21:38.317497 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m12:21:38.318668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e136ed8-245b-41c0-9325-f82912e85a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed2e0da80>]}
[0m12:21:38.320039 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.08s]
[0m12:21:38.321225 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m12:21:38.322414 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m12:21:38.323624 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m12:21:38.325092 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m12:21:38.326445 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m12:21:38.329677 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m12:21:38.338938 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 12:21:38.327319 => 2024-10-24 12:21:38.338818
[0m12:21:38.340169 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m12:21:38.344918 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m12:21:38.353927 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:21:38.355230 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m12:21:38.356382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:38.373993 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:21:38.375455 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:21:38.376701 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m12:21:38.380632 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m12:21:38.384212 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m12:21:38.387648 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 12:21:38.341396 => 2024-10-24 12:21:38.387567
[0m12:21:38.389084 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m12:21:38.391405 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m12:21:38.392920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e136ed8-245b-41c0-9325-f82912e85a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed2db7d90>]}
[0m12:21:38.394243 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.07s]
[0m12:21:38.395983 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m12:21:38.397832 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m12:21:38.399060 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m12:21:38.401184 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m12:21:38.403973 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:21:38.405400 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:38.406385 [debug] [MainThread]: On master: BEGIN
[0m12:21:38.407327 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:21:38.424166 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:21:38.425975 [debug] [MainThread]: On master: COMMIT
[0m12:21:38.427389 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:38.428598 [debug] [MainThread]: On master: COMMIT
[0m12:21:38.432257 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:21:38.433510 [debug] [MainThread]: On master: Close
[0m12:21:38.434816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:38.436022 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m12:21:38.437017 [info ] [MainThread]: 
[0m12:21:38.438462 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m12:21:38.441025 [debug] [MainThread]: Command end result
[0m12:21:38.459132 [info ] [MainThread]: 
[0m12:21:38.460487 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:21:38.461884 [info ] [MainThread]: 
[0m12:21:38.465400 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m12:21:38.469091 [error] [MainThread]:   relation "public.actors" does not exist
[0m12:21:38.473805 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m12:21:38.476684 [error] [MainThread]:                             ^
[0m12:21:38.480258 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m12:21:38.483675 [info ] [MainThread]: 
[0m12:21:38.485827 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m12:21:38.488909 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m12:21:38.491593 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m12:21:38.494586 [error] [MainThread]:                             ^
[0m12:21:38.496809 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m12:21:38.499382 [info ] [MainThread]: 
[0m12:21:38.501159 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m12:21:38.503826 [error] [MainThread]:   relation "public.films" does not exist
[0m12:21:38.505236 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m12:21:38.507098 [error] [MainThread]:                             ^
[0m12:21:38.508695 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m12:21:38.510095 [info ] [MainThread]: 
[0m12:21:38.511517 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m12:21:38.513242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed2db7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed2db7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed2dfffd0>]}
[0m12:21:38.514799 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 12:24:04.021619 | 0d181d2e-e4b5-4f63-895e-eb8718b4dafc ==============================
[0m12:24:04.021619 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:24:04.024485 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:24:04.025780 [debug] [MainThread]: Tracking: tracking
[0m12:24:04.033400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412deb90f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412deb97b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412deb9390>]}
[0m12:24:04.055360 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m12:24:04.318747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:24:04.320633 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:24:04.323023 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m12:24:04.338548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d181d2e-e4b5-4f63-895e-eb8718b4dafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412c5ec0d0>]}
[0m12:24:04.364992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d181d2e-e4b5-4f63-895e-eb8718b4dafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412c5b9210>]}
[0m12:24:04.366520 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:24:04.367943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d181d2e-e4b5-4f63-895e-eb8718b4dafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412c5b9270>]}
[0m12:24:04.370809 [info ] [MainThread]: 
[0m12:24:04.374610 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:24:04.378036 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m12:24:04.389789 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m12:24:04.391876 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m12:24:04.393937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:04.436339 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m12:24:04.438418 [debug] [ThreadPool]: On list_destination_db: Close
[0m12:24:04.441439 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m12:24:04.447636 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m12:24:04.448871 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m12:24:04.449893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:04.466885 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:24:04.468213 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m12:24:04.469107 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:24:04.473096 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m12:24:04.474988 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m12:24:04.477116 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m12:24:04.482680 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:04.484050 [debug] [MainThread]: On master: BEGIN
[0m12:24:04.485196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:24:04.502011 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:24:04.503255 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:04.504286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:24:04.513350 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m12:24:04.515346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d181d2e-e4b5-4f63-895e-eb8718b4dafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412c5b81c0>]}
[0m12:24:04.516488 [debug] [MainThread]: On master: ROLLBACK
[0m12:24:04.518835 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:04.520076 [debug] [MainThread]: On master: BEGIN
[0m12:24:04.523907 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:24:04.524887 [debug] [MainThread]: On master: COMMIT
[0m12:24:04.525749 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:04.526623 [debug] [MainThread]: On master: COMMIT
[0m12:24:04.528413 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:24:04.529434 [debug] [MainThread]: On master: Close
[0m12:24:04.530777 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:24:04.532233 [info ] [MainThread]: 
[0m12:24:04.550664 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m12:24:04.552235 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m12:24:04.554029 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m12:24:04.555433 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m12:24:04.558892 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m12:24:04.568924 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 12:24:04.556536 => 2024-10-24 12:24:04.568820
[0m12:24:04.570228 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m12:24:04.601068 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m12:24:04.614717 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:24:04.617966 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m12:24:04.619498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:04.639023 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:24:04.640574 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:24:04.641673 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m12:24:04.645339 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m12:24:04.647031 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m12:24:04.650743 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 12:24:04.571423 => 2024-10-24 12:24:04.650577
[0m12:24:04.652200 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m12:24:04.661126 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m12:24:04.662701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d181d2e-e4b5-4f63-895e-eb8718b4dafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412c4a52a0>]}
[0m12:24:04.664092 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.11s]
[0m12:24:04.667360 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m12:24:04.669010 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m12:24:04.670371 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m12:24:04.673745 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m12:24:04.676451 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m12:24:04.681498 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m12:24:04.697411 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 12:24:04.678115 => 2024-10-24 12:24:04.697294
[0m12:24:04.699171 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m12:24:04.703652 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m12:24:04.721913 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:24:04.723894 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m12:24:04.725373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:04.742199 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:24:04.743620 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:24:04.744744 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m12:24:04.748893 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m12:24:04.750093 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m12:24:04.752272 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 12:24:04.700447 => 2024-10-24 12:24:04.752197
[0m12:24:04.758589 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m12:24:04.761103 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m12:24:04.762612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d181d2e-e4b5-4f63-895e-eb8718b4dafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412c4a55a0>]}
[0m12:24:04.763696 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.09s]
[0m12:24:04.765343 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m12:24:04.766493 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m12:24:04.767877 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m12:24:04.769521 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m12:24:04.770857 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m12:24:04.774224 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m12:24:04.785722 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 12:24:04.771711 => 2024-10-24 12:24:04.785613
[0m12:24:04.787272 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m12:24:04.792121 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m12:24:04.802564 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:24:04.804344 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m12:24:04.806155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:04.820946 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:24:04.821952 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:24:04.823333 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m12:24:04.825946 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m12:24:04.827435 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m12:24:04.830016 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 12:24:04.788744 => 2024-10-24 12:24:04.829908
[0m12:24:04.831355 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m12:24:04.833491 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m12:24:04.835827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d181d2e-e4b5-4f63-895e-eb8718b4dafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412c447040>]}
[0m12:24:04.837532 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.07s]
[0m12:24:04.839031 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m12:24:04.841566 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m12:24:04.843377 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m12:24:04.844912 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m12:24:04.847295 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:24:04.848411 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:04.849582 [debug] [MainThread]: On master: BEGIN
[0m12:24:04.850523 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:24:04.865685 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:24:04.866870 [debug] [MainThread]: On master: COMMIT
[0m12:24:04.868049 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:04.869016 [debug] [MainThread]: On master: COMMIT
[0m12:24:04.872056 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:24:04.873853 [debug] [MainThread]: On master: Close
[0m12:24:04.875683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:04.876734 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m12:24:04.877925 [info ] [MainThread]: 
[0m12:24:04.879023 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m12:24:04.880426 [debug] [MainThread]: Command end result
[0m12:24:04.897225 [info ] [MainThread]: 
[0m12:24:04.898711 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:24:04.900165 [info ] [MainThread]: 
[0m12:24:04.901228 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m12:24:04.902705 [error] [MainThread]:   relation "public.actors" does not exist
[0m12:24:04.903908 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m12:24:04.906000 [error] [MainThread]:                             ^
[0m12:24:04.908105 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m12:24:04.909939 [info ] [MainThread]: 
[0m12:24:04.911560 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m12:24:04.912781 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m12:24:04.914042 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m12:24:04.915244 [error] [MainThread]:                             ^
[0m12:24:04.916508 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m12:24:04.917696 [info ] [MainThread]: 
[0m12:24:04.919371 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m12:24:04.920598 [error] [MainThread]:   relation "public.films" does not exist
[0m12:24:04.921997 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m12:24:04.923506 [error] [MainThread]:                             ^
[0m12:24:04.924635 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m12:24:04.926476 [info ] [MainThread]: 
[0m12:24:04.928346 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m12:24:04.930801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412c4bb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412c446e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412c446ec0>]}
[0m12:24:04.932347 [debug] [MainThread]: Flushing usage events


============================== 2024-10-24 12:24:51.039875 | 4f0fc207-8ede-4a05-9516-d5c529080765 ==============================
[0m12:24:51.039875 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:24:51.042081 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:24:51.042786 [debug] [MainThread]: Tracking: tracking
[0m12:24:51.048280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6cfbc1360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6cfbc17e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6cfbc13c0>]}
[0m12:24:51.067777 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m12:24:51.241173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:24:51.242390 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/films.sql
[0m12:24:51.258697 [debug] [MainThread]: 1603: static parser failed on films.sql
[0m12:24:51.264161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ce4197e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ce2e5900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ce2e5990>]}
[0m12:24:51.265436 [debug] [MainThread]: Flushing usage events
[0m12:24:52.352856 [error] [MainThread]: Encountered an error:
Compilation Error in model films (models/films.sql)
  expected name or number
    line 1
      SELECT * FROM {{ source('destination_db'.'films') }}


============================== 2024-10-24 12:29:34.296620 | 3d40d6d5-8e7c-4a2a-b019-ce3973128c11 ==============================
[0m12:29:34.296620 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:29:34.299952 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:29:34.300695 [debug] [MainThread]: Tracking: tracking
[0m12:29:34.309431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7187cc90f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7187cc97b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7187cc9390>]}
[0m12:29:34.325325 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m12:29:34.341649 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:29:34.343317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d40d6d5-8e7c-4a2a-b019-ce3973128c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7187cc8130>]}
[0m12:29:35.014982 [debug] [MainThread]: 1699: static parser successfully parsed actors.sql
[0m12:29:35.029095 [debug] [MainThread]: 1699: static parser successfully parsed films.sql
[0m12:29:35.032802 [debug] [MainThread]: 1699: static parser successfully parsed film_actors.sql
[0m12:29:35.037397 [debug] [MainThread]: 1699: static parser successfully parsed film_ratings.sql
[0m12:29:35.141431 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m12:29:35.150222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d40d6d5-8e7c-4a2a-b019-ce3973128c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71863c74f0>]}
[0m12:29:35.184193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d40d6d5-8e7c-4a2a-b019-ce3973128c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7187e362c0>]}
[0m12:29:35.185982 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:29:35.187684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d40d6d5-8e7c-4a2a-b019-ce3973128c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7187cc8460>]}
[0m12:29:35.190980 [info ] [MainThread]: 
[0m12:29:35.195542 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:29:35.198858 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m12:29:35.212046 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m12:29:35.213639 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m12:29:35.215006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:35.278662 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m12:29:35.281569 [debug] [ThreadPool]: On list_destination_db: Close
[0m12:29:35.285783 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m12:29:35.292398 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m12:29:35.294358 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m12:29:35.296393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:35.312394 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:29:35.313885 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m12:29:35.315079 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:29:35.320207 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m12:29:35.322689 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m12:29:35.326186 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m12:29:35.332109 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:35.333324 [debug] [MainThread]: On master: BEGIN
[0m12:29:35.334735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:35.351374 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:29:35.352942 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:35.354771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:29:35.360274 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m12:29:35.362782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d40d6d5-8e7c-4a2a-b019-ce3973128c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71842878b0>]}
[0m12:29:35.364110 [debug] [MainThread]: On master: ROLLBACK
[0m12:29:35.366992 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:35.368216 [debug] [MainThread]: On master: BEGIN
[0m12:29:35.372843 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:29:35.374031 [debug] [MainThread]: On master: COMMIT
[0m12:29:35.374933 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:35.376058 [debug] [MainThread]: On master: COMMIT
[0m12:29:35.377993 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:29:35.379063 [debug] [MainThread]: On master: Close
[0m12:29:35.380524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:29:35.382038 [info ] [MainThread]: 
[0m12:29:35.397568 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m12:29:35.399045 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m12:29:35.400680 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m12:29:35.401613 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m12:29:35.405615 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m12:29:35.414010 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-24 12:29:35.402804 => 2024-10-24 12:29:35.413890
[0m12:29:35.415184 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m12:29:35.447159 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m12:29:35.466624 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:29:35.469441 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m12:29:35.470396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:35.499643 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:29:35.501136 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:29:35.502304 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m12:29:35.510566 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m12:29:35.513405 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m12:29:35.517339 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-24 12:29:35.416139 => 2024-10-24 12:29:35.517248
[0m12:29:35.518241 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m12:29:35.525798 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m12:29:35.527776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d40d6d5-8e7c-4a2a-b019-ce3973128c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71842d8f40>]}
[0m12:29:35.530161 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.13s]
[0m12:29:35.532472 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m12:29:35.535347 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m12:29:35.536777 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m12:29:35.538299 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m12:29:35.539208 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m12:29:35.542513 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m12:29:35.561476 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-24 12:29:35.540084 => 2024-10-24 12:29:35.561356
[0m12:29:35.565699 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m12:29:35.570201 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m12:29:35.579670 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:29:35.581490 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m12:29:35.582286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:35.602654 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:29:35.604134 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:29:35.604879 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m12:29:35.608027 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m12:29:35.609632 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m12:29:35.611625 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-24 12:29:35.566910 => 2024-10-24 12:29:35.611554
[0m12:29:35.613048 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m12:29:35.614564 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m12:29:35.616691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d40d6d5-8e7c-4a2a-b019-ce3973128c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7184314460>]}
[0m12:29:35.618831 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.08s]
[0m12:29:35.621765 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m12:29:35.623180 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m12:29:35.624603 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m12:29:35.626489 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m12:29:35.627959 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m12:29:35.631003 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m12:29:35.639251 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-24 12:29:35.628667 => 2024-10-24 12:29:35.639134
[0m12:29:35.640711 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m12:29:35.645927 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m12:29:35.654749 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:29:35.655845 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m12:29:35.656960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:35.671792 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:29:35.673138 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:29:35.674210 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m12:29:35.676716 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m12:29:35.677928 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m12:29:35.682938 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-24 12:29:35.641758 => 2024-10-24 12:29:35.682807
[0m12:29:35.684655 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m12:29:35.687752 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m12:29:35.690805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d40d6d5-8e7c-4a2a-b019-ce3973128c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71842d07f0>]}
[0m12:29:35.692481 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.06s]
[0m12:29:35.693992 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m12:29:35.696183 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m12:29:35.697118 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m12:29:35.698388 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m12:29:35.700541 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:29:35.701870 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:35.703495 [debug] [MainThread]: On master: BEGIN
[0m12:29:35.704483 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:29:35.793822 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:29:35.795649 [debug] [MainThread]: On master: COMMIT
[0m12:29:35.820164 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:35.821654 [debug] [MainThread]: On master: COMMIT
[0m12:29:35.825020 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:29:35.826318 [debug] [MainThread]: On master: Close
[0m12:29:35.828254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:35.829388 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m12:29:35.830610 [info ] [MainThread]: 
[0m12:29:35.831787 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m12:29:35.833450 [debug] [MainThread]: Command end result
[0m12:29:35.859960 [info ] [MainThread]: 
[0m12:29:35.862006 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:29:35.863425 [info ] [MainThread]: 
[0m12:29:35.864792 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m12:29:35.866165 [error] [MainThread]:   relation "public.actors" does not exist
[0m12:29:35.867742 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m12:29:35.868895 [error] [MainThread]:                             ^
[0m12:29:35.870182 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m12:29:35.871824 [info ] [MainThread]: 
[0m12:29:35.873168 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m12:29:35.874322 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m12:29:35.875588 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m12:29:35.876832 [error] [MainThread]:                             ^
[0m12:29:35.878029 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m12:29:35.880727 [info ] [MainThread]: 
[0m12:29:35.882112 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m12:29:35.883631 [error] [MainThread]:   relation "public.films" does not exist
[0m12:29:35.884770 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m12:29:35.885797 [error] [MainThread]:                             ^
[0m12:29:35.886943 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m12:29:35.888272 [info ] [MainThread]: 
[0m12:29:35.889802 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m12:29:35.891412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7186415b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7186415ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7186416560>]}
[0m12:29:35.892799 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 01:45:58.720969 | 22e43eb2-8775-4740-a4a7-a9a260febee7 ==============================
[0m01:45:58.720969 [info ] [MainThread]: Running with dbt=1.4.7
[0m01:45:58.725795 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:45:58.727545 [debug] [MainThread]: Tracking: tracking
[0m01:45:58.740123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc0c825360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc0c8257e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc0c8253c0>]}
[0m01:45:58.770781 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m01:45:58.803823 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:45:58.806020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '22e43eb2-8775-4740-a4a7-a9a260febee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc0c824100>]}
[0m01:45:59.674661 [debug] [MainThread]: 1699: static parser successfully parsed actors.sql
[0m01:45:59.684778 [debug] [MainThread]: 1699: static parser successfully parsed films.sql
[0m01:45:59.688008 [debug] [MainThread]: 1699: static parser successfully parsed film_actors.sql
[0m01:45:59.691489 [debug] [MainThread]: 1699: static parser successfully parsed film_ratings.sql
[0m01:45:59.802425 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m01:45:59.811812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22e43eb2-8775-4740-a4a7-a9a260febee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc0af2f550>]}
[0m01:45:59.837141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22e43eb2-8775-4740-a4a7-a9a260febee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc0c825480>]}
[0m01:45:59.838309 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m01:45:59.840527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22e43eb2-8775-4740-a4a7-a9a260febee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc0c824d60>]}
[0m01:45:59.843119 [info ] [MainThread]: 
[0m01:45:59.846200 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:45:59.848596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m01:45:59.859692 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m01:45:59.861078 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m01:45:59.862672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:59.944034 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:45:59.947068 [debug] [ThreadPool]: On list_destination_db: Close
[0m01:45:59.950934 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m01:45:59.961582 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m01:45:59.963478 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m01:45:59.964904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:45:59.982381 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:45:59.983758 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m01:45:59.984925 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:45:59.990536 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m01:45:59.992630 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m01:45:59.995023 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m01:46:00.001519 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:00.002877 [debug] [MainThread]: On master: BEGIN
[0m01:46:00.003930 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:46:00.027086 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:46:00.029184 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:00.030916 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:46:00.038940 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m01:46:00.041048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22e43eb2-8775-4740-a4a7-a9a260febee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc08def8b0>]}
[0m01:46:00.042355 [debug] [MainThread]: On master: ROLLBACK
[0m01:46:00.045573 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:00.046625 [debug] [MainThread]: On master: BEGIN
[0m01:46:00.051719 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:46:00.053109 [debug] [MainThread]: On master: COMMIT
[0m01:46:00.054175 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:00.055431 [debug] [MainThread]: On master: COMMIT
[0m01:46:00.057922 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:46:00.059252 [debug] [MainThread]: On master: Close
[0m01:46:00.061113 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:46:00.062994 [info ] [MainThread]: 
[0m01:46:00.081173 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m01:46:00.082870 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m01:46:00.084964 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m01:46:00.085877 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m01:46:00.089035 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m01:46:00.096019 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 01:46:00.086635 => 2024-10-25 01:46:00.095935
[0m01:46:00.096842 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m01:46:00.146899 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m01:46:00.163362 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:46:00.165177 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m01:46:00.166716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:00.190869 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:46:00.192382 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:46:00.193559 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m01:46:00.200986 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m01:46:00.202130 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m01:46:00.204463 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 01:46:00.097695 => 2024-10-25 01:46:00.204362
[0m01:46:00.205300 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m01:46:00.213279 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m01:46:00.214644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22e43eb2-8775-4740-a4a7-a9a260febee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc08e40ee0>]}
[0m01:46:00.217335 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.13s]
[0m01:46:00.220381 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m01:46:00.221356 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m01:46:00.222461 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m01:46:00.224118 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m01:46:00.225116 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m01:46:00.228479 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m01:46:00.238769 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 01:46:00.225947 => 2024-10-25 01:46:00.238665
[0m01:46:00.239655 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m01:46:00.244050 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m01:46:00.251233 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:46:00.252364 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m01:46:00.253046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:00.280757 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:46:00.282607 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:46:00.284337 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m01:46:00.287060 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m01:46:00.290434 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m01:46:00.292705 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 01:46:00.240507 => 2024-10-25 01:46:00.292623
[0m01:46:00.293592 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m01:46:00.295353 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m01:46:00.296291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22e43eb2-8775-4740-a4a7-a9a260febee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc08e78460>]}
[0m01:46:00.297597 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.07s]
[0m01:46:00.299670 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m01:46:00.300767 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m01:46:00.301767 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m01:46:00.303246 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m01:46:00.304353 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m01:46:00.307787 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m01:46:00.318030 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 01:46:00.305246 => 2024-10-25 01:46:00.317885
[0m01:46:00.319474 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m01:46:00.324939 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m01:46:00.334475 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:46:00.335999 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m01:46:00.337165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:00.353137 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:46:00.354334 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:46:00.355397 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m01:46:00.358670 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m01:46:00.360924 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m01:46:00.363215 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 01:46:00.320560 => 2024-10-25 01:46:00.363123
[0m01:46:00.364211 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m01:46:00.365876 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m01:46:00.367753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22e43eb2-8775-4740-a4a7-a9a260febee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc08e3d540>]}
[0m01:46:00.369095 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.06s]
[0m01:46:00.371067 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m01:46:00.372702 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m01:46:00.373527 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m01:46:00.375034 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m01:46:00.377101 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:46:00.377839 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:00.378650 [debug] [MainThread]: On master: BEGIN
[0m01:46:00.379491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:46:00.394136 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:46:00.395229 [debug] [MainThread]: On master: COMMIT
[0m01:46:00.396018 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:00.397298 [debug] [MainThread]: On master: COMMIT
[0m01:46:00.399655 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:46:00.400932 [debug] [MainThread]: On master: Close
[0m01:46:00.402460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:46:00.403338 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m01:46:00.404125 [info ] [MainThread]: 
[0m01:46:00.405772 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m01:46:00.407032 [debug] [MainThread]: Command end result
[0m01:46:00.422094 [info ] [MainThread]: 
[0m01:46:00.424039 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m01:46:00.425707 [info ] [MainThread]: 
[0m01:46:00.427646 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m01:46:00.429381 [error] [MainThread]:   relation "public.actors" does not exist
[0m01:46:00.430809 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m01:46:00.432487 [error] [MainThread]:                             ^
[0m01:46:00.434608 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m01:46:00.436077 [info ] [MainThread]: 
[0m01:46:00.437679 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m01:46:00.439355 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m01:46:00.440668 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m01:46:00.441408 [error] [MainThread]:                             ^
[0m01:46:00.442175 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m01:46:00.442975 [info ] [MainThread]: 
[0m01:46:00.443820 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m01:46:00.444732 [error] [MainThread]:   relation "public.films" does not exist
[0m01:46:00.445569 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m01:46:00.446944 [error] [MainThread]:                             ^
[0m01:46:00.447886 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m01:46:00.448824 [info ] [MainThread]: 
[0m01:46:00.449759 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m01:46:00.450916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc0af7e170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc0af7f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc0af7e080>]}
[0m01:46:00.452106 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 02:52:26.776291 | ae60d3db-6712-4dd1-8266-2e273bea1197 ==============================
[0m02:52:26.776291 [info ] [MainThread]: Running with dbt=1.4.7
[0m02:52:26.781267 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:52:26.782676 [debug] [MainThread]: Tracking: tracking
[0m02:52:26.794768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c31d5360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c31d57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c31d53c0>]}
[0m02:52:26.817204 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m02:52:26.958803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:52:26.959996 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/film_ratings.sql
[0m02:52:26.980320 [debug] [MainThread]: 1699: static parser successfully parsed film_ratings.sql
[0m02:52:27.002141 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m02:52:27.008813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae60d3db-6712-4dd1-8266-2e273bea1197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c193d600>]}
[0m02:52:27.026892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae60d3db-6712-4dd1-8266-2e273bea1197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c18b7cd0>]}
[0m02:52:27.027880 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m02:52:27.034870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae60d3db-6712-4dd1-8266-2e273bea1197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c31e18d0>]}
[0m02:52:27.043082 [info ] [MainThread]: 
[0m02:52:27.046592 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:52:27.048947 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m02:52:27.059351 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m02:52:27.060730 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m02:52:27.061805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:52:27.144473 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:52:27.148031 [debug] [ThreadPool]: On list_destination_db: Close
[0m02:52:27.152353 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m02:52:27.165960 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m02:52:27.168236 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m02:52:27.170149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:52:27.200715 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:52:27.202574 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m02:52:27.203908 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:52:27.210894 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m02:52:27.212891 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m02:52:27.215315 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m02:52:27.220733 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:27.221860 [debug] [MainThread]: On master: BEGIN
[0m02:52:27.222666 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:52:27.240582 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:52:27.242004 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:27.243147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:52:27.247479 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m02:52:27.249319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae60d3db-6712-4dd1-8266-2e273bea1197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47bb923c10>]}
[0m02:52:27.250256 [debug] [MainThread]: On master: ROLLBACK
[0m02:52:27.252199 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:27.253136 [debug] [MainThread]: On master: BEGIN
[0m02:52:27.258390 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:52:27.259730 [debug] [MainThread]: On master: COMMIT
[0m02:52:27.260876 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:27.261999 [debug] [MainThread]: On master: COMMIT
[0m02:52:27.264739 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:52:27.265867 [debug] [MainThread]: On master: Close
[0m02:52:27.267532 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:52:27.269488 [info ] [MainThread]: 
[0m02:52:27.293504 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m02:52:27.296117 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m02:52:27.299136 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m02:52:27.301689 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m02:52:27.308317 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m02:52:27.331949 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 02:52:27.303925 => 2024-10-25 02:52:27.331799
[0m02:52:27.334694 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m02:52:27.391452 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m02:52:27.418296 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:52:27.420991 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m02:52:27.423592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:27.459981 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:52:27.461950 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:52:27.464198 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m02:52:27.472452 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m02:52:27.477763 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m02:52:27.483650 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 02:52:27.337270 => 2024-10-25 02:52:27.483531
[0m02:52:27.485264 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m02:52:27.498590 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m02:52:27.501613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae60d3db-6712-4dd1-8266-2e273bea1197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47bb9a34c0>]}
[0m02:52:27.504628 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.20s]
[0m02:52:27.510345 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m02:52:27.513065 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m02:52:27.515742 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m02:52:27.519828 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m02:52:27.522700 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m02:52:27.530586 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m02:52:27.558337 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 02:52:27.525861 => 2024-10-25 02:52:27.558188
[0m02:52:27.560436 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m02:52:27.568993 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m02:52:27.596372 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:52:27.597760 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m02:52:27.599694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:27.636060 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:52:27.638443 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:52:27.640357 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m02:52:27.648609 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m02:52:27.650288 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m02:52:27.654527 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 02:52:27.562697 => 2024-10-25 02:52:27.654407
[0m02:52:27.656458 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m02:52:27.659556 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m02:52:27.661061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae60d3db-6712-4dd1-8266-2e273bea1197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47bb9c72e0>]}
[0m02:52:27.662923 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.14s]
[0m02:52:27.665232 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m02:52:27.667132 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m02:52:27.668974 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m02:52:27.672067 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m02:52:27.674461 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m02:52:27.680092 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m02:52:27.695271 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 02:52:27.675965 => 2024-10-25 02:52:27.695112
[0m02:52:27.697200 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m02:52:27.707283 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m02:52:27.722688 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:52:27.724276 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m02:52:27.725928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:27.756001 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:52:27.758080 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:52:27.759949 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m02:52:27.764553 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m02:52:27.768829 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m02:52:27.772968 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 02:52:27.698904 => 2024-10-25 02:52:27.772856
[0m02:52:27.774911 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m02:52:27.777975 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m02:52:27.779979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae60d3db-6712-4dd1-8266-2e273bea1197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b9854730>]}
[0m02:52:27.782117 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.11s]
[0m02:52:27.784673 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m02:52:27.787963 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m02:52:27.789736 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m02:52:27.792280 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m02:52:27.796803 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:52:27.799185 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:27.801443 [debug] [MainThread]: On master: BEGIN
[0m02:52:27.803838 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:52:27.835869 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:52:27.838279 [debug] [MainThread]: On master: COMMIT
[0m02:52:27.840337 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:27.842937 [debug] [MainThread]: On master: COMMIT
[0m02:52:27.847872 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:52:27.850260 [debug] [MainThread]: On master: Close
[0m02:52:27.852495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:52:27.853963 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m02:52:27.855461 [info ] [MainThread]: 
[0m02:52:27.859189 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m02:52:27.863611 [debug] [MainThread]: Command end result
[0m02:52:27.898983 [info ] [MainThread]: 
[0m02:52:27.902616 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m02:52:27.905556 [info ] [MainThread]: 
[0m02:52:27.910503 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m02:52:27.913809 [error] [MainThread]:   relation "public.actors" does not exist
[0m02:52:27.917153 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m02:52:27.919681 [error] [MainThread]:                             ^
[0m02:52:27.922196 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m02:52:27.925273 [info ] [MainThread]: 
[0m02:52:27.927517 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m02:52:27.929417 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m02:52:27.930908 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m02:52:27.932568 [error] [MainThread]:                             ^
[0m02:52:27.934718 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m02:52:27.936240 [info ] [MainThread]: 
[0m02:52:27.938545 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m02:52:27.940524 [error] [MainThread]:   relation "public.films" does not exist
[0m02:52:27.942250 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m02:52:27.943489 [error] [MainThread]:                             ^
[0m02:52:27.944808 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m02:52:27.945829 [info ] [MainThread]: 
[0m02:52:27.947511 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m02:52:27.948855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47bb923610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47bb923fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47bb922740>]}
[0m02:52:27.950016 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 02:55:41.294306 | c3d27a87-9848-4e7f-8373-cb51848a3d81 ==============================
[0m02:55:41.294306 [info ] [MainThread]: Running with dbt=1.4.7
[0m02:55:41.298836 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:55:41.300157 [debug] [MainThread]: Tracking: tracking
[0m02:55:41.310874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc112a090f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc112a097b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc112a09390>]}
[0m02:55:41.334778 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m02:55:41.601002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:55:41.602695 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:55:41.605032 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m02:55:41.622245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3d27a87-9848-4e7f-8373-cb51848a3d81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1111400d0>]}
[0m02:55:41.667656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3d27a87-9848-4e7f-8373-cb51848a3d81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc111105210>]}
[0m02:55:41.669768 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m02:55:41.672383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3d27a87-9848-4e7f-8373-cb51848a3d81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc111105270>]}
[0m02:55:41.675408 [info ] [MainThread]: 
[0m02:55:41.692061 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:55:41.700623 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m02:55:41.712237 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m02:55:41.714698 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m02:55:41.716728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:55:41.770407 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:55:41.774791 [debug] [ThreadPool]: On list_destination_db: Close
[0m02:55:41.780278 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m02:55:41.791575 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m02:55:41.793986 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m02:55:41.796091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:55:41.829319 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:55:41.831199 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m02:55:41.832802 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:55:41.842517 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m02:55:41.846354 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m02:55:41.851919 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m02:55:41.862373 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:41.864411 [debug] [MainThread]: On master: BEGIN
[0m02:55:41.866591 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:55:41.891846 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:55:41.893516 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:41.894903 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:55:41.901808 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m02:55:41.904275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3d27a87-9848-4e7f-8373-cb51848a3d81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1111041c0>]}
[0m02:55:41.906002 [debug] [MainThread]: On master: ROLLBACK
[0m02:55:41.908529 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:41.909710 [debug] [MainThread]: On master: BEGIN
[0m02:55:41.915424 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:55:41.917144 [debug] [MainThread]: On master: COMMIT
[0m02:55:41.918309 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:41.919293 [debug] [MainThread]: On master: COMMIT
[0m02:55:41.921946 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:55:41.922966 [debug] [MainThread]: On master: Close
[0m02:55:41.924201 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:55:41.925907 [info ] [MainThread]: 
[0m02:55:41.944630 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m02:55:41.946321 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m02:55:41.949430 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m02:55:41.950560 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m02:55:41.954581 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m02:55:41.965459 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 02:55:41.951993 => 2024-10-25 02:55:41.965241
[0m02:55:41.967079 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m02:55:42.011466 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m02:55:42.034371 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:55:42.036854 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m02:55:42.039488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:42.076531 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:55:42.079377 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:55:42.081786 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m02:55:42.091699 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m02:55:42.095688 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m02:55:42.101192 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 02:55:41.968442 => 2024-10-25 02:55:42.101068
[0m02:55:42.102299 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m02:55:42.111212 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m02:55:42.113277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3d27a87-9848-4e7f-8373-cb51848a3d81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc110fd6b60>]}
[0m02:55:42.114964 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.16s]
[0m02:55:42.117547 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m02:55:42.118889 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m02:55:42.120654 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m02:55:42.122841 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m02:55:42.124016 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m02:55:42.129784 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m02:55:42.141821 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 02:55:42.124895 => 2024-10-25 02:55:42.141685
[0m02:55:42.144616 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m02:55:42.151335 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m02:55:42.162284 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:55:42.163783 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m02:55:42.164986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:42.182770 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:55:42.184043 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:55:42.185418 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m02:55:42.188485 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m02:55:42.191516 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m02:55:42.194917 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 02:55:42.147649 => 2024-10-25 02:55:42.194785
[0m02:55:42.196054 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m02:55:42.198059 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m02:55:42.202022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3d27a87-9848-4e7f-8373-cb51848a3d81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc110fd67d0>]}
[0m02:55:42.232146 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.08s]
[0m02:55:42.234493 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m02:55:42.244204 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m02:55:42.245491 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m02:55:42.247522 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m02:55:42.248535 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m02:55:42.251333 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m02:55:42.257911 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 02:55:42.249138 => 2024-10-25 02:55:42.257801
[0m02:55:42.258924 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m02:55:42.263451 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m02:55:42.270243 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:55:42.271186 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m02:55:42.271974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:42.287493 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:55:42.288614 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:55:42.289686 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m02:55:42.291813 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m02:55:42.292974 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m02:55:42.296368 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 02:55:42.259771 => 2024-10-25 02:55:42.296263
[0m02:55:42.297445 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m02:55:42.299019 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m02:55:42.300137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3d27a87-9848-4e7f-8373-cb51848a3d81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc110f962f0>]}
[0m02:55:42.301176 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.05s]
[0m02:55:42.303614 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m02:55:42.306156 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m02:55:42.308003 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m02:55:42.309212 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m02:55:42.311222 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:55:42.312209 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:42.313067 [debug] [MainThread]: On master: BEGIN
[0m02:55:42.313877 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:55:42.329690 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:55:42.331157 [debug] [MainThread]: On master: COMMIT
[0m02:55:42.332404 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:42.333751 [debug] [MainThread]: On master: COMMIT
[0m02:55:42.336278 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:55:42.337598 [debug] [MainThread]: On master: Close
[0m02:55:42.338934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:55:42.339767 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m02:55:42.340686 [info ] [MainThread]: 
[0m02:55:42.341702 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m02:55:42.343122 [debug] [MainThread]: Command end result
[0m02:55:42.359383 [info ] [MainThread]: 
[0m02:55:42.361413 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m02:55:42.364206 [info ] [MainThread]: 
[0m02:55:42.366225 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m02:55:42.367831 [error] [MainThread]:   relation "public.actors" does not exist
[0m02:55:42.369353 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m02:55:42.370738 [error] [MainThread]:                             ^
[0m02:55:42.371965 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m02:55:42.373180 [info ] [MainThread]: 
[0m02:55:42.374413 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m02:55:42.375419 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m02:55:42.376881 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m02:55:42.378171 [error] [MainThread]:                             ^
[0m02:55:42.379393 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m02:55:42.380546 [info ] [MainThread]: 
[0m02:55:42.382108 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m02:55:42.383406 [error] [MainThread]:   relation "public.films" does not exist
[0m02:55:42.384254 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m02:55:42.385915 [error] [MainThread]:                             ^
[0m02:55:42.387450 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m02:55:42.389140 [info ] [MainThread]: 
[0m02:55:42.390339 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m02:55:42.391840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc110f95f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc110f967d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc110f897b0>]}
[0m02:55:42.393113 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 02:56:34.214349 | 8a609b12-7ea5-4c21-aec5-841687c17627 ==============================
[0m02:56:34.214349 [info ] [MainThread]: Running with dbt=1.4.7
[0m02:56:34.217409 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:56:34.218484 [debug] [MainThread]: Tracking: tracking
[0m02:56:34.221247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d768b5360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d768b57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d768b53c0>]}
[0m02:56:34.241643 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m02:56:34.560782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:56:34.561854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:56:34.563267 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m02:56:34.570801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a609b12-7ea5-4c21-aec5-841687c17627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d74fec0d0>]}
[0m02:56:34.603761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a609b12-7ea5-4c21-aec5-841687c17627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d74fb11b0>]}
[0m02:56:34.605010 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m02:56:34.606752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a609b12-7ea5-4c21-aec5-841687c17627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d74fb1210>]}
[0m02:56:34.608791 [info ] [MainThread]: 
[0m02:56:34.611991 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:56:34.614253 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m02:56:34.628332 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m02:56:34.630733 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m02:56:34.631719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:56:34.662104 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:56:34.664660 [debug] [ThreadPool]: On list_destination_db: Close
[0m02:56:34.667605 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m02:56:34.673592 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m02:56:34.674718 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m02:56:34.675711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:56:34.690356 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:56:34.691644 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m02:56:34.692676 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:56:34.697340 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m02:56:34.699343 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m02:56:34.701476 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m02:56:34.706815 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:34.708029 [debug] [MainThread]: On master: BEGIN
[0m02:56:34.708953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:56:34.726726 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:56:34.728265 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:34.729280 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:56:34.734155 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m02:56:34.736476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a609b12-7ea5-4c21-aec5-841687c17627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d74fb0370>]}
[0m02:56:34.738178 [debug] [MainThread]: On master: ROLLBACK
[0m02:56:34.740640 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:34.741952 [debug] [MainThread]: On master: BEGIN
[0m02:56:34.745657 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:56:34.747343 [debug] [MainThread]: On master: COMMIT
[0m02:56:34.748493 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:34.749547 [debug] [MainThread]: On master: COMMIT
[0m02:56:34.751774 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:56:34.752629 [debug] [MainThread]: On master: Close
[0m02:56:34.753887 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:56:34.754910 [info ] [MainThread]: 
[0m02:56:34.772650 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m02:56:34.774536 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m02:56:34.776344 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m02:56:34.777677 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m02:56:34.781753 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m02:56:34.790655 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 02:56:34.778639 => 2024-10-25 02:56:34.790542
[0m02:56:34.791845 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m02:56:34.836711 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m02:56:34.853420 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:56:34.855587 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m02:56:34.857910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:56:34.893918 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:56:34.896393 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:56:34.899783 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m02:56:34.911034 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m02:56:34.913086 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m02:56:34.916257 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 02:56:34.792852 => 2024-10-25 02:56:34.916132
[0m02:56:34.918449 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m02:56:34.921670 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m02:56:34.922987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a609b12-7ea5-4c21-aec5-841687c17627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d74ea1210>]}
[0m02:56:34.924561 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.15s]
[0m02:56:34.928938 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m02:56:34.930059 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m02:56:34.931752 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m02:56:34.933608 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m02:56:34.934581 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m02:56:34.938878 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m02:56:34.953748 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 02:56:34.935445 => 2024-10-25 02:56:34.953609
[0m02:56:34.955210 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m02:56:34.959716 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m02:56:34.972183 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:56:34.973744 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m02:56:34.975745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:56:34.996312 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:56:34.997752 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:56:34.998982 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m02:56:35.003696 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m02:56:35.007954 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m02:56:35.011562 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 02:56:34.956440 => 2024-10-25 02:56:35.011432
[0m02:56:35.013243 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m02:56:35.015845 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m02:56:35.017513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a609b12-7ea5-4c21-aec5-841687c17627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d74ea15a0>]}
[0m02:56:35.019275 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.08s]
[0m02:56:35.020592 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m02:56:35.022031 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m02:56:35.023510 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m02:56:35.025881 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m02:56:35.027125 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m02:56:35.031992 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m02:56:35.044383 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 02:56:35.028277 => 2024-10-25 02:56:35.044232
[0m02:56:35.046389 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m02:56:35.050763 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m02:56:35.063035 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:56:35.064133 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m02:56:35.065561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:56:35.084191 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:56:35.085570 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:56:35.086707 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m02:56:35.092458 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m02:56:35.093516 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m02:56:35.096151 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 02:56:35.047476 => 2024-10-25 02:56:35.096059
[0m02:56:35.097292 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m02:56:35.099005 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m02:56:35.100514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a609b12-7ea5-4c21-aec5-841687c17627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d74e421d0>]}
[0m02:56:35.101657 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.07s]
[0m02:56:35.102877 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m02:56:35.104870 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m02:56:35.106346 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m02:56:35.107509 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m02:56:35.109866 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:56:35.111369 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:35.112921 [debug] [MainThread]: On master: BEGIN
[0m02:56:35.113766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:56:35.130822 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:56:35.132279 [debug] [MainThread]: On master: COMMIT
[0m02:56:35.133471 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:35.134510 [debug] [MainThread]: On master: COMMIT
[0m02:56:35.137169 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:56:35.138115 [debug] [MainThread]: On master: Close
[0m02:56:35.139319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:56:35.140124 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m02:56:35.140938 [info ] [MainThread]: 
[0m02:56:35.142793 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m02:56:35.144343 [debug] [MainThread]: Command end result
[0m02:56:35.160201 [info ] [MainThread]: 
[0m02:56:35.164780 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m02:56:35.167142 [info ] [MainThread]: 
[0m02:56:35.170106 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m02:56:35.172998 [error] [MainThread]:   relation "public.actors" does not exist
[0m02:56:35.174987 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m02:56:35.178674 [error] [MainThread]:                             ^
[0m02:56:35.181886 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m02:56:35.183949 [info ] [MainThread]: 
[0m02:56:35.186169 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m02:56:35.187677 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m02:56:35.188966 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m02:56:35.190255 [error] [MainThread]:                             ^
[0m02:56:35.192522 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m02:56:35.193913 [info ] [MainThread]: 
[0m02:56:35.196219 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m02:56:35.198053 [error] [MainThread]:   relation "public.films" does not exist
[0m02:56:35.199132 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m02:56:35.200648 [error] [MainThread]:                             ^
[0m02:56:35.201424 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m02:56:35.203454 [info ] [MainThread]: 
[0m02:56:35.204696 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m02:56:35.205780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d74eb6d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d74e41a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d74e40c40>]}
[0m02:56:35.206638 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 03:31:53.033046 | f6f95b29-ef8a-465a-a2a5-39529de98352 ==============================
[0m03:31:53.033046 [info ] [MainThread]: Running with dbt=1.4.7
[0m03:31:53.037101 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:31:53.038500 [debug] [MainThread]: Tracking: tracking
[0m03:31:53.046055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf006d1360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf006d17e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf006d13c0>]}
[0m03:31:53.065729 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m03:31:53.254782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:31:53.256701 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:31:53.258064 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m03:31:53.267081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6f95b29-ef8a-465a-a2a5-39529de98352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefedfc0d0>]}
[0m03:31:53.291800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6f95b29-ef8a-465a-a2a5-39529de98352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefedc1240>]}
[0m03:31:53.293145 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m03:31:53.294499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6f95b29-ef8a-465a-a2a5-39529de98352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefedc12a0>]}
[0m03:31:53.296923 [info ] [MainThread]: 
[0m03:31:53.299682 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:31:53.302025 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m03:31:53.319951 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m03:31:53.323756 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m03:31:53.325274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:31:53.370555 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m03:31:53.372914 [debug] [ThreadPool]: On list_destination_db: Close
[0m03:31:53.375695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m03:31:53.382881 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m03:31:53.383865 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m03:31:53.385061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:31:53.401351 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m03:31:53.402364 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m03:31:53.403659 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:31:53.409129 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m03:31:53.411254 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m03:31:53.414108 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m03:31:53.420108 [debug] [MainThread]: Using postgres connection "master"
[0m03:31:53.421440 [debug] [MainThread]: On master: BEGIN
[0m03:31:53.422685 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:31:53.441243 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:31:53.442699 [debug] [MainThread]: Using postgres connection "master"
[0m03:31:53.443872 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:31:53.453852 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m03:31:53.457405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6f95b29-ef8a-465a-a2a5-39529de98352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefedc0670>]}
[0m03:31:53.459197 [debug] [MainThread]: On master: ROLLBACK
[0m03:31:53.462718 [debug] [MainThread]: Using postgres connection "master"
[0m03:31:53.464147 [debug] [MainThread]: On master: BEGIN
[0m03:31:53.473254 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:31:53.474852 [debug] [MainThread]: On master: COMMIT
[0m03:31:53.475936 [debug] [MainThread]: Using postgres connection "master"
[0m03:31:53.477115 [debug] [MainThread]: On master: COMMIT
[0m03:31:53.479543 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:31:53.480649 [debug] [MainThread]: On master: Close
[0m03:31:53.481896 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:31:53.483782 [info ] [MainThread]: 
[0m03:31:53.508658 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m03:31:53.510430 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m03:31:53.511860 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m03:31:53.512813 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m03:31:53.515946 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m03:31:53.524045 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 03:31:53.513675 => 2024-10-25 03:31:53.523863
[0m03:31:53.525585 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m03:31:53.566859 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m03:31:53.578757 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:31:53.580096 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m03:31:53.581355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:31:53.604711 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:31:53.606055 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:31:53.607019 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m03:31:53.612572 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m03:31:53.614910 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m03:31:53.617156 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 03:31:53.526477 => 2024-10-25 03:31:53.617056
[0m03:31:53.618566 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m03:31:53.624835 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m03:31:53.628023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f95b29-ef8a-465a-a2a5-39529de98352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefec7b4c0>]}
[0m03:31:53.629356 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.12s]
[0m03:31:53.631834 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m03:31:53.632956 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m03:31:53.633912 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m03:31:53.635175 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m03:31:53.636034 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m03:31:53.641124 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m03:31:53.648853 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 03:31:53.636844 => 2024-10-25 03:31:53.648728
[0m03:31:53.650007 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m03:31:53.654238 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m03:31:53.661876 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:31:53.662993 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m03:31:53.663999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:31:53.681245 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:31:53.682705 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:31:53.683939 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m03:31:53.686757 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m03:31:53.688158 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m03:31:53.692703 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 03:31:53.650952 => 2024-10-25 03:31:53.692578
[0m03:31:53.693794 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m03:31:53.695561 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m03:31:53.697664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f95b29-ef8a-465a-a2a5-39529de98352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefec7b850>]}
[0m03:31:53.700482 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.06s]
[0m03:31:53.702810 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m03:31:53.703872 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m03:31:53.705075 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m03:31:53.707512 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m03:31:53.709435 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m03:31:53.714272 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m03:31:53.723318 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 03:31:53.711106 => 2024-10-25 03:31:53.723096
[0m03:31:53.725384 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m03:31:53.731268 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m03:31:53.740099 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:31:53.741516 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m03:31:53.742849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:31:53.760802 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:31:53.762262 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:31:53.763546 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m03:31:53.766162 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m03:31:53.767213 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m03:31:53.770837 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 03:31:53.726664 => 2024-10-25 03:31:53.770680
[0m03:31:53.772257 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m03:31:53.774868 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m03:31:53.776934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f95b29-ef8a-465a-a2a5-39529de98352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefee52f20>]}
[0m03:31:53.778532 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.07s]
[0m03:31:53.779684 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m03:31:53.782561 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m03:31:53.783717 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m03:31:53.784817 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m03:31:53.786868 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:31:53.787955 [debug] [MainThread]: Using postgres connection "master"
[0m03:31:53.788999 [debug] [MainThread]: On master: BEGIN
[0m03:31:53.790263 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:31:53.807893 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:31:53.809713 [debug] [MainThread]: On master: COMMIT
[0m03:31:53.813936 [debug] [MainThread]: Using postgres connection "master"
[0m03:31:53.815070 [debug] [MainThread]: On master: COMMIT
[0m03:31:53.817627 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:31:53.818798 [debug] [MainThread]: On master: Close
[0m03:31:53.820228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:31:53.821138 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m03:31:53.822368 [info ] [MainThread]: 
[0m03:31:53.825060 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m03:31:53.826692 [debug] [MainThread]: Command end result
[0m03:31:53.849640 [info ] [MainThread]: 
[0m03:31:53.850985 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m03:31:53.852033 [info ] [MainThread]: 
[0m03:31:53.853060 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m03:31:53.853997 [error] [MainThread]:   relation "public.actors" does not exist
[0m03:31:53.855353 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m03:31:53.856666 [error] [MainThread]:                             ^
[0m03:31:53.858139 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m03:31:53.859217 [info ] [MainThread]: 
[0m03:31:53.860598 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m03:31:53.861675 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m03:31:53.862705 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m03:31:53.865074 [error] [MainThread]:                             ^
[0m03:31:53.866183 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m03:31:53.867359 [info ] [MainThread]: 
[0m03:31:53.869434 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m03:31:53.871469 [error] [MainThread]:   relation "public.films" does not exist
[0m03:31:53.872755 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m03:31:53.874567 [error] [MainThread]:                             ^
[0m03:31:53.875784 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m03:31:53.876914 [info ] [MainThread]: 
[0m03:31:53.877880 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m03:31:53.879280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefee518a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefee52da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefee428c0>]}
[0m03:31:53.880471 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 03:35:51.869503 | e3f60216-80f3-4f80-8979-27fa4c35fbeb ==============================
[0m03:35:51.869503 [info ] [MainThread]: Running with dbt=1.4.7
[0m03:35:51.873963 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:35:51.875152 [debug] [MainThread]: Tracking: tracking
[0m03:35:51.878907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13261410f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13261417b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1326141390>]}
[0m03:35:51.898036 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m03:35:52.033879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:35:52.035532 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:35:52.037934 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m03:35:52.054332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3f60216-80f3-4f80-8979-27fa4c35fbeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f132487c0d0>]}
[0m03:35:52.086135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3f60216-80f3-4f80-8979-27fa4c35fbeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13248411e0>]}
[0m03:35:52.094718 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m03:35:52.098609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3f60216-80f3-4f80-8979-27fa4c35fbeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1324841240>]}
[0m03:35:52.100589 [info ] [MainThread]: 
[0m03:35:52.105863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:35:52.113208 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m03:35:52.123636 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m03:35:52.124885 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m03:35:52.126545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:35:52.157699 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m03:35:52.160204 [debug] [ThreadPool]: On list_destination_db: Close
[0m03:35:52.163152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m03:35:52.172277 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m03:35:52.174121 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m03:35:52.175733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:35:52.201994 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m03:35:52.203715 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m03:35:52.204965 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:35:52.211309 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m03:35:52.214015 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m03:35:52.217633 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m03:35:52.225176 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:52.226656 [debug] [MainThread]: On master: BEGIN
[0m03:35:52.228012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:35:52.245083 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:35:52.246554 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:52.247703 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:35:52.254227 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m03:35:52.257125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3f60216-80f3-4f80-8979-27fa4c35fbeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1324840040>]}
[0m03:35:52.261093 [debug] [MainThread]: On master: ROLLBACK
[0m03:35:52.264326 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:52.265972 [debug] [MainThread]: On master: BEGIN
[0m03:35:52.270809 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:35:52.272022 [debug] [MainThread]: On master: COMMIT
[0m03:35:52.273231 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:52.274488 [debug] [MainThread]: On master: COMMIT
[0m03:35:52.278251 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:35:52.279532 [debug] [MainThread]: On master: Close
[0m03:35:52.281381 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:35:52.283084 [info ] [MainThread]: 
[0m03:35:52.305217 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m03:35:52.306744 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m03:35:52.309065 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m03:35:52.310177 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m03:35:52.314131 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m03:35:52.324227 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 03:35:52.310983 => 2024-10-25 03:35:52.324056
[0m03:35:52.325670 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m03:35:52.388057 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m03:35:52.397097 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:35:52.399562 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m03:35:52.401679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:52.430810 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:35:52.433262 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:35:52.435190 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m03:35:52.444190 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m03:35:52.447796 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m03:35:52.452023 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 03:35:52.327327 => 2024-10-25 03:35:52.451891
[0m03:35:52.453596 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m03:35:52.458761 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m03:35:52.460455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3f60216-80f3-4f80-8979-27fa4c35fbeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f132470ab30>]}
[0m03:35:52.462085 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.15s]
[0m03:35:52.464419 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m03:35:52.465800 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m03:35:52.466848 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m03:35:52.468335 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m03:35:52.469386 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m03:35:52.474655 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m03:35:52.486866 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 03:35:52.470162 => 2024-10-25 03:35:52.486720
[0m03:35:52.487859 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m03:35:52.492482 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m03:35:52.501312 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:35:52.502463 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m03:35:52.503337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:52.518156 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:35:52.519509 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:35:52.520421 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m03:35:52.522561 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m03:35:52.523952 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m03:35:52.527089 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 03:35:52.488690 => 2024-10-25 03:35:52.526946
[0m03:35:52.528401 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m03:35:52.530036 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m03:35:52.530962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3f60216-80f3-4f80-8979-27fa4c35fbeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f132470a7a0>]}
[0m03:35:52.532140 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.06s]
[0m03:35:52.533876 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m03:35:52.534847 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m03:35:52.535917 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m03:35:52.537996 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m03:35:52.539005 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m03:35:52.542960 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m03:35:52.551731 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 03:35:52.540091 => 2024-10-25 03:35:52.551583
[0m03:35:52.552661 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m03:35:52.556791 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m03:35:52.564083 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:35:52.565380 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m03:35:52.566425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:52.582299 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:35:52.583618 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:35:52.584892 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m03:35:52.588617 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m03:35:52.590055 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m03:35:52.593131 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 03:35:52.553537 => 2024-10-25 03:35:52.593011
[0m03:35:52.594581 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m03:35:52.596565 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m03:35:52.598434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3f60216-80f3-4f80-8979-27fa4c35fbeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13246cefe0>]}
[0m03:35:52.599775 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.06s]
[0m03:35:52.602040 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m03:35:52.603763 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m03:35:52.604799 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m03:35:52.605911 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m03:35:52.608217 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:35:52.609498 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:52.611377 [debug] [MainThread]: On master: BEGIN
[0m03:35:52.612475 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:35:52.626874 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:35:52.628955 [debug] [MainThread]: On master: COMMIT
[0m03:35:52.629996 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:52.630809 [debug] [MainThread]: On master: COMMIT
[0m03:35:52.633037 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:35:52.633826 [debug] [MainThread]: On master: Close
[0m03:35:52.635246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:35:52.636109 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m03:35:52.637147 [info ] [MainThread]: 
[0m03:35:52.638094 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m03:35:52.639049 [debug] [MainThread]: Command end result
[0m03:35:52.661643 [info ] [MainThread]: 
[0m03:35:52.663692 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m03:35:52.665321 [info ] [MainThread]: 
[0m03:35:52.666805 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m03:35:52.668612 [error] [MainThread]:   relation "public.actors" does not exist
[0m03:35:52.672079 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m03:35:52.673282 [error] [MainThread]:                             ^
[0m03:35:52.675111 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m03:35:52.678719 [info ] [MainThread]: 
[0m03:35:52.682246 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m03:35:52.684069 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m03:35:52.685732 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m03:35:52.687266 [error] [MainThread]:                             ^
[0m03:35:52.688708 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m03:35:52.690203 [info ] [MainThread]: 
[0m03:35:52.691528 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m03:35:52.693929 [error] [MainThread]:   relation "public.films" does not exist
[0m03:35:52.695929 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m03:35:52.697161 [error] [MainThread]:                             ^
[0m03:35:52.699121 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m03:35:52.700629 [info ] [MainThread]: 
[0m03:35:52.701899 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m03:35:52.703132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13247472b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13246ceb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13246ce980>]}
[0m03:35:52.704113 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 03:44:32.127383 | 6957d830-a29f-4419-8500-bc26cd968dc0 ==============================
[0m03:44:32.127383 [info ] [MainThread]: Running with dbt=1.4.7
[0m03:44:32.131872 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:44:32.133195 [debug] [MainThread]: Tracking: tracking
[0m03:44:32.138439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed120b5360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed120b57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed120b53c0>]}
[0m03:44:32.165775 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m03:44:32.342955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:44:32.344417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:44:32.345984 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m03:44:32.353998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6957d830-a29f-4419-8500-bc26cd968dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed107e00d0>]}
[0m03:44:32.374481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6957d830-a29f-4419-8500-bc26cd968dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed107a5240>]}
[0m03:44:32.376548 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m03:44:32.378659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6957d830-a29f-4419-8500-bc26cd968dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed107a52a0>]}
[0m03:44:32.381335 [info ] [MainThread]: 
[0m03:44:32.384698 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:44:32.387424 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m03:44:32.401674 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m03:44:32.403260 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m03:44:32.404638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:44:32.454759 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m03:44:32.457217 [debug] [ThreadPool]: On list_destination_db: Close
[0m03:44:32.460267 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m03:44:32.466738 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m03:44:32.467915 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m03:44:32.468991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:44:32.490693 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m03:44:32.541038 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m03:44:32.543677 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:44:32.554973 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m03:44:32.559696 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m03:44:32.566561 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m03:44:32.581763 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:32.586485 [debug] [MainThread]: On master: BEGIN
[0m03:44:32.592710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:44:32.629517 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:44:32.632056 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:32.633872 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:44:32.651296 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m03:44:32.656399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6957d830-a29f-4419-8500-bc26cd968dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed107a4670>]}
[0m03:44:32.698881 [debug] [MainThread]: On master: ROLLBACK
[0m03:44:32.731231 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:32.736915 [debug] [MainThread]: On master: BEGIN
[0m03:44:32.762858 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:44:32.769406 [debug] [MainThread]: On master: COMMIT
[0m03:44:32.774347 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:32.777845 [debug] [MainThread]: On master: COMMIT
[0m03:44:32.788725 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:44:32.793950 [debug] [MainThread]: On master: Close
[0m03:44:32.798477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:44:32.802853 [info ] [MainThread]: 
[0m03:44:32.843909 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m03:44:32.845627 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m03:44:32.848112 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m03:44:32.850268 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m03:44:32.854589 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m03:44:32.874724 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 03:44:32.851273 => 2024-10-25 03:44:32.874265
[0m03:44:32.877974 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m03:44:32.919695 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m03:44:32.989612 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:44:32.991413 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m03:44:32.993526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:44:33.057337 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:44:33.059249 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:44:33.061057 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m03:44:33.071274 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m03:44:33.074314 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m03:44:33.078273 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 03:44:32.879650 => 2024-10-25 03:44:33.078126
[0m03:44:33.080090 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m03:44:33.086819 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m03:44:33.088898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6957d830-a29f-4419-8500-bc26cd968dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1065f4c0>]}
[0m03:44:33.090871 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.24s]
[0m03:44:33.095540 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m03:44:33.097270 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m03:44:33.099299 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m03:44:33.102134 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m03:44:33.103974 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m03:44:33.111628 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m03:44:33.137313 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 03:44:33.105753 => 2024-10-25 03:44:33.137142
[0m03:44:33.138907 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m03:44:33.144514 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m03:44:33.160862 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:44:33.162658 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m03:44:33.164220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:44:33.205345 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:44:33.211463 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:44:33.214030 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m03:44:33.221473 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m03:44:33.225289 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m03:44:33.230996 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 03:44:33.140401 => 2024-10-25 03:44:33.230819
[0m03:44:33.233208 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m03:44:33.236194 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m03:44:33.238120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6957d830-a29f-4419-8500-bc26cd968dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1065f850>]}
[0m03:44:33.240286 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.14s]
[0m03:44:33.244668 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m03:44:33.246756 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m03:44:33.249075 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m03:44:33.252806 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m03:44:33.255059 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m03:44:33.261304 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m03:44:33.282294 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 03:44:33.256820 => 2024-10-25 03:44:33.282072
[0m03:44:33.285073 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m03:44:33.296811 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m03:44:33.321229 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:44:33.325749 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m03:44:33.327637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:44:33.353661 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:44:33.444572 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:44:33.446939 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m03:44:33.476638 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m03:44:33.491124 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m03:44:33.495501 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 03:44:33.287770 => 2024-10-25 03:44:33.495370
[0m03:44:33.496662 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m03:44:33.498424 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m03:44:33.499779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6957d830-a29f-4419-8500-bc26cd968dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed10836f20>]}
[0m03:44:33.500700 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.25s]
[0m03:44:33.503174 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m03:44:33.505215 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m03:44:33.508389 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m03:44:33.512863 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m03:44:33.516287 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:44:33.517838 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:33.519387 [debug] [MainThread]: On master: BEGIN
[0m03:44:33.520696 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:44:33.547297 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:44:33.549310 [debug] [MainThread]: On master: COMMIT
[0m03:44:33.551084 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:33.552485 [debug] [MainThread]: On master: COMMIT
[0m03:44:33.555227 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:44:33.556338 [debug] [MainThread]: On master: Close
[0m03:44:33.557707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:44:33.559392 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m03:44:33.560901 [info ] [MainThread]: 
[0m03:44:33.562626 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m03:44:33.564258 [debug] [MainThread]: Command end result
[0m03:44:33.587910 [info ] [MainThread]: 
[0m03:44:33.590590 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m03:44:33.593517 [info ] [MainThread]: 
[0m03:44:33.595161 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m03:44:33.596911 [error] [MainThread]:   relation "public.actors" does not exist
[0m03:44:33.598562 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m03:44:33.600397 [error] [MainThread]:                             ^
[0m03:44:33.601947 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m03:44:33.603787 [info ] [MainThread]: 
[0m03:44:33.609503 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m03:44:33.611770 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m03:44:33.613299 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m03:44:33.614760 [error] [MainThread]:                             ^
[0m03:44:33.616667 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m03:44:33.618452 [info ] [MainThread]: 
[0m03:44:33.619938 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m03:44:33.621072 [error] [MainThread]:   relation "public.films" does not exist
[0m03:44:33.622697 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m03:44:33.631490 [error] [MainThread]:                             ^
[0m03:44:33.633068 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m03:44:33.634542 [info ] [MainThread]: 
[0m03:44:33.636538 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m03:44:33.638617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed106af010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed108369e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed10834cd0>]}
[0m03:44:33.641672 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 05:15:43.014534 | 55072c66-f02e-4e32-9097-8a5ceeaa0ef8 ==============================
[0m05:15:43.014534 [info ] [MainThread]: Running with dbt=1.4.7
[0m05:15:43.016955 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:15:43.018421 [debug] [MainThread]: Tracking: tracking
[0m05:15:43.032749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4a9679360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4a96797e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4a96793c0>]}
[0m05:15:43.052364 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m05:15:43.397991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:15:43.399332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:15:43.401085 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m05:15:43.410217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55072c66-f02e-4e32-9097-8a5ceeaa0ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4a7db00d0>]}
[0m05:15:43.445245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55072c66-f02e-4e32-9097-8a5ceeaa0ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4a7d75150>]}
[0m05:15:43.446174 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m05:15:43.447802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55072c66-f02e-4e32-9097-8a5ceeaa0ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4a7d751b0>]}
[0m05:15:43.450452 [info ] [MainThread]: 
[0m05:15:43.453024 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:15:43.455076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m05:15:43.464633 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m05:15:43.466486 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m05:15:43.468223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:15:43.540604 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m05:15:43.542654 [debug] [ThreadPool]: On list_destination_db: Close
[0m05:15:43.544973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m05:15:43.550699 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m05:15:43.551673 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m05:15:43.552558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:15:43.575317 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:15:43.576424 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m05:15:43.577260 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m05:15:43.590071 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m05:15:43.592236 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m05:15:43.594849 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m05:15:43.599755 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:43.601016 [debug] [MainThread]: On master: BEGIN
[0m05:15:43.602217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:15:43.626168 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:15:43.627329 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:43.628242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:15:43.639464 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m05:15:43.641563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55072c66-f02e-4e32-9097-8a5ceeaa0ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4a7d741c0>]}
[0m05:15:43.642869 [debug] [MainThread]: On master: ROLLBACK
[0m05:15:43.645582 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:43.646663 [debug] [MainThread]: On master: BEGIN
[0m05:15:43.650904 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:15:43.651672 [debug] [MainThread]: On master: COMMIT
[0m05:15:43.652394 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:43.653136 [debug] [MainThread]: On master: COMMIT
[0m05:15:43.654965 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:15:43.655800 [debug] [MainThread]: On master: Close
[0m05:15:43.656942 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:15:43.658231 [info ] [MainThread]: 
[0m05:15:43.672280 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m05:15:43.674123 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m05:15:43.675688 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m05:15:43.677043 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m05:15:43.680491 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m05:15:43.694767 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 05:15:43.678599 => 2024-10-25 05:15:43.694665
[0m05:15:43.695864 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m05:15:43.727786 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m05:15:43.743585 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:15:43.745600 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m05:15:43.747880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:15:43.775248 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:15:43.776604 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:15:43.777642 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m05:15:43.782796 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m05:15:43.784109 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m05:15:43.786687 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 05:15:43.696754 => 2024-10-25 05:15:43.786614
[0m05:15:43.787708 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m05:15:43.794571 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m05:15:43.795892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55072c66-f02e-4e32-9097-8a5ceeaa0ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4a7c69270>]}
[0m05:15:43.797072 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.12s]
[0m05:15:43.799273 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m05:15:43.800581 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m05:15:43.801748 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m05:15:43.803064 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m05:15:43.804281 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m05:15:43.808457 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m05:15:43.815813 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 05:15:43.805328 => 2024-10-25 05:15:43.815729
[0m05:15:43.816685 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m05:15:43.820478 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m05:15:43.827615 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:15:43.828484 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m05:15:43.829394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:15:43.845412 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:15:43.846694 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:15:43.847833 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m05:15:43.850641 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m05:15:43.851992 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m05:15:43.854241 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 05:15:43.817376 => 2024-10-25 05:15:43.854181
[0m05:15:43.855156 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m05:15:43.856641 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m05:15:43.857811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55072c66-f02e-4e32-9097-8a5ceeaa0ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4a7c695a0>]}
[0m05:15:43.858842 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.06s]
[0m05:15:43.859686 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m05:15:43.860686 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m05:15:43.861557 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m05:15:43.862622 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m05:15:43.863702 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m05:15:43.866854 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m05:15:43.873758 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 05:15:43.864528 => 2024-10-25 05:15:43.873696
[0m05:15:43.874552 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m05:15:43.878381 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m05:15:43.888337 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:15:43.889450 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m05:15:43.890246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:15:43.934086 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:15:43.935398 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:15:43.936327 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m05:15:43.938988 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m05:15:43.939920 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m05:15:43.942041 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 05:15:43.875281 => 2024-10-25 05:15:43.941977
[0m05:15:43.942696 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m05:15:43.944257 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m05:15:43.945219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55072c66-f02e-4e32-9097-8a5ceeaa0ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4a7c0abf0>]}
[0m05:15:43.946222 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.08s]
[0m05:15:43.947074 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m05:15:43.948694 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m05:15:43.949421 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m05:15:43.950344 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m05:15:43.952209 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:15:43.953290 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:43.954058 [debug] [MainThread]: On master: BEGIN
[0m05:15:43.954847 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:15:43.969524 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:15:43.970474 [debug] [MainThread]: On master: COMMIT
[0m05:15:43.971459 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:43.972286 [debug] [MainThread]: On master: COMMIT
[0m05:15:43.974239 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:15:43.975105 [debug] [MainThread]: On master: Close
[0m05:15:43.976253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:15:43.977074 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m05:15:43.977844 [info ] [MainThread]: 
[0m05:15:43.978750 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m05:15:43.979802 [debug] [MainThread]: Command end result
[0m05:15:43.997075 [info ] [MainThread]: 
[0m05:15:43.998178 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m05:15:43.999290 [info ] [MainThread]: 
[0m05:15:44.000524 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m05:15:44.001515 [error] [MainThread]:   relation "public.actors" does not exist
[0m05:15:44.002447 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m05:15:44.003376 [error] [MainThread]:                             ^
[0m05:15:44.004212 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m05:15:44.005448 [info ] [MainThread]: 
[0m05:15:44.006653 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m05:15:44.007476 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m05:15:44.008414 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m05:15:44.009246 [error] [MainThread]:                             ^
[0m05:15:44.010075 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m05:15:44.010944 [info ] [MainThread]: 
[0m05:15:44.011705 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m05:15:44.012605 [error] [MainThread]:   relation "public.films" does not exist
[0m05:15:44.013451 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m05:15:44.014783 [error] [MainThread]:                             ^
[0m05:15:44.015591 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m05:15:44.016363 [info ] [MainThread]: 
[0m05:15:44.017089 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m05:15:44.017977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4a7c08d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4a7c0a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4a7bf91b0>]}
[0m05:15:44.018963 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 05:21:38.346297 | 1dd0d576-3f4f-4861-b0c0-519484752c78 ==============================
[0m05:21:38.346297 [info ] [MainThread]: Running with dbt=1.4.7
[0m05:21:38.349026 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:21:38.349804 [debug] [MainThread]: Tracking: tracking
[0m05:21:38.359300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3074d41360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3074d417e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3074d413c0>]}
[0m05:21:38.378368 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m05:21:38.400591 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:21:38.401794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1dd0d576-3f4f-4861-b0c0-519484752c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3074d400a0>]}
[0m05:21:39.018530 [debug] [MainThread]: 1699: static parser successfully parsed actors.sql
[0m05:21:39.030423 [debug] [MainThread]: 1699: static parser successfully parsed films.sql
[0m05:21:39.034344 [debug] [MainThread]: 1699: static parser successfully parsed film_actors.sql
[0m05:21:39.038298 [debug] [MainThread]: 1699: static parser successfully parsed film_ratings.sql
[0m05:21:39.138496 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m05:21:39.144589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dd0d576-3f4f-4861-b0c0-519484752c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307343f5b0>]}
[0m05:21:39.165415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dd0d576-3f4f-4861-b0c0-519484752c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307343f520>]}
[0m05:21:39.166486 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m05:21:39.168578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dd0d576-3f4f-4861-b0c0-519484752c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3074d44520>]}
[0m05:21:39.171252 [info ] [MainThread]: 
[0m05:21:39.173958 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:21:39.175953 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m05:21:39.186978 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m05:21:39.189364 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m05:21:39.191354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:21:39.223396 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m05:21:39.225353 [debug] [ThreadPool]: On list_destination_db: Close
[0m05:21:39.228000 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m05:21:39.233797 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m05:21:39.235127 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m05:21:39.235880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:21:39.249258 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:21:39.250557 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m05:21:39.251593 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m05:21:39.255791 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m05:21:39.257734 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m05:21:39.259801 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m05:21:39.265676 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:39.266689 [debug] [MainThread]: On master: BEGIN
[0m05:21:39.267777 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:21:39.280461 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:21:39.281721 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:39.282785 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:21:39.286802 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m05:21:39.288455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dd0d576-3f4f-4861-b0c0-519484752c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30714ff8b0>]}
[0m05:21:39.289665 [debug] [MainThread]: On master: ROLLBACK
[0m05:21:39.291752 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:39.292671 [debug] [MainThread]: On master: BEGIN
[0m05:21:39.295383 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:21:39.296317 [debug] [MainThread]: On master: COMMIT
[0m05:21:39.297189 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:39.298076 [debug] [MainThread]: On master: COMMIT
[0m05:21:39.300406 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:21:39.301457 [debug] [MainThread]: On master: Close
[0m05:21:39.302624 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:21:39.304127 [info ] [MainThread]: 
[0m05:21:39.321661 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m05:21:39.323497 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m05:21:39.324876 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m05:21:39.326189 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m05:21:39.329533 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m05:21:39.340602 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 05:21:39.327283 => 2024-10-25 05:21:39.340493
[0m05:21:39.341605 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m05:21:39.373372 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m05:21:39.387800 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:21:39.388519 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m05:21:39.389291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:39.404268 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:21:39.405605 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:21:39.406825 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m05:21:39.410202 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m05:21:39.411400 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m05:21:39.413821 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 05:21:39.342262 => 2024-10-25 05:21:39.413738
[0m05:21:39.415009 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m05:21:39.421631 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m05:21:39.422767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd0d576-3f4f-4861-b0c0-519484752c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3071550e80>]}
[0m05:21:39.423957 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.10s]
[0m05:21:39.426506 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m05:21:39.427538 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m05:21:39.428490 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m05:21:39.430512 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m05:21:39.432192 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m05:21:39.435839 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m05:21:39.444194 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 05:21:39.433284 => 2024-10-25 05:21:39.444084
[0m05:21:39.445283 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m05:21:39.449726 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m05:21:39.457076 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:21:39.457948 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m05:21:39.458821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:39.472278 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:21:39.473633 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:21:39.474535 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m05:21:39.476527 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m05:21:39.477557 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m05:21:39.479406 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 05:21:39.446290 => 2024-10-25 05:21:39.479326
[0m05:21:39.480457 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m05:21:39.481932 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m05:21:39.483187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd0d576-3f4f-4861-b0c0-519484752c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307158c460>]}
[0m05:21:39.484588 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.05s]
[0m05:21:39.485707 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m05:21:39.486635 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m05:21:39.487646 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m05:21:39.488877 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m05:21:39.489716 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m05:21:39.492965 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m05:21:39.500773 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 05:21:39.490605 => 2024-10-25 05:21:39.500650
[0m05:21:39.501800 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m05:21:39.506756 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m05:21:39.522939 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:21:39.524604 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m05:21:39.526516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:39.542076 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:21:39.543306 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:21:39.544332 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m05:21:39.547362 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m05:21:39.548710 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m05:21:39.550962 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 05:21:39.502618 => 2024-10-25 05:21:39.550878
[0m05:21:39.552229 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m05:21:39.553844 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m05:21:39.555038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd0d576-3f4f-4861-b0c0-519484752c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3071548d00>]}
[0m05:21:39.556269 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.07s]
[0m05:21:39.557476 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m05:21:39.559021 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m05:21:39.559860 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m05:21:39.560871 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m05:21:39.563296 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:21:39.564409 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:39.565721 [debug] [MainThread]: On master: BEGIN
[0m05:21:39.566575 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:21:39.578971 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:21:39.580034 [debug] [MainThread]: On master: COMMIT
[0m05:21:39.581070 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:39.582012 [debug] [MainThread]: On master: COMMIT
[0m05:21:39.584469 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:21:39.585547 [debug] [MainThread]: On master: Close
[0m05:21:39.586921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:21:39.587755 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m05:21:39.588789 [info ] [MainThread]: 
[0m05:21:39.589625 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m05:21:39.590745 [debug] [MainThread]: Command end result
[0m05:21:39.606277 [info ] [MainThread]: 
[0m05:21:39.607699 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m05:21:39.608768 [info ] [MainThread]: 
[0m05:21:39.609680 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m05:21:39.610664 [error] [MainThread]:   relation "public.actors" does not exist
[0m05:21:39.611569 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m05:21:39.612410 [error] [MainThread]:                             ^
[0m05:21:39.614283 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m05:21:39.616600 [info ] [MainThread]: 
[0m05:21:39.617953 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m05:21:39.619180 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m05:21:39.620219 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m05:21:39.621135 [error] [MainThread]:                             ^
[0m05:21:39.622193 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m05:21:39.623497 [info ] [MainThread]: 
[0m05:21:39.624642 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m05:21:39.625901 [error] [MainThread]:   relation "public.films" does not exist
[0m05:21:39.627043 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m05:21:39.628094 [error] [MainThread]:                             ^
[0m05:21:39.629093 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m05:21:39.630135 [info ] [MainThread]: 
[0m05:21:39.631173 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m05:21:39.632414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307348e800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307348e7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307348ddb0>]}
[0m05:21:39.633753 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 05:28:12.202993 | 6e300687-f907-439b-bc53-62be9b4d1eb8 ==============================
[0m05:28:12.202993 [info ] [MainThread]: Running with dbt=1.4.7
[0m05:28:12.206658 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:28:12.208382 [debug] [MainThread]: Tracking: tracking
[0m05:28:12.217951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f1ee150f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f1ee157b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f1ee15390>]}
[0m05:28:12.234155 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m05:28:12.363527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:28:12.364913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:28:12.366155 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m05:28:12.374552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e300687-f907-439b-bc53-62be9b4d1eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f1d54c0d0>]}
[0m05:28:12.397883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e300687-f907-439b-bc53-62be9b4d1eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f1d5111e0>]}
[0m05:28:12.398882 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m05:28:12.400297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e300687-f907-439b-bc53-62be9b4d1eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f1d511240>]}
[0m05:28:12.402559 [info ] [MainThread]: 
[0m05:28:12.405470 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:28:12.407387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m05:28:12.421972 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m05:28:12.424015 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m05:28:12.425707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:28:12.465202 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m05:28:12.467374 [debug] [ThreadPool]: On list_destination_db: Close
[0m05:28:12.469774 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m05:28:12.475821 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m05:28:12.476942 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m05:28:12.477766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:28:12.491225 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:28:12.492511 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m05:28:12.493477 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m05:28:12.497712 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m05:28:12.499487 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m05:28:12.501542 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m05:28:12.506336 [debug] [MainThread]: Using postgres connection "master"
[0m05:28:12.507342 [debug] [MainThread]: On master: BEGIN
[0m05:28:12.508045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:28:12.529549 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:28:12.530757 [debug] [MainThread]: Using postgres connection "master"
[0m05:28:12.531707 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:28:12.536042 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m05:28:12.537704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e300687-f907-439b-bc53-62be9b4d1eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f1d510040>]}
[0m05:28:12.538674 [debug] [MainThread]: On master: ROLLBACK
[0m05:28:12.540544 [debug] [MainThread]: Using postgres connection "master"
[0m05:28:12.541414 [debug] [MainThread]: On master: BEGIN
[0m05:28:12.544375 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:28:12.545218 [debug] [MainThread]: On master: COMMIT
[0m05:28:12.546077 [debug] [MainThread]: Using postgres connection "master"
[0m05:28:12.547268 [debug] [MainThread]: On master: COMMIT
[0m05:28:12.549182 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:28:12.550123 [debug] [MainThread]: On master: Close
[0m05:28:12.551307 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:28:12.552266 [info ] [MainThread]: 
[0m05:28:12.567429 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m05:28:12.568700 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m05:28:12.570189 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m05:28:12.571037 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m05:28:12.574206 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m05:28:12.581674 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 05:28:12.571839 => 2024-10-25 05:28:12.581597
[0m05:28:12.582605 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m05:28:12.617026 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m05:28:12.627874 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:28:12.628976 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m05:28:12.630214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:28:12.645611 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:28:12.646860 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:28:12.647781 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m05:28:12.650720 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m05:28:12.651511 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m05:28:12.653573 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 05:28:12.583725 => 2024-10-25 05:28:12.653492
[0m05:28:12.654431 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m05:28:12.661401 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m05:28:12.663274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e300687-f907-439b-bc53-62be9b4d1eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f1d416e30>]}
[0m05:28:12.664709 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.09s]
[0m05:28:12.667058 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m05:28:12.668544 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m05:28:12.669936 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m05:28:12.671208 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m05:28:12.672265 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m05:28:12.676965 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m05:28:12.689004 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 05:28:12.673355 => 2024-10-25 05:28:12.688883
[0m05:28:12.690017 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m05:28:12.693930 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m05:28:12.700322 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:28:12.701257 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m05:28:12.702053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:28:12.715366 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:28:12.716776 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:28:12.717551 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m05:28:12.719685 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m05:28:12.720700 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m05:28:12.722838 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 05:28:12.690864 => 2024-10-25 05:28:12.722771
[0m05:28:12.725133 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m05:28:12.726745 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m05:28:12.727774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e300687-f907-439b-bc53-62be9b4d1eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f1d416aa0>]}
[0m05:28:12.728793 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.06s]
[0m05:28:12.729765 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m05:28:12.730724 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m05:28:12.731693 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m05:28:12.732778 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m05:28:12.733491 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m05:28:12.737523 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m05:28:12.744615 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 05:28:12.734506 => 2024-10-25 05:28:12.744466
[0m05:28:12.745629 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m05:28:12.749743 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m05:28:12.755996 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:28:12.756983 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m05:28:12.757725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:28:12.770693 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:28:12.771944 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:28:12.772921 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m05:28:12.775904 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m05:28:12.777030 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m05:28:12.779302 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 05:28:12.746502 => 2024-10-25 05:28:12.779218
[0m05:28:12.780243 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m05:28:12.781864 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m05:28:12.782925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e300687-f907-439b-bc53-62be9b4d1eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f1d3a6bc0>]}
[0m05:28:12.784378 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.05s]
[0m05:28:12.786193 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m05:28:12.787821 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m05:28:12.788764 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m05:28:12.789592 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m05:28:12.791583 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:28:12.792650 [debug] [MainThread]: Using postgres connection "master"
[0m05:28:12.793661 [debug] [MainThread]: On master: BEGIN
[0m05:28:12.794466 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:28:12.810051 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:28:12.811231 [debug] [MainThread]: On master: COMMIT
[0m05:28:12.812197 [debug] [MainThread]: Using postgres connection "master"
[0m05:28:12.813011 [debug] [MainThread]: On master: COMMIT
[0m05:28:12.814982 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:28:12.815983 [debug] [MainThread]: On master: Close
[0m05:28:12.817245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:28:12.818027 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m05:28:12.818844 [info ] [MainThread]: 
[0m05:28:12.819719 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m05:28:12.820859 [debug] [MainThread]: Command end result
[0m05:28:12.838247 [info ] [MainThread]: 
[0m05:28:12.839486 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m05:28:12.841087 [info ] [MainThread]: 
[0m05:28:12.842290 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m05:28:12.843446 [error] [MainThread]:   relation "public.actors" does not exist
[0m05:28:12.844507 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m05:28:12.847143 [error] [MainThread]:                             ^
[0m05:28:12.849594 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m05:28:12.851219 [info ] [MainThread]: 
[0m05:28:12.852692 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m05:28:12.853995 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m05:28:12.855021 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m05:28:12.856014 [error] [MainThread]:                             ^
[0m05:28:12.857128 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m05:28:12.858368 [info ] [MainThread]: 
[0m05:28:12.859308 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m05:28:12.860554 [error] [MainThread]:   relation "public.films" does not exist
[0m05:28:12.861445 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m05:28:12.862463 [error] [MainThread]:                             ^
[0m05:28:12.863315 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m05:28:12.864198 [info ] [MainThread]: 
[0m05:28:12.865146 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m05:28:12.866293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f1d41b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f1d3a67a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f1d3a4c70>]}
[0m05:28:12.868198 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 05:47:32.813303 | 56c108b0-5d6f-42a6-9dcf-414a56b31941 ==============================
[0m05:47:32.813303 [info ] [MainThread]: Running with dbt=1.4.7
[0m05:47:32.815700 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:47:32.816741 [debug] [MainThread]: Tracking: tracking
[0m05:47:32.828351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d83d4b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d83d6fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d83d4b20>]}
[0m05:47:32.851476 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m05:47:32.993769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:47:32.994525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:47:32.995638 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m05:47:33.003643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56c108b0-5d6f-42a6-9dcf-414a56b31941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d6a700d0>]}
[0m05:47:33.026917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56c108b0-5d6f-42a6-9dcf-414a56b31941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d6b1d000>]}
[0m05:47:33.027989 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m05:47:33.030363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56c108b0-5d6f-42a6-9dcf-414a56b31941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d6b1d060>]}
[0m05:47:33.032703 [info ] [MainThread]: 
[0m05:47:33.035463 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:47:33.038070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m05:47:33.050973 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m05:47:33.052796 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m05:47:33.054559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:47:33.112083 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m05:47:33.114575 [debug] [ThreadPool]: On list_destination_db: Close
[0m05:47:33.117223 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m05:47:33.122981 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m05:47:33.124240 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m05:47:33.125323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:47:33.140975 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:47:33.142089 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m05:47:33.143002 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m05:47:33.153229 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m05:47:33.155264 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m05:47:33.157524 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m05:47:33.163733 [debug] [MainThread]: Using postgres connection "master"
[0m05:47:33.164921 [debug] [MainThread]: On master: BEGIN
[0m05:47:33.166035 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:47:33.179963 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:47:33.181308 [debug] [MainThread]: Using postgres connection "master"
[0m05:47:33.182296 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:47:33.190690 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m05:47:33.192468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56c108b0-5d6f-42a6-9dcf-414a56b31941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d68c3430>]}
[0m05:47:33.193457 [debug] [MainThread]: On master: ROLLBACK
[0m05:47:33.195415 [debug] [MainThread]: Using postgres connection "master"
[0m05:47:33.196173 [debug] [MainThread]: On master: BEGIN
[0m05:47:33.199300 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:47:33.200166 [debug] [MainThread]: On master: COMMIT
[0m05:47:33.201233 [debug] [MainThread]: Using postgres connection "master"
[0m05:47:33.202131 [debug] [MainThread]: On master: COMMIT
[0m05:47:33.204237 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:47:33.205049 [debug] [MainThread]: On master: Close
[0m05:47:33.206116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:47:33.207096 [info ] [MainThread]: 
[0m05:47:33.212911 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m05:47:33.213949 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m05:47:33.215153 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m05:47:33.215853 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m05:47:33.218519 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m05:47:33.225737 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 05:47:33.216456 => 2024-10-25 05:47:33.225662
[0m05:47:33.226630 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m05:47:33.255987 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m05:47:33.272198 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:47:33.273944 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m05:47:33.275460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:47:33.289548 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:47:33.290355 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:47:33.291153 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m05:47:33.297276 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m05:47:33.302971 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:47:33.303715 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m05:47:33.305500 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:47:33.309086 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:47:33.310039 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m05:47:33.312133 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:47:33.327607 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m05:47:33.329458 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:47:33.330712 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m05:47:33.335365 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m05:47:33.340083 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:47:33.341560 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m05:47:33.347624 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m05:47:33.349114 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 05:47:33.227442 => 2024-10-25 05:47:33.349067
[0m05:47:33.349996 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m05:47:33.351219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56c108b0-5d6f-42a6-9dcf-414a56b31941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d68c8040>]}
[0m05:47:33.352159 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.actors ................................. [[32mCREATE VIEW[0m in 0.14s]
[0m05:47:33.355020 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m05:47:33.355756 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m05:47:33.356530 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m05:47:33.357929 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m05:47:33.358812 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m05:47:33.361562 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m05:47:33.367069 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 05:47:33.359487 => 2024-10-25 05:47:33.367012
[0m05:47:33.367774 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m05:47:33.371513 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m05:47:33.377991 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:47:33.378690 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m05:47:33.379478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:47:33.390549 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:47:33.391473 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:47:33.392088 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m05:47:33.395528 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m05:47:33.398437 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:47:33.399115 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m05:47:33.400678 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:47:33.403412 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:47:33.404162 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m05:47:33.405962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:47:33.408138 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m05:47:33.408901 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:47:33.409592 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m05:47:33.412437 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m05:47:33.414454 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:47:33.415188 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m05:47:33.418847 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m05:47:33.420392 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 05:47:33.368528 => 2024-10-25 05:47:33.420352
[0m05:47:33.421271 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m05:47:33.422407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56c108b0-5d6f-42a6-9dcf-414a56b31941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d68c94b0>]}
[0m05:47:33.423326 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.film_actors ............................ [[32mCREATE VIEW[0m in 0.06s]
[0m05:47:33.425018 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m05:47:33.426139 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m05:47:33.427149 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m05:47:33.428655 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m05:47:33.429488 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m05:47:33.432282 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m05:47:33.438346 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 05:47:33.430069 => 2024-10-25 05:47:33.438283
[0m05:47:33.439055 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m05:47:33.444232 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m05:47:33.449840 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:47:33.450930 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m05:47:33.451605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:47:33.465112 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:47:33.466166 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:47:33.467442 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m05:47:33.471181 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m05:47:33.474476 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:47:33.475546 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m05:47:33.478567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:47:33.481593 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:47:33.482660 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m05:47:33.485192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:47:33.487377 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m05:47:33.488244 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:47:33.489012 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m05:47:33.491779 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m05:47:33.494328 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:47:33.495088 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m05:47:33.499414 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m05:47:33.500967 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 05:47:33.439695 => 2024-10-25 05:47:33.500923
[0m05:47:33.501844 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m05:47:33.502904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56c108b0-5d6f-42a6-9dcf-414a56b31941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d6993f70>]}
[0m05:47:33.503696 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.films .................................. [[32mCREATE VIEW[0m in 0.07s]
[0m05:47:33.504990 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m05:47:33.506216 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m05:47:33.507065 [info ] [Thread-1 (]: 4 of 4 START sql view model public.film_ratings ................................ [RUN]
[0m05:47:33.508600 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m05:47:33.509410 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m05:47:33.512846 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m05:47:33.518872 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-10-25 05:47:33.510104 => 2024-10-25 05:47:33.518804
[0m05:47:33.519738 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m05:47:33.523683 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m05:47:33.531811 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m05:47:33.532709 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m05:47:33.533559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:47:33.546220 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:47:33.547080 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m05:47:33.547889 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  create view "destination_db"."public"."film_ratings__dbt_tmp" as (
    WITH films_with_ratings as (
    SELECT film_id,
            title,
            release_date,
            price,
            rating,
            user_rating,
            CASE WHEN user_rating >= 4.5 THEN 'Excellent'
                 WHEN user_rating BETWEEN 4 AND 4.5 THEN 'Good'
                 WHEN user_rating BETWEEN 3 AND 4 THEN 'Average'
                 ELSE 'Bad' 
                 END as rating_category
    FROM "destination_db"."public"."films"

),
films_with_actors AS (
  SELECT
    f.film_id,
    f.title,
    STRING_AGG(a.actor_name, ',') AS actors
  FROM "destination_db"."public"."films" f
  LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
  LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
  GROUP BY f.film_id, f.title
)

SELECT fwr.*,
       fwa.actors
FROM films_with_ratings fwr
LEFT JOIN films_with_actors fwa
ON fwr.film_id = fwa. film_id
  );
[0m05:47:33.552877 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 16:     FROM "destination_db"."public"."films"
                  ^

[0m05:47:33.555327 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m05:47:33.560981 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-10-25 05:47:33.520530 => 2024-10-25 05:47:33.560879
[0m05:47:33.562663 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m05:47:33.569637 [debug] [Thread-1 (]: Database Error in model film_ratings (models/film_ratings.sql)
  relation "public.films" does not exist
  LINE 16:     FROM "destination_db"."public"."films"
                    ^
  compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m05:47:33.570879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56c108b0-5d6f-42a6-9dcf-414a56b31941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d6aaf4f0>]}
[0m05:47:33.572037 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model public.film_ratings ....................... [[31mERROR[0m in 0.06s]
[0m05:47:33.572933 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m05:47:33.575301 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:47:33.576180 [debug] [MainThread]: Using postgres connection "master"
[0m05:47:33.577183 [debug] [MainThread]: On master: BEGIN
[0m05:47:33.578032 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:47:33.592008 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:47:33.593068 [debug] [MainThread]: On master: COMMIT
[0m05:47:33.594037 [debug] [MainThread]: Using postgres connection "master"
[0m05:47:33.594871 [debug] [MainThread]: On master: COMMIT
[0m05:47:33.596761 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:47:33.597539 [debug] [MainThread]: On master: Close
[0m05:47:33.598608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:47:33.599401 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m05:47:33.600241 [info ] [MainThread]: 
[0m05:47:33.601031 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m05:47:33.602290 [debug] [MainThread]: Command end result
[0m05:47:33.616895 [info ] [MainThread]: 
[0m05:47:33.618153 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:47:33.619266 [info ] [MainThread]: 
[0m05:47:33.620234 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/film_ratings.sql)[0m
[0m05:47:33.621427 [error] [MainThread]:   relation "public.films" does not exist
[0m05:47:33.622385 [error] [MainThread]:   LINE 16:     FROM "destination_db"."public"."films"
[0m05:47:33.623199 [error] [MainThread]:                     ^
[0m05:47:33.624524 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m05:47:33.625694 [info ] [MainThread]: 
[0m05:47:33.626689 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m05:47:33.627789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d6b1cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d83d55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d69b1330>]}
[0m05:47:33.628832 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 05:52:32.098527 | 9c9bfd98-3fe7-40f0-9f5b-fd59042e0dc7 ==============================
[0m05:52:32.098527 [info ] [MainThread]: Running with dbt=1.4.7
[0m05:52:32.101669 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:52:32.102272 [debug] [MainThread]: Tracking: tracking
[0m05:52:32.111760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5ef0d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5ef0d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5ef0d3c0>]}
[0m05:52:32.123453 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m05:52:32.264244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:52:32.265413 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:52:32.266657 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m05:52:32.274609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c9bfd98-3fe7-40f0-9f5b-fd59042e0dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5d6440d0>]}
[0m05:52:32.290680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c9bfd98-3fe7-40f0-9f5b-fd59042e0dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5d60d2d0>]}
[0m05:52:32.291652 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m05:52:32.292801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c9bfd98-3fe7-40f0-9f5b-fd59042e0dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5d60d330>]}
[0m05:52:32.295081 [info ] [MainThread]: 
[0m05:52:32.297450 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:52:32.299428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m05:52:32.310648 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m05:52:32.312149 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m05:52:32.313648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:52:32.345599 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m05:52:32.347812 [debug] [ThreadPool]: On list_destination_db: Close
[0m05:52:32.350376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m05:52:32.356227 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m05:52:32.357200 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m05:52:32.358028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:52:32.371751 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:52:32.372774 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m05:52:32.373721 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m05:52:32.378421 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m05:52:32.380464 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m05:52:32.382965 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m05:52:32.389048 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:32.390112 [debug] [MainThread]: On master: BEGIN
[0m05:52:32.391111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:52:32.403948 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:52:32.404999 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:32.405944 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:52:32.411947 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m05:52:32.413775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c9bfd98-3fe7-40f0-9f5b-fd59042e0dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5d6068f0>]}
[0m05:52:32.414900 [debug] [MainThread]: On master: ROLLBACK
[0m05:52:32.417095 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:32.417863 [debug] [MainThread]: On master: BEGIN
[0m05:52:32.420740 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:52:32.421623 [debug] [MainThread]: On master: COMMIT
[0m05:52:32.422334 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:32.423256 [debug] [MainThread]: On master: COMMIT
[0m05:52:32.425093 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:52:32.425934 [debug] [MainThread]: On master: Close
[0m05:52:32.427165 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:52:32.428198 [info ] [MainThread]: 
[0m05:52:32.442480 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m05:52:32.443721 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m05:52:32.445108 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m05:52:32.446177 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m05:52:32.449392 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m05:52:32.458643 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 05:52:32.447265 => 2024-10-25 05:52:32.458564
[0m05:52:32.459680 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m05:52:32.488268 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m05:52:32.510901 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:52:32.512619 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m05:52:32.514538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:52:32.532577 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:52:32.533842 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:52:32.534950 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m05:52:32.538906 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m05:52:32.545862 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:52:32.547337 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m05:52:32.551643 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:52:32.555030 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:52:32.555970 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m05:52:32.558652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:52:32.575117 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m05:52:32.576478 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:52:32.578211 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m05:52:32.584878 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m05:52:32.590667 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:52:32.592353 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m05:52:32.598584 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m05:52:32.600685 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 05:52:32.460408 => 2024-10-25 05:52:32.600635
[0m05:52:32.601558 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m05:52:32.602948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9bfd98-3fe7-40f0-9f5b-fd59042e0dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5d4d2920>]}
[0m05:52:32.603996 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.actors ................................. [[32mCREATE VIEW[0m in 0.16s]
[0m05:52:32.606201 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m05:52:32.607260 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m05:52:32.608227 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m05:52:32.609347 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m05:52:32.610134 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m05:52:32.613153 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m05:52:32.620475 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 05:52:32.610960 => 2024-10-25 05:52:32.620403
[0m05:52:32.621620 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m05:52:32.625738 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m05:52:32.636058 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:52:32.637374 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m05:52:32.638613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:52:32.653634 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:52:32.654822 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:52:32.656047 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m05:52:32.661201 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m05:52:32.664593 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:52:32.665859 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m05:52:32.669302 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:52:32.672378 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:52:32.673333 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m05:52:32.675723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:52:32.677880 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m05:52:32.679299 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:52:32.680594 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m05:52:32.683850 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m05:52:32.686386 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:52:32.687240 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m05:52:32.691523 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m05:52:32.693444 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 05:52:32.622410 => 2024-10-25 05:52:32.693389
[0m05:52:32.694599 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m05:52:32.695968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9bfd98-3fe7-40f0-9f5b-fd59042e0dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5d4d2cb0>]}
[0m05:52:32.696980 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.film_actors ............................ [[32mCREATE VIEW[0m in 0.09s]
[0m05:52:32.699064 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m05:52:32.700019 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m05:52:32.700889 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m05:52:32.701945 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m05:52:32.702743 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m05:52:32.705734 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m05:52:32.712466 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 05:52:32.703616 => 2024-10-25 05:52:32.712375
[0m05:52:32.713484 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m05:52:32.718463 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m05:52:32.725275 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:52:32.726171 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m05:52:32.727227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:52:32.741007 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:52:32.742310 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:52:32.743161 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m05:52:32.746087 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m05:52:32.749199 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:52:32.750248 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m05:52:32.752402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:52:32.755418 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:52:32.756414 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m05:52:32.758479 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:52:32.760485 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m05:52:32.761396 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:52:32.762105 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m05:52:32.765314 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m05:52:32.767774 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:52:32.768544 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m05:52:32.772701 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m05:52:32.774370 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 05:52:32.714255 => 2024-10-25 05:52:32.774327
[0m05:52:32.775268 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m05:52:32.776527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9bfd98-3fe7-40f0-9f5b-fd59042e0dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5d4f5960>]}
[0m05:52:32.777470 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.films .................................. [[32mCREATE VIEW[0m in 0.07s]
[0m05:52:32.778488 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m05:52:32.779887 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m05:52:32.780659 [info ] [Thread-1 (]: 4 of 4 START sql view model public.film_ratings ................................ [RUN]
[0m05:52:32.781804 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m05:52:32.782762 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m05:52:32.786532 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m05:52:32.794027 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-10-25 05:52:32.783633 => 2024-10-25 05:52:32.793956
[0m05:52:32.794998 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m05:52:32.799196 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m05:52:32.805511 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m05:52:32.806261 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m05:52:32.806975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:52:32.820444 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:52:32.821751 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m05:52:32.822562 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  create view "destination_db"."public"."film_ratings__dbt_tmp" as (
    WITH films_with_ratings as (
    SELECT film_id,
            title,
            release_date,
            price,
            rating,
            user_rating,
            CASE WHEN user_rating >= 4.5 THEN 'Excellent'
                 WHEN user_rating BETWEEN 4 AND 4.5 THEN 'Good'
                 WHEN user_rating BETWEEN 3 AND 4 THEN 'Average'
                 ELSE 'Bad' 
                 END as rating_category
    FROM "destination_db"."public"."films"

),
films_with_actors AS (
  SELECT
    f.film_id,
    f.title,
    STRING_AGG(a.actor_name, ',') AS actors
  FROM "destination_db"."public"."films" f
  LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
  LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
  GROUP BY f.film_id, f.title
)

SELECT fwr.*,
       fwa.actors
FROM films_with_ratings fwr
LEFT JOIN films_with_actors fwa
ON fwr.film_id = fwa. film_id
  );
[0m05:52:32.825539 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 16:     FROM "destination_db"."public"."films"
                  ^

[0m05:52:32.826490 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m05:52:32.829534 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-10-25 05:52:32.795710 => 2024-10-25 05:52:32.829440
[0m05:52:32.830319 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m05:52:32.836826 [debug] [Thread-1 (]: Database Error in model film_ratings (models/film_ratings.sql)
  relation "public.films" does not exist
  LINE 16:     FROM "destination_db"."public"."films"
                    ^
  compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m05:52:32.837845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9bfd98-3fe7-40f0-9f5b-fd59042e0dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5d4d0e50>]}
[0m05:52:32.838691 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model public.film_ratings ....................... [[31mERROR[0m in 0.06s]
[0m05:52:32.839802 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m05:52:32.842563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:52:32.844112 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:32.845497 [debug] [MainThread]: On master: BEGIN
[0m05:52:32.847035 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:52:32.865163 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:52:32.866173 [debug] [MainThread]: On master: COMMIT
[0m05:52:32.866961 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:32.867762 [debug] [MainThread]: On master: COMMIT
[0m05:52:32.869420 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:52:32.870208 [debug] [MainThread]: On master: Close
[0m05:52:32.871373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:52:32.872110 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m05:52:32.873012 [info ] [MainThread]: 
[0m05:52:32.873920 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m05:52:32.874982 [debug] [MainThread]: Command end result
[0m05:52:32.888039 [info ] [MainThread]: 
[0m05:52:32.888931 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:52:32.889858 [info ] [MainThread]: 
[0m05:52:32.890786 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/film_ratings.sql)[0m
[0m05:52:32.891807 [error] [MainThread]:   relation "public.films" does not exist
[0m05:52:32.892760 [error] [MainThread]:   LINE 16:     FROM "destination_db"."public"."films"
[0m05:52:32.893635 [error] [MainThread]:                     ^
[0m05:52:32.894510 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m05:52:32.895431 [info ] [MainThread]: 
[0m05:52:32.896247 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m05:52:32.897247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5d60ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5d4f5960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5d4c21d0>]}
[0m05:52:32.898533 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 05:55:13.977938 | 1e14013a-8132-42b1-9153-26c2b847849f ==============================
[0m05:55:13.977938 [info ] [MainThread]: Running with dbt=1.4.7
[0m05:55:13.980943 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:55:13.983158 [debug] [MainThread]: Tracking: tracking
[0m05:55:13.990788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa253999360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2539997e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2539993c0>]}
[0m05:55:14.011295 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m05:55:14.033916 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:55:14.035462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1e14013a-8132-42b1-9153-26c2b847849f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2539980a0>]}
[0m05:55:14.542406 [debug] [MainThread]: 1699: static parser successfully parsed actors.sql
[0m05:55:14.555516 [debug] [MainThread]: 1699: static parser successfully parsed films.sql
[0m05:55:14.559586 [debug] [MainThread]: 1699: static parser successfully parsed film_actors.sql
[0m05:55:14.564403 [debug] [MainThread]: 1699: static parser successfully parsed film_ratings.sql
[0m05:55:14.665944 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m05:55:14.671771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e14013a-8132-42b1-9153-26c2b847849f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2520975b0>]}
[0m05:55:14.701312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e14013a-8132-42b1-9153-26c2b847849f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa252097520>]}
[0m05:55:14.703036 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m05:55:14.704344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e14013a-8132-42b1-9153-26c2b847849f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2539a4520>]}
[0m05:55:14.706845 [info ] [MainThread]: 
[0m05:55:14.709390 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:55:14.712020 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m05:55:14.721550 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m05:55:14.724018 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m05:55:14.726154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:55:14.737210 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "host.docker.internal" (fdc4:f303:9324::254), port 5432 failed: Network is unreachable
	Is the server running on that host and accepting TCP/IP connections?

[0m05:55:14.741907 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m05:55:14.743642 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m05:55:14.745530 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m05:55:14.747067 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m05:55:14.748767 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m05:55:14.751071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:55:14.752287 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m05:55:14.753516 [info ] [MainThread]: 
[0m05:55:14.754603 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m05:55:14.755518 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "host.docker.internal" (fdc4:f303:9324::254), port 5432 failed: Network is unreachable
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m05:55:14.756654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa252097400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25015b970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25015ba60>]}
[0m05:55:14.757702 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 05:55:50.440296 | dd961516-c5d5-4ae3-ae3d-b29155ed9ea3 ==============================
[0m05:55:50.440296 [info ] [MainThread]: Running with dbt=1.4.7
[0m05:55:50.443037 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:55:50.443837 [debug] [MainThread]: Tracking: tracking
[0m05:55:50.446068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f80b5360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f80b57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f80b53c0>]}
[0m05:55:50.460965 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m05:55:50.477068 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:55:50.478149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd961516-c5d5-4ae3-ae3d-b29155ed9ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f80b40a0>]}
[0m05:55:50.984843 [debug] [MainThread]: 1699: static parser successfully parsed actors.sql
[0m05:55:50.998507 [debug] [MainThread]: 1699: static parser successfully parsed films.sql
[0m05:55:51.002563 [debug] [MainThread]: 1699: static parser successfully parsed film_actors.sql
[0m05:55:51.006733 [debug] [MainThread]: 1699: static parser successfully parsed film_ratings.sql
[0m05:55:51.092449 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m05:55:51.098176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd961516-c5d5-4ae3-ae3d-b29155ed9ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f67c35b0>]}
[0m05:55:51.124041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd961516-c5d5-4ae3-ae3d-b29155ed9ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f67c3520>]}
[0m05:55:51.124988 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m05:55:51.125839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd961516-c5d5-4ae3-ae3d-b29155ed9ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f80cc520>]}
[0m05:55:51.127718 [info ] [MainThread]: 
[0m05:55:51.130197 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:55:51.132708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m05:55:51.141699 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m05:55:51.143701 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m05:55:51.145393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:55:51.169027 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m05:55:51.171026 [debug] [ThreadPool]: On list_destination_db: Close
[0m05:55:51.173425 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m05:55:51.179644 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m05:55:51.180710 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m05:55:51.182099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:55:51.194833 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:55:51.195799 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m05:55:51.196662 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m05:55:51.201512 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m05:55:51.203706 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m05:55:51.206158 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m05:55:51.212520 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:51.213928 [debug] [MainThread]: On master: BEGIN
[0m05:55:51.215108 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:55:51.229875 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:55:51.231083 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:51.232493 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:55:51.238625 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m05:55:51.240315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd961516-c5d5-4ae3-ae3d-b29155ed9ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f467f8b0>]}
[0m05:55:51.241323 [debug] [MainThread]: On master: ROLLBACK
[0m05:55:51.243666 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:51.244606 [debug] [MainThread]: On master: BEGIN
[0m05:55:51.247724 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:55:51.248575 [debug] [MainThread]: On master: COMMIT
[0m05:55:51.249661 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:51.250581 [debug] [MainThread]: On master: COMMIT
[0m05:55:51.252511 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:55:51.253405 [debug] [MainThread]: On master: Close
[0m05:55:51.254727 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:55:51.255505 [info ] [MainThread]: 
[0m05:55:51.270272 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m05:55:51.272210 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m05:55:51.273696 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m05:55:51.275234 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m05:55:51.278565 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m05:55:51.289585 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 05:55:51.276374 => 2024-10-25 05:55:51.289471
[0m05:55:51.291150 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m05:55:51.322224 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m05:55:51.343451 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:55:51.345662 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m05:55:51.347597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:51.363546 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:55:51.365078 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:55:51.366626 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m05:55:51.370939 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m05:55:51.377279 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:55:51.379220 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m05:55:51.383493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:55:51.386676 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:55:51.388203 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m05:55:51.392425 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:55:51.407485 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m05:55:51.409584 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:55:51.411755 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m05:55:51.418280 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m05:55:51.424387 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:55:51.425901 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m05:55:51.430070 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m05:55:51.431673 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 05:55:51.292343 => 2024-10-25 05:55:51.431628
[0m05:55:51.432551 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m05:55:51.433846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd961516-c5d5-4ae3-ae3d-b29155ed9ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f45310f0>]}
[0m05:55:51.434699 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.actors ................................. [[32mCREATE VIEW[0m in 0.16s]
[0m05:55:51.437013 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m05:55:51.438055 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m05:55:51.438870 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m05:55:51.440049 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m05:55:51.440905 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m05:55:51.443771 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m05:55:51.449320 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 05:55:51.441556 => 2024-10-25 05:55:51.449238
[0m05:55:51.450098 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m05:55:51.454013 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m05:55:51.459768 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:55:51.460469 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m05:55:51.461269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:51.474701 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:55:51.475894 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:55:51.476623 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m05:55:51.479503 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m05:55:51.482954 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:55:51.483943 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m05:55:51.486317 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:55:51.489145 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:55:51.490206 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m05:55:51.492166 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:55:51.493997 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m05:55:51.494782 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:55:51.495394 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m05:55:51.497904 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m05:55:51.500396 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:55:51.501187 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m05:55:51.504827 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m05:55:51.506768 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 05:55:51.450828 => 2024-10-25 05:55:51.506724
[0m05:55:51.507503 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m05:55:51.508541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd961516-c5d5-4ae3-ae3d-b29155ed9ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f4530100>]}
[0m05:55:51.509347 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.film_actors ............................ [[32mCREATE VIEW[0m in 0.07s]
[0m05:55:51.510866 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m05:55:51.511884 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m05:55:51.512823 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m05:55:51.513974 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m05:55:51.515000 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m05:55:51.517860 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m05:55:51.523341 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 05:55:51.515586 => 2024-10-25 05:55:51.523281
[0m05:55:51.524065 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m05:55:51.527732 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m05:55:51.533552 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:55:51.534292 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m05:55:51.534979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:51.547561 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:55:51.548727 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:55:51.549740 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m05:55:51.553112 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m05:55:51.556169 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:55:51.557303 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m05:55:51.559166 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:55:51.562766 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:55:51.563631 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m05:55:51.565384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:55:51.567873 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m05:55:51.568629 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:55:51.569424 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m05:55:51.572273 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m05:55:51.574884 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:55:51.575900 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m05:55:51.579668 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m05:55:51.581244 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 05:55:51.524750 => 2024-10-25 05:55:51.581201
[0m05:55:51.582136 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m05:55:51.583340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd961516-c5d5-4ae3-ae3d-b29155ed9ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f4597910>]}
[0m05:55:51.584278 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.films .................................. [[32mCREATE VIEW[0m in 0.07s]
[0m05:55:51.585731 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m05:55:51.587300 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m05:55:51.588169 [info ] [Thread-1 (]: 4 of 4 START sql view model public.film_ratings ................................ [RUN]
[0m05:55:51.589260 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m05:55:51.590040 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m05:55:51.593314 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m05:55:51.599185 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-10-25 05:55:51.590752 => 2024-10-25 05:55:51.599112
[0m05:55:51.600030 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m05:55:51.603680 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m05:55:51.609299 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m05:55:51.610046 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m05:55:51.610686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:51.622290 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:55:51.623475 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m05:55:51.624275 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  create view "destination_db"."public"."film_ratings__dbt_tmp" as (
    WITH films_with_ratings as (
    SELECT film_id,
            title,
            release_date,
            price,
            rating,
            user_rating,
            CASE WHEN user_rating >= 4.5 THEN 'Excellent'
                 WHEN user_rating BETWEEN 4 AND 4.5 THEN 'Good'
                 WHEN user_rating BETWEEN 3 AND 4 THEN 'Average'
                 ELSE 'Bad' 
                 END as rating_category
    FROM "destination_db"."public"."films"

),
films_with_actors AS (
  SELECT
    f.film_id,
    f.title,
    STRING_AGG(a.actor_name, ',') AS actors
  FROM "destination_db"."public"."films" f
  LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
  LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
  GROUP BY f.film_id, f.title
)

SELECT fwr.*,
       fwa.actors
FROM films_with_ratings fwr
LEFT JOIN films_with_actors fwa
ON fwr.film_id = fwa. film_id
  );
[0m05:55:51.631309 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 16:     FROM "destination_db"."public"."films"
                  ^

[0m05:55:51.632062 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m05:55:51.635211 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-10-25 05:55:51.600665 => 2024-10-25 05:55:51.635126
[0m05:55:51.636231 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m05:55:51.645546 [debug] [Thread-1 (]: Database Error in model film_ratings (models/film_ratings.sql)
  relation "public.films" does not exist
  LINE 16:     FROM "destination_db"."public"."films"
                    ^
  compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m05:55:51.647688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd961516-c5d5-4ae3-ae3d-b29155ed9ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f67eeb60>]}
[0m05:55:51.649565 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model public.film_ratings ....................... [[31mERROR[0m in 0.06s]
[0m05:55:51.650964 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m05:55:51.654653 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:55:51.656014 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:51.657704 [debug] [MainThread]: On master: BEGIN
[0m05:55:51.659289 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:55:51.674435 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:55:51.675561 [debug] [MainThread]: On master: COMMIT
[0m05:55:51.676502 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:51.677318 [debug] [MainThread]: On master: COMMIT
[0m05:55:51.679233 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:55:51.679864 [debug] [MainThread]: On master: Close
[0m05:55:51.681461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:55:51.682223 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m05:55:51.683050 [info ] [MainThread]: 
[0m05:55:51.684152 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m05:55:51.685153 [debug] [MainThread]: Command end result
[0m05:55:51.698282 [info ] [MainThread]: 
[0m05:55:51.699522 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:55:51.700366 [info ] [MainThread]: 
[0m05:55:51.701237 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/film_ratings.sql)[0m
[0m05:55:51.702038 [error] [MainThread]:   relation "public.films" does not exist
[0m05:55:51.702859 [error] [MainThread]:   LINE 16:     FROM "destination_db"."public"."films"
[0m05:55:51.703701 [error] [MainThread]:                     ^
[0m05:55:51.704520 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m05:55:51.705415 [info ] [MainThread]: 
[0m05:55:51.706121 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m05:55:51.707369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f681b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f68132b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f6812dd0>]}
[0m05:55:51.708334 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 05:57:53.324266 | 076c040a-ea20-4e7e-a824-be54c71f4f31 ==============================
[0m05:57:53.324266 [info ] [MainThread]: Running with dbt=1.4.7
[0m05:57:53.326400 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:57:53.327145 [debug] [MainThread]: Tracking: tracking
[0m05:57:53.334900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf21ba50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf21ba57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf21ba5390>]}
[0m05:57:53.358699 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m05:57:53.525619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:57:53.526566 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:57:53.527635 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m05:57:53.535917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '076c040a-ea20-4e7e-a824-be54c71f4f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf202dc0d0>]}
[0m05:57:53.554201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '076c040a-ea20-4e7e-a824-be54c71f4f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf202a51e0>]}
[0m05:57:53.554980 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m05:57:53.556274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '076c040a-ea20-4e7e-a824-be54c71f4f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf202a5240>]}
[0m05:57:53.558403 [info ] [MainThread]: 
[0m05:57:53.561228 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:57:53.562931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m05:57:53.572593 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m05:57:53.574769 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m05:57:53.576338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:57:53.613415 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m05:57:53.615999 [debug] [ThreadPool]: On list_destination_db: Close
[0m05:57:53.618780 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m05:57:53.624392 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m05:57:53.625521 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m05:57:53.626521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:57:53.641815 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:57:53.643534 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m05:57:53.644480 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m05:57:53.648031 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m05:57:53.649678 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m05:57:53.651549 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m05:57:53.656491 [debug] [MainThread]: Using postgres connection "master"
[0m05:57:53.657452 [debug] [MainThread]: On master: BEGIN
[0m05:57:53.658383 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:57:53.672665 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:57:53.674241 [debug] [MainThread]: Using postgres connection "master"
[0m05:57:53.675068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:57:53.679300 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m05:57:53.680996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '076c040a-ea20-4e7e-a824-be54c71f4f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf202a4040>]}
[0m05:57:53.681893 [debug] [MainThread]: On master: ROLLBACK
[0m05:57:53.683655 [debug] [MainThread]: Using postgres connection "master"
[0m05:57:53.684483 [debug] [MainThread]: On master: BEGIN
[0m05:57:53.687061 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:57:53.688010 [debug] [MainThread]: On master: COMMIT
[0m05:57:53.688793 [debug] [MainThread]: Using postgres connection "master"
[0m05:57:53.689598 [debug] [MainThread]: On master: COMMIT
[0m05:57:53.691583 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:57:53.692501 [debug] [MainThread]: On master: Close
[0m05:57:53.693643 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:57:53.694493 [info ] [MainThread]: 
[0m05:57:53.709495 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m05:57:53.711954 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m05:57:53.713788 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m05:57:53.715183 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m05:57:53.718674 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m05:57:53.738429 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 05:57:53.716868 => 2024-10-25 05:57:53.738317
[0m05:57:53.739505 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m05:57:53.766587 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m05:57:53.792963 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:57:53.795683 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m05:57:53.798471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:57:53.820189 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:57:53.821148 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m05:57:53.821799 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m05:57:53.826378 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m05:57:53.827820 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m05:57:53.830229 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 05:57:53.741388 => 2024-10-25 05:57:53.830150
[0m05:57:53.831457 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m05:57:53.840242 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m05:57:53.843319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '076c040a-ea20-4e7e-a824-be54c71f4f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf20172b30>]}
[0m05:57:53.845464 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.13s]
[0m05:57:53.848141 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m05:57:53.849831 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m05:57:53.850960 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m05:57:53.852114 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m05:57:53.853229 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m05:57:53.857825 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m05:57:53.873149 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 05:57:53.854899 => 2024-10-25 05:57:53.873049
[0m05:57:53.875332 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m05:57:53.879456 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m05:57:53.897003 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:57:53.898165 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m05:57:53.899894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:57:53.918181 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:57:53.919514 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m05:57:53.921168 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m05:57:53.925272 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m05:57:53.926391 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m05:57:53.928740 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 05:57:53.876702 => 2024-10-25 05:57:53.928632
[0m05:57:53.930236 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m05:57:53.931907 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m05:57:53.933093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '076c040a-ea20-4e7e-a824-be54c71f4f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf201727a0>]}
[0m05:57:53.934179 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.08s]
[0m05:57:53.935803 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m05:57:53.937434 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m05:57:53.939633 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m05:57:53.941254 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m05:57:53.942577 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m05:57:53.946831 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m05:57:53.966409 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 05:57:53.944502 => 2024-10-25 05:57:53.966316
[0m05:57:53.968468 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m05:57:53.974221 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m05:57:53.993248 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:57:53.995559 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m05:57:53.997371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:57:54.014284 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:57:54.015468 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m05:57:54.016936 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m05:57:54.019791 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m05:57:54.020645 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m05:57:54.022518 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 05:57:53.970717 => 2024-10-25 05:57:54.022440
[0m05:57:54.023478 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m05:57:54.025871 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m05:57:54.027419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '076c040a-ea20-4e7e-a824-be54c71f4f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf20136ce0>]}
[0m05:57:54.028846 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.09s]
[0m05:57:54.029797 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m05:57:54.031454 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m05:57:54.032871 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m05:57:54.033920 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m05:57:54.036166 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:57:54.037628 [debug] [MainThread]: Using postgres connection "master"
[0m05:57:54.038820 [debug] [MainThread]: On master: BEGIN
[0m05:57:54.039762 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:57:54.056436 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:57:54.057730 [debug] [MainThread]: On master: COMMIT
[0m05:57:54.058791 [debug] [MainThread]: Using postgres connection "master"
[0m05:57:54.059650 [debug] [MainThread]: On master: COMMIT
[0m05:57:54.061710 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:57:54.062600 [debug] [MainThread]: On master: Close
[0m05:57:54.063784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:57:54.064623 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m05:57:54.065674 [info ] [MainThread]: 
[0m05:57:54.066589 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m05:57:54.067641 [debug] [MainThread]: Command end result
[0m05:57:54.084654 [info ] [MainThread]: 
[0m05:57:54.086093 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m05:57:54.087140 [info ] [MainThread]: 
[0m05:57:54.088261 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m05:57:54.089398 [error] [MainThread]:   relation "public.actors" does not exist
[0m05:57:54.090928 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m05:57:54.092092 [error] [MainThread]:                             ^
[0m05:57:54.093065 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m05:57:54.093952 [info ] [MainThread]: 
[0m05:57:54.094771 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m05:57:54.095717 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m05:57:54.096695 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m05:57:54.097601 [error] [MainThread]:                             ^
[0m05:57:54.098764 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m05:57:54.099831 [info ] [MainThread]: 
[0m05:57:54.100643 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m05:57:54.101518 [error] [MainThread]:   relation "public.films" does not exist
[0m05:57:54.102537 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m05:57:54.103295 [error] [MainThread]:                             ^
[0m05:57:54.104231 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m05:57:54.105045 [info ] [MainThread]: 
[0m05:57:54.105854 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m05:57:54.106806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf201246d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf20171ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf20171bd0>]}
[0m05:57:54.107696 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 06:14:38.890233 | f66f49aa-3cdb-43fa-8613-1388c18f4d59 ==============================
[0m06:14:38.890233 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:14:38.893280 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:14:38.894658 [debug] [MainThread]: Tracking: tracking
[0m06:14:38.906963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae16690f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae16697b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae1669390>]}
[0m06:14:38.935684 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:14:39.196705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:14:39.198159 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/schema.yml
[0m06:14:39.216550 [debug] [MainThread]: 1699: static parser successfully parsed film_actors.sql
[0m06:14:39.230249 [debug] [MainThread]: 1699: static parser successfully parsed films.sql
[0m06:14:39.233794 [debug] [MainThread]: 1699: static parser successfully parsed actors.sql
[0m06:14:39.325166 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m06:14:39.331578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f66f49aa-3cdb-43fa-8613-1388c18f4d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adfd8ae60>]}
[0m06:14:39.361895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f66f49aa-3cdb-43fa-8613-1388c18f4d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae164e9e0>]}
[0m06:14:39.363017 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:14:39.364643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66f49aa-3cdb-43fa-8613-1388c18f4d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae164c2b0>]}
[0m06:14:39.367713 [info ] [MainThread]: 
[0m06:14:39.371023 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:14:39.373116 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:14:39.389345 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:14:39.390926 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:14:39.392679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:39.432570 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:14:39.435584 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:14:39.438489 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:14:39.445643 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:14:39.447557 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:14:39.448959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:14:39.466194 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:14:39.467347 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:14:39.468413 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:14:39.472904 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m06:14:39.474657 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:14:39.476732 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:14:39.482855 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:39.484220 [debug] [MainThread]: On master: BEGIN
[0m06:14:39.485392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:14:39.501119 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:14:39.502142 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:39.503098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:14:39.508119 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:14:39.510018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66f49aa-3cdb-43fa-8613-1388c18f4d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5addc3eec0>]}
[0m06:14:39.511396 [debug] [MainThread]: On master: ROLLBACK
[0m06:14:39.514519 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:39.515661 [debug] [MainThread]: On master: BEGIN
[0m06:14:39.519350 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:14:39.520409 [debug] [MainThread]: On master: COMMIT
[0m06:14:39.521309 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:39.522206 [debug] [MainThread]: On master: COMMIT
[0m06:14:39.524730 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:14:39.525852 [debug] [MainThread]: On master: Close
[0m06:14:39.527084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:14:39.528065 [info ] [MainThread]: 
[0m06:14:39.547570 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:14:39.549117 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m06:14:39.550970 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:14:39.552826 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:14:39.556876 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:14:39.573674 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 06:14:39.554709 => 2024-10-25 06:14:39.573498
[0m06:14:39.575378 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:14:39.606134 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:14:39.624753 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:14:39.626490 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:14:39.627856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:39.642185 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:14:39.643375 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:14:39.644191 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m06:14:39.647088 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m06:14:39.648502 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m06:14:39.650815 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 06:14:39.576562 => 2024-10-25 06:14:39.650729
[0m06:14:39.651695 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:14:39.659793 [debug] [Thread-1 (]: Database Error in model actors (models/actors.sql)
  relation "public.actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/actors.sql
[0m06:14:39.661162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f49aa-3cdb-43fa-8613-1388c18f4d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5addc86e90>]}
[0m06:14:39.662323 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.actors ............................. [[31mERROR[0m in 0.11s]
[0m06:14:39.664618 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:14:39.666159 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:14:39.667370 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m06:14:39.668811 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:14:39.669969 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:14:39.673808 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:14:39.690628 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 06:14:39.671038 => 2024-10-25 06:14:39.690514
[0m06:14:39.692366 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:14:39.696378 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:14:39.709583 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:14:39.710925 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:14:39.712300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:39.729084 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:14:39.730052 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:14:39.730896 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m06:14:39.734721 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m06:14:39.736200 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m06:14:39.738546 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 06:14:39.693571 => 2024-10-25 06:14:39.738457
[0m06:14:39.739636 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:14:39.741870 [debug] [Thread-1 (]: Database Error in model film_actors (models/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m06:14:39.743246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f49aa-3cdb-43fa-8613-1388c18f4d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5addc7c2e0>]}
[0m06:14:39.744316 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.film_actors ........................ [[31mERROR[0m in 0.07s]
[0m06:14:39.745461 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:14:39.746355 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:14:39.747463 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m06:14:39.748693 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:14:39.749690 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:14:39.753763 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:14:39.766754 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 06:14:39.750630 => 2024-10-25 06:14:39.766591
[0m06:14:39.768187 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:14:39.773789 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:14:39.792171 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:14:39.793758 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:14:39.795884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:39.813235 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:14:39.814210 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:14:39.816809 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m06:14:39.819623 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 4:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m06:14:39.821373 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m06:14:39.823368 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 06:14:39.770141 => 2024-10-25 06:14:39.823298
[0m06:14:39.824275 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:14:39.825632 [debug] [Thread-1 (]: Database Error in model films (models/films.sql)
  relation "public.films" does not exist
  LINE 4:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/films.sql
[0m06:14:39.826688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f49aa-3cdb-43fa-8613-1388c18f4d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adc320910>]}
[0m06:14:39.828084 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.films .............................. [[31mERROR[0m in 0.08s]
[0m06:14:39.829706 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:14:39.831594 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:14:39.832627 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m06:14:39.834086 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:14:39.836119 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:14:39.837615 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:39.839094 [debug] [MainThread]: On master: BEGIN
[0m06:14:39.840417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:14:39.856044 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:14:39.857407 [debug] [MainThread]: On master: COMMIT
[0m06:14:39.858680 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:39.859442 [debug] [MainThread]: On master: COMMIT
[0m06:14:39.861532 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:14:39.862516 [debug] [MainThread]: On master: Close
[0m06:14:39.863617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:14:39.864517 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m06:14:39.865300 [info ] [MainThread]: 
[0m06:14:39.867374 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m06:14:39.870333 [debug] [MainThread]: Command end result
[0m06:14:39.885528 [info ] [MainThread]: 
[0m06:14:39.886661 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m06:14:39.887601 [info ] [MainThread]: 
[0m06:14:39.888695 [error] [MainThread]: [33mDatabase Error in model actors (models/actors.sql)[0m
[0m06:14:39.889689 [error] [MainThread]:   relation "public.actors" does not exist
[0m06:14:39.890558 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."actors"
[0m06:14:39.891449 [error] [MainThread]:                             ^
[0m06:14:39.892344 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/actors.sql
[0m06:14:39.893582 [info ] [MainThread]: 
[0m06:14:39.894893 [error] [MainThread]: [33mDatabase Error in model film_actors (models/film_actors.sql)[0m
[0m06:14:39.895974 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m06:14:39.897068 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."film_actors"
[0m06:14:39.898365 [error] [MainThread]:                             ^
[0m06:14:39.899389 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_actors.sql
[0m06:14:39.900474 [info ] [MainThread]: 
[0m06:14:39.901451 [error] [MainThread]: [33mDatabase Error in model films (models/films.sql)[0m
[0m06:14:39.902459 [error] [MainThread]:   relation "public.films" does not exist
[0m06:14:39.903484 [error] [MainThread]:   LINE 4:     SELECT * FROM "destination_db"."public"."films"
[0m06:14:39.904372 [error] [MainThread]:                             ^
[0m06:14:39.905437 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/films.sql
[0m06:14:39.906921 [info ] [MainThread]: 
[0m06:14:39.908642 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m06:14:39.909675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae2f897b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adc320a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adc321480>]}
[0m06:14:39.910820 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 06:22:15.869358 | 158875c0-5df5-42e4-b68c-61fad4ed2aa0 ==============================
[0m06:22:15.869358 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:22:15.871595 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:22:15.872644 [debug] [MainThread]: Tracking: tracking
[0m06:22:15.879046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeaba5360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeaba57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeaba53c0>]}
[0m06:22:15.896930 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:22:16.035674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:22:16.036890 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:22:16.037857 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m06:22:16.045326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '158875c0-5df5-42e4-b68c-61fad4ed2aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae92e0af0>]}
[0m06:22:16.076929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '158875c0-5df5-42e4-b68c-61fad4ed2aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae941a0e0>]}
[0m06:22:16.078530 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:22:16.079854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '158875c0-5df5-42e4-b68c-61fad4ed2aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae941a140>]}
[0m06:22:16.082280 [info ] [MainThread]: 
[0m06:22:16.085155 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:22:16.087788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:22:16.097946 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:22:16.099917 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:22:16.101906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:22:16.133295 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:22:16.135320 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:22:16.137726 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:22:16.143300 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:22:16.144834 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:22:16.145768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:22:16.159402 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:22:16.160401 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:22:16.161312 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:22:16.164603 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m06:22:16.166266 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:22:16.168203 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:22:16.174912 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:16.176202 [debug] [MainThread]: On master: BEGIN
[0m06:22:16.177105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:22:16.189876 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:22:16.190838 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:16.191746 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:22:16.196561 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:22:16.198164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '158875c0-5df5-42e4-b68c-61fad4ed2aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae93238b0>]}
[0m06:22:16.199252 [debug] [MainThread]: On master: ROLLBACK
[0m06:22:16.201622 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:16.202529 [debug] [MainThread]: On master: BEGIN
[0m06:22:16.206417 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:22:16.207471 [debug] [MainThread]: On master: COMMIT
[0m06:22:16.208491 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:16.209534 [debug] [MainThread]: On master: COMMIT
[0m06:22:16.212530 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:22:16.213524 [debug] [MainThread]: On master: Close
[0m06:22:16.214647 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:22:16.215675 [info ] [MainThread]: 
[0m06:22:16.232117 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:22:16.233838 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m06:22:16.235259 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:22:16.236944 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:22:16.241460 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:22:16.256741 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 06:22:16.238676 => 2024-10-25 06:22:16.256638
[0m06:22:16.258197 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:22:16.294479 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:22:16.310779 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:22:16.312136 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:22:16.313110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:16.329543 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:22:16.330821 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:22:16.331805 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m06:22:16.334414 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:22:16.341989 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:22:16.343446 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:22:16.346703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:22:16.350280 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:22:16.351189 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:22:16.353757 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:22:16.369868 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:22:16.371920 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:22:16.373512 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:22:16.378141 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:22:16.383171 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:22:16.384029 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:22:16.388759 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:22:16.390886 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 06:22:16.259673 => 2024-10-25 06:22:16.390833
[0m06:22:16.392182 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:22:16.393627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '158875c0-5df5-42e4-b68c-61fad4ed2aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae919d570>]}
[0m06:22:16.394564 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.actors ................................. [[32mCREATE VIEW[0m in 0.16s]
[0m06:22:16.396590 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:22:16.397744 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:22:16.398649 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m06:22:16.399816 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:22:16.400801 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:22:16.403768 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:22:16.411317 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 06:22:16.401612 => 2024-10-25 06:22:16.411194
[0m06:22:16.412417 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:22:16.416719 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:22:16.422613 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:22:16.423387 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:22:16.424011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:16.437775 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:22:16.438707 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:22:16.439541 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m06:22:16.442334 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:22:16.445809 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:22:16.446746 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:22:16.448677 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:22:16.452074 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:22:16.452936 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:22:16.454950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:22:16.458055 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:22:16.458977 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:22:16.459639 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:22:16.463021 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:22:16.465714 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:22:16.466549 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:22:16.470203 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:22:16.472079 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 06:22:16.413260 => 2024-10-25 06:22:16.472037
[0m06:22:16.473027 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:22:16.474653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '158875c0-5df5-42e4-b68c-61fad4ed2aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae91e4e50>]}
[0m06:22:16.476049 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.film_actors ............................ [[32mCREATE VIEW[0m in 0.08s]
[0m06:22:16.477651 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:22:16.478511 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:22:16.479326 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m06:22:16.480507 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:22:16.481367 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:22:16.484524 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:22:16.491078 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 06:22:16.482156 => 2024-10-25 06:22:16.490990
[0m06:22:16.491933 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:22:16.496696 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:22:16.504260 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:22:16.505244 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:22:16.505992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:16.520253 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:22:16.521340 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:22:16.522158 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m06:22:16.525653 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:22:16.528894 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:22:16.529809 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:22:16.532255 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:22:16.535344 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:22:16.536274 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:22:16.538199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:22:16.540313 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:22:16.541306 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:22:16.542107 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:22:16.545554 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:22:16.548214 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:22:16.549194 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:22:16.553366 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:22:16.555147 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 06:22:16.492661 => 2024-10-25 06:22:16.555104
[0m06:22:16.556076 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:22:16.557091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '158875c0-5df5-42e4-b68c-61fad4ed2aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae91e6f80>]}
[0m06:22:16.558278 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.films .................................. [[32mCREATE VIEW[0m in 0.08s]
[0m06:22:16.559579 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:22:16.560841 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:22:16.561790 [info ] [Thread-1 (]: 4 of 4 START sql view model public.film_ratings ................................ [RUN]
[0m06:22:16.563070 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m06:22:16.563887 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:22:16.567731 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:22:16.574704 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-10-25 06:22:16.564651 => 2024-10-25 06:22:16.574587
[0m06:22:16.575807 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:22:16.580100 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:22:16.586338 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:22:16.587149 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:22:16.587921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:16.599594 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:22:16.600680 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:22:16.601614 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  create view "destination_db"."public"."film_ratings__dbt_tmp" as (
    WITH films_with_ratings as (
    SELECT film_id,
            title,
            release_date,
            price,
            rating,
            user_rating,
            CASE WHEN user_rating >= 4.5 THEN 'Excellent'
                 WHEN user_rating BETWEEN 4 AND 4.5 THEN 'Good'
                 WHEN user_rating BETWEEN 3 AND 4 THEN 'Average'
                 ELSE 'Bad' 
                 END as rating_category
    FROM "destination_db"."public"."films"

),
films_with_actors AS (
  SELECT
    f.film_id,
    f.title,
    STRING_AGG(a.actor_name, ',') AS actors
  FROM "destination_db"."public"."films" f
  LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
  LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
  GROUP BY f.film_id, f.title
)

SELECT fwr.*,
       fwa.actors
FROM films_with_ratings fwr
LEFT JOIN films_with_actors fwa
ON fwr.film_id = fwa. film_id
  );
[0m06:22:16.604900 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 16:     FROM "destination_db"."public"."films"
                  ^

[0m06:22:16.608500 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m06:22:16.613262 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-10-25 06:22:16.576573 => 2024-10-25 06:22:16.613167
[0m06:22:16.614226 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:22:16.624439 [debug] [Thread-1 (]: Database Error in model film_ratings (models/film_ratings.sql)
  relation "public.films" does not exist
  LINE 16:     FROM "destination_db"."public"."films"
                    ^
  compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m06:22:16.625743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '158875c0-5df5-42e4-b68c-61fad4ed2aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae91cc700>]}
[0m06:22:16.627710 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model public.film_ratings ....................... [[31mERROR[0m in 0.06s]
[0m06:22:16.628921 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:22:16.631180 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:22:16.632484 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:16.633920 [debug] [MainThread]: On master: BEGIN
[0m06:22:16.635274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:22:16.652311 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:22:16.653909 [debug] [MainThread]: On master: COMMIT
[0m06:22:16.654986 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:16.655918 [debug] [MainThread]: On master: COMMIT
[0m06:22:16.658301 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:22:16.659300 [debug] [MainThread]: On master: Close
[0m06:22:16.660769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:22:16.661732 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m06:22:16.662714 [info ] [MainThread]: 
[0m06:22:16.663482 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m06:22:16.664623 [debug] [MainThread]: Command end result
[0m06:22:16.681326 [info ] [MainThread]: 
[0m06:22:16.682328 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:22:16.683380 [info ] [MainThread]: 
[0m06:22:16.684338 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/film_ratings.sql)[0m
[0m06:22:16.685160 [error] [MainThread]:   relation "public.films" does not exist
[0m06:22:16.686010 [error] [MainThread]:   LINE 16:     FROM "destination_db"."public"."films"
[0m06:22:16.687009 [error] [MainThread]:                     ^
[0m06:22:16.688039 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m06:22:16.689027 [info ] [MainThread]: 
[0m06:22:16.690101 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:22:16.691684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae9419030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae9419cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae9419060>]}
[0m06:22:16.692969 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 06:23:28.129155 | e0fc66cd-1b7f-45e3-8632-b63cd10736c8 ==============================
[0m06:23:28.129155 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:23:28.131688 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:23:28.132808 [debug] [MainThread]: Tracking: tracking
[0m06:23:28.141725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5900135360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59001357e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59001353c0>]}
[0m06:23:28.162659 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:23:28.338225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:23:28.339347 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:23:28.340530 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m06:23:28.349631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0fc66cd-1b7f-45e3-8632-b63cd10736c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58fe87cb80>]}
[0m06:23:28.381608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0fc66cd-1b7f-45e3-8632-b63cd10736c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58fe7b6170>]}
[0m06:23:28.382599 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:23:28.383891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0fc66cd-1b7f-45e3-8632-b63cd10736c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58fe7b61d0>]}
[0m06:23:28.386386 [info ] [MainThread]: 
[0m06:23:28.389332 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:23:28.394664 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:23:28.408068 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:23:28.410400 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:23:28.412144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:23:28.446685 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:23:28.449064 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:23:28.452086 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:23:28.458663 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:23:28.460165 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:23:28.461286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:23:28.482935 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:23:28.484356 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:23:28.485644 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:23:28.492760 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m06:23:28.495182 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:23:28.498252 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:23:28.505207 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:28.506420 [debug] [MainThread]: On master: BEGIN
[0m06:23:28.507519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:23:28.524274 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:23:28.525341 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:28.526652 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:23:28.539903 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:23:28.542706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0fc66cd-1b7f-45e3-8632-b63cd10736c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58fe6c38b0>]}
[0m06:23:28.545027 [debug] [MainThread]: On master: ROLLBACK
[0m06:23:28.548734 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:28.549965 [debug] [MainThread]: On master: BEGIN
[0m06:23:28.552678 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:23:28.553444 [debug] [MainThread]: On master: COMMIT
[0m06:23:28.554282 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:28.555094 [debug] [MainThread]: On master: COMMIT
[0m06:23:28.557157 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:23:28.558280 [debug] [MainThread]: On master: Close
[0m06:23:28.559858 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:23:28.560795 [info ] [MainThread]: 
[0m06:23:28.580815 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:23:28.582604 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m06:23:28.584047 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:23:28.585305 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:23:28.589076 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:23:28.606146 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 06:23:28.586726 => 2024-10-25 06:23:28.605994
[0m06:23:28.608064 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:23:28.641748 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:23:28.654568 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:23:28.655712 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:23:28.656526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:28.671548 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:23:28.672432 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:23:28.673487 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m06:23:28.677170 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:23:28.683646 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:23:28.685011 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:23:28.687896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:23:28.691631 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:23:28.692598 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:23:28.695252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:23:28.710326 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:23:28.712835 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:23:28.715462 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:23:28.722544 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:23:28.727831 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:23:28.728965 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:23:28.735459 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:23:28.738344 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 06:23:28.609611 => 2024-10-25 06:23:28.738265
[0m06:23:28.739361 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:23:28.740848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fc66cd-1b7f-45e3-8632-b63cd10736c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58fe7394e0>]}
[0m06:23:28.742747 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.actors ................................. [[32mCREATE VIEW[0m in 0.16s]
[0m06:23:28.745575 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:23:28.746656 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:23:28.748054 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m06:23:28.749408 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:23:28.750516 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:23:28.754424 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:23:28.768262 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 06:23:28.751277 => 2024-10-25 06:23:28.768149
[0m06:23:28.769817 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:23:28.775389 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:23:28.793500 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:23:28.795742 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:23:28.797409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:28.814845 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:23:28.816362 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:23:28.817575 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m06:23:28.820977 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:23:28.824716 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:23:28.826082 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:23:28.828823 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:23:28.832593 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:23:28.833775 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:23:28.836491 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:23:28.840825 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:23:28.841947 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:23:28.842967 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:23:28.846767 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:23:28.849469 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:23:28.850437 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:23:28.855116 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:23:28.857133 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 06:23:28.770943 => 2024-10-25 06:23:28.857080
[0m06:23:28.858147 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:23:28.859456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fc66cd-1b7f-45e3-8632-b63cd10736c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58fe780ee0>]}
[0m06:23:28.860499 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.film_actors ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m06:23:28.861384 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:23:28.862233 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:23:28.863184 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m06:23:28.864454 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:23:28.865343 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:23:28.868489 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:23:28.875087 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 06:23:28.866218 => 2024-10-25 06:23:28.874987
[0m06:23:28.876025 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:23:28.880205 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:23:28.886211 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:23:28.887049 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:23:28.887963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:28.904509 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:23:28.905770 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:23:28.906716 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m06:23:28.910450 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:23:28.913769 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:23:28.914921 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:23:28.917270 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:23:28.920064 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:23:28.920895 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:23:28.923161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:23:28.925758 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:23:28.926677 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:23:28.927506 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:23:28.930441 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:23:28.933313 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:23:28.934076 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:23:28.938123 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:23:28.940503 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 06:23:28.876788 => 2024-10-25 06:23:28.940453
[0m06:23:28.941432 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:23:28.942795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fc66cd-1b7f-45e3-8632-b63cd10736c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58fe781c60>]}
[0m06:23:28.943801 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.films .................................. [[32mCREATE VIEW[0m in 0.08s]
[0m06:23:28.944791 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:23:28.946214 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:23:28.946999 [info ] [Thread-1 (]: 4 of 4 START sql view model public.film_ratings ................................ [RUN]
[0m06:23:28.948093 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m06:23:28.948918 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:23:28.953040 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:23:28.961276 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-10-25 06:23:28.949735 => 2024-10-25 06:23:28.961127
[0m06:23:28.962442 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:23:28.966634 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:23:28.973892 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:23:28.974776 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:23:28.975730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:28.988607 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:23:28.989606 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:23:28.990450 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  create view "destination_db"."public"."film_ratings__dbt_tmp" as (
    WITH films_with_ratings as (
    SELECT film_id,
            title,
            release_date,
            price,
            rating,
            user_rating,
            CASE WHEN user_rating >= 4.5 THEN 'Excellent'
                 WHEN user_rating BETWEEN 4 AND 4.5 THEN 'Good'
                 WHEN user_rating BETWEEN 3 AND 4 THEN 'Average'
                 ELSE 'Bad' 
                 END as rating_category
    FROM "destination_db"."public"."films"

),
films_with_actors AS (
  SELECT
    f.film_id,
    f.title,
    STRING_AGG(a.actor_name, ',') AS actors
  FROM "destination_db"."public"."films" f
  LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
  LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
  GROUP BY f.film_id, f.title
)

SELECT fwr.*,
       fwa.actors
FROM films_with_ratings fwr
LEFT JOIN films_with_actors fwa
ON fwr.film_id = fwa. film_id
  );
[0m06:23:28.993336 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 16:     FROM "destination_db"."public"."films"
                  ^

[0m06:23:28.995669 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m06:23:28.998924 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-10-25 06:23:28.963247 => 2024-10-25 06:23:28.998811
[0m06:23:28.999930 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:23:29.009582 [debug] [Thread-1 (]: Database Error in model film_ratings (models/film_ratings.sql)
  relation "public.films" does not exist
  LINE 16:     FROM "destination_db"."public"."films"
                    ^
  compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m06:23:29.011490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fc66cd-1b7f-45e3-8632-b63cd10736c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58fe76c790>]}
[0m06:23:29.013761 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model public.film_ratings ....................... [[31mERROR[0m in 0.06s]
[0m06:23:29.015306 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:23:29.018326 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:23:29.019680 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:29.021986 [debug] [MainThread]: On master: BEGIN
[0m06:23:29.023457 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:23:29.049226 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:23:29.050600 [debug] [MainThread]: On master: COMMIT
[0m06:23:29.052082 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:29.053777 [debug] [MainThread]: On master: COMMIT
[0m06:23:29.056844 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:23:29.058416 [debug] [MainThread]: On master: Close
[0m06:23:29.060133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:23:29.061024 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m06:23:29.062315 [info ] [MainThread]: 
[0m06:23:29.063183 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m06:23:29.064342 [debug] [MainThread]: Command end result
[0m06:23:29.087720 [info ] [MainThread]: 
[0m06:23:29.089404 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:23:29.091340 [info ] [MainThread]: 
[0m06:23:29.092474 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/film_ratings.sql)[0m
[0m06:23:29.093457 [error] [MainThread]:   relation "public.films" does not exist
[0m06:23:29.094379 [error] [MainThread]:   LINE 16:     FROM "destination_db"."public"."films"
[0m06:23:29.095396 [error] [MainThread]:                     ^
[0m06:23:29.096732 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m06:23:29.097900 [info ] [MainThread]: 
[0m06:23:29.098846 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:23:29.099874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58fe7b4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58fe7b5d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58fe7b4d30>]}
[0m06:23:29.100860 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 06:39:35.260870 | 9090f7c0-a603-4aa7-842f-9d76bb84e0c6 ==============================
[0m06:39:35.260870 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:39:35.264123 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:39:35.266669 [debug] [MainThread]: Tracking: tracking
[0m06:39:35.289887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab0c510f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab0c517b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab0c51390>]}
[0m06:39:35.317844 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:39:35.354249 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m06:39:35.356107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9090f7c0-a603-4aa7-842f-9d76bb84e0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab0c53f70>]}
[0m06:39:36.051455 [debug] [MainThread]: 1699: static parser successfully parsed actors.sql
[0m06:39:36.062431 [debug] [MainThread]: 1699: static parser successfully parsed films.sql
[0m06:39:36.067055 [debug] [MainThread]: 1699: static parser successfully parsed film_actors.sql
[0m06:39:36.084680 [debug] [MainThread]: 1699: static parser successfully parsed film_ratings.sql
[0m06:39:36.246430 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m06:39:36.253775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9090f7c0-a603-4aa7-842f-9d76bb84e0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aaf39c730>]}
[0m06:39:36.280844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9090f7c0-a603-4aa7-842f-9d76bb84e0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab0c51450>]}
[0m06:39:36.282918 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:39:36.284314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9090f7c0-a603-4aa7-842f-9d76bb84e0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aaf365a20>]}
[0m06:39:36.286965 [info ] [MainThread]: 
[0m06:39:36.290176 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:39:36.292624 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:39:36.304655 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:39:36.306291 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:39:36.307873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:36.395715 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:39:36.398891 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:39:36.401968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:39:36.408234 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:39:36.409837 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:39:36.411136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:39:36.429409 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:39:36.431014 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:39:36.431770 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:39:36.435753 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m06:39:36.438040 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:39:36.440807 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:39:36.447857 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:36.449756 [debug] [MainThread]: On master: BEGIN
[0m06:39:36.451086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:39:36.467890 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:39:36.469694 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:36.471078 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:39:36.476625 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:39:36.478510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9090f7c0-a603-4aa7-842f-9d76bb84e0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aaf375780>]}
[0m06:39:36.480227 [debug] [MainThread]: On master: ROLLBACK
[0m06:39:36.483663 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:36.484864 [debug] [MainThread]: On master: BEGIN
[0m06:39:36.488674 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:39:36.489747 [debug] [MainThread]: On master: COMMIT
[0m06:39:36.490875 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:36.491721 [debug] [MainThread]: On master: COMMIT
[0m06:39:36.493704 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:39:36.494790 [debug] [MainThread]: On master: Close
[0m06:39:36.496289 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:39:36.498390 [info ] [MainThread]: 
[0m06:39:36.515695 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:39:36.517707 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m06:39:36.519917 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:39:36.521148 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:39:36.524566 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:39:36.534538 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 06:39:36.522336 => 2024-10-25 06:39:36.534428
[0m06:39:36.536891 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:39:36.567901 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:39:36.583794 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:39:36.584782 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:39:36.585693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:36.599528 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:39:36.600447 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:39:36.601387 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m06:39:36.604289 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:39:36.610399 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:39:36.611764 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:39:36.614116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:39:36.617695 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:39:36.619041 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:39:36.621812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:39:36.637972 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:39:36.640167 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:39:36.641567 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:39:36.645524 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:39:36.650555 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:39:36.651787 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:39:36.657356 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:39:36.659123 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 06:39:36.539395 => 2024-10-25 06:39:36.659078
[0m06:39:36.660325 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:39:36.661567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9090f7c0-a603-4aa7-842f-9d76bb84e0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aad275e70>]}
[0m06:39:36.662591 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.actors ................................. [[32mCREATE VIEW[0m in 0.14s]
[0m06:39:36.664989 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:39:36.665998 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:39:36.667022 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m06:39:36.668266 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:39:36.669270 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:39:36.672304 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:39:36.678611 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 06:39:36.669925 => 2024-10-25 06:39:36.678502
[0m06:39:36.679491 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:39:36.684067 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:39:36.690839 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:39:36.691746 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:39:36.692480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:36.704925 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:39:36.706153 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:39:36.707089 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m06:39:36.709724 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:39:36.712794 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:39:36.713637 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:39:36.716215 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:39:36.719734 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:39:36.720678 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:39:36.723051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:39:36.725384 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:39:36.726258 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:39:36.726967 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:39:36.730022 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:39:36.733908 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:39:36.735281 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:39:36.739456 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:39:36.741376 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 06:39:36.680418 => 2024-10-25 06:39:36.741273
[0m06:39:36.744154 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:39:36.746187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9090f7c0-a603-4aa7-842f-9d76bb84e0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aac0be6e0>]}
[0m06:39:36.747729 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.film_actors ............................ [[32mCREATE VIEW[0m in 0.08s]
[0m06:39:36.749300 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:39:36.750683 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:39:36.751754 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m06:39:36.753115 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:39:36.755687 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:39:36.764826 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:39:36.786761 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 06:39:36.758322 => 2024-10-25 06:39:36.786624
[0m06:39:36.788317 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:39:36.792635 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:39:36.808105 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:39:36.809480 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:39:36.811281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:36.830763 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:39:36.832133 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:39:36.833278 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m06:39:36.836647 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:39:36.840670 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:39:36.842471 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:39:36.846036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:39:36.850425 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:39:36.852009 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:39:36.854732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:39:36.857260 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:39:36.858290 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:39:36.859333 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:39:36.862927 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:39:36.866050 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:39:36.867290 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:39:36.873122 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:39:36.875755 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 06:39:36.789293 => 2024-10-25 06:39:36.875707
[0m06:39:36.877496 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:39:36.879641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9090f7c0-a603-4aa7-842f-9d76bb84e0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aac0bf640>]}
[0m06:39:36.881153 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.films .................................. [[32mCREATE VIEW[0m in 0.13s]
[0m06:39:36.883068 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:39:36.885178 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:39:36.886275 [info ] [Thread-1 (]: 4 of 4 START sql view model public.film_ratings ................................ [RUN]
[0m06:39:36.887925 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m06:39:36.888962 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:39:36.893272 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:39:36.908029 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-10-25 06:39:36.890238 => 2024-10-25 06:39:36.907915
[0m06:39:36.909972 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:39:36.915432 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:39:36.929907 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:39:36.931640 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:39:36.932677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:36.952871 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:39:36.954578 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:39:36.955847 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  create view "destination_db"."public"."film_ratings__dbt_tmp" as (
    WITH films_with_ratings as (
    SELECT film_id,
            title,
            release_date,
            price,
            rating,
            user_rating,
            CASE WHEN user_rating >= 4.5 THEN 'Excellent'
                 WHEN user_rating BETWEEN 4 AND 4.5 THEN 'Good'
                 WHEN user_rating BETWEEN 3 AND 4 THEN 'Average'
                 ELSE 'Bad' 
                 END as rating_category
    FROM "destination_db"."public"."films"

),
films_with_actors AS (
  SELECT
    f.film_id,
    f.title,
    STRING_AGG(a.actor_name, ',') AS actors
  FROM "destination_db"."public"."films" f
  LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
  LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
  GROUP BY f.film_id, f.title
)

SELECT fwr.*,
       fwa.actors
FROM films_with_ratings fwr
LEFT JOIN films_with_actors fwa
ON fwr.film_id = fwa. film_id
  );
[0m06:39:36.960914 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 16:     FROM "destination_db"."public"."films"
                  ^

[0m06:39:36.964486 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m06:39:36.973481 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-10-25 06:39:36.911439 => 2024-10-25 06:39:36.973326
[0m06:39:36.975915 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:39:36.987931 [debug] [Thread-1 (]: Database Error in model film_ratings (models/film_ratings.sql)
  relation "public.films" does not exist
  LINE 16:     FROM "destination_db"."public"."films"
                    ^
  compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m06:39:36.990148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9090f7c0-a603-4aa7-842f-9d76bb84e0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aac0be800>]}
[0m06:39:36.992333 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model public.film_ratings ....................... [[31mERROR[0m in 0.10s]
[0m06:39:36.994379 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:39:36.997221 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:39:36.998718 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:37.000266 [debug] [MainThread]: On master: BEGIN
[0m06:39:37.001547 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:39:37.018090 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:39:37.019408 [debug] [MainThread]: On master: COMMIT
[0m06:39:37.020731 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:37.021904 [debug] [MainThread]: On master: COMMIT
[0m06:39:37.024293 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:39:37.025470 [debug] [MainThread]: On master: Close
[0m06:39:37.026942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:39:37.028267 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m06:39:37.029504 [info ] [MainThread]: 
[0m06:39:37.030804 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m06:39:37.032200 [debug] [MainThread]: Command end result
[0m06:39:37.052960 [info ] [MainThread]: 
[0m06:39:37.054870 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:39:37.056076 [info ] [MainThread]: 
[0m06:39:37.057266 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/film_ratings.sql)[0m
[0m06:39:37.058704 [error] [MainThread]:   relation "public.films" does not exist
[0m06:39:37.060010 [error] [MainThread]:   LINE 16:     FROM "destination_db"."public"."films"
[0m06:39:37.061078 [error] [MainThread]:                     ^
[0m06:39:37.061991 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m06:39:37.063520 [info ] [MainThread]: 
[0m06:39:37.065980 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:39:37.069180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aac0e6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aac0e6cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aac0e6740>]}
[0m06:39:37.071224 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 06:43:08.997493 | b557be21-72f8-4ea8-8128-5847817a0d74 ==============================
[0m06:43:08.997493 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:43:09.001083 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:43:09.001934 [debug] [MainThread]: Tracking: tracking
[0m06:43:09.014936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e142350f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e142357b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e14235390>]}
[0m06:43:09.031191 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:43:09.164077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:43:09.165269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:43:09.166637 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m06:43:09.175714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b557be21-72f8-4ea8-8128-5847817a0d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e12980a90>]}
[0m06:43:09.197803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b557be21-72f8-4ea8-8128-5847817a0d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e1293e050>]}
[0m06:43:09.198905 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:43:09.200169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b557be21-72f8-4ea8-8128-5847817a0d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e15b4bbe0>]}
[0m06:43:09.202318 [info ] [MainThread]: 
[0m06:43:09.205515 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:43:09.207496 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:43:09.219247 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:43:09.223505 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:43:09.226325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:09.258163 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:43:09.260083 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:43:09.262516 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:43:09.268781 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:43:09.269754 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:43:09.270472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:43:09.283309 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:43:09.284302 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:43:09.285217 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:43:09.294564 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m06:43:09.297690 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:43:09.301898 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:43:09.310187 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:09.312715 [debug] [MainThread]: On master: BEGIN
[0m06:43:09.314697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:43:09.331374 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:43:09.332841 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:09.334279 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:43:09.340210 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:43:09.342649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b557be21-72f8-4ea8-8128-5847817a0d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e127c78b0>]}
[0m06:43:09.344402 [debug] [MainThread]: On master: ROLLBACK
[0m06:43:09.347339 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:09.371960 [debug] [MainThread]: On master: BEGIN
[0m06:43:09.376954 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:43:09.378563 [debug] [MainThread]: On master: COMMIT
[0m06:43:09.379956 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:09.381032 [debug] [MainThread]: On master: COMMIT
[0m06:43:09.383017 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:43:09.384007 [debug] [MainThread]: On master: Close
[0m06:43:09.385423 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:43:09.387222 [info ] [MainThread]: 
[0m06:43:09.402262 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:43:09.403867 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m06:43:09.406642 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:43:09.407825 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:43:09.411270 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:43:09.424453 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 06:43:09.408730 => 2024-10-25 06:43:09.424334
[0m06:43:09.426027 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:43:09.460605 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:43:09.473723 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:09.475091 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:43:09.476154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:09.490421 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:43:09.491738 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:09.492964 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m06:43:09.496538 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:43:09.503300 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:09.504839 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:43:09.508072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:09.511854 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:09.513073 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:43:09.516054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:09.532046 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:43:09.534320 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:09.536086 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:43:09.540930 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:43:09.546347 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:09.548063 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:43:09.554276 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:43:09.556856 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 06:43:09.427159 => 2024-10-25 06:43:09.556802
[0m06:43:09.557908 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:43:09.559570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b557be21-72f8-4ea8-8128-5847817a0d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e12839540>]}
[0m06:43:09.560864 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.actors ................................. [[32mCREATE VIEW[0m in 0.15s]
[0m06:43:09.563611 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:43:09.564989 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:43:09.566136 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m06:43:09.567680 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:43:09.568887 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:43:09.571977 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:43:09.580519 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 06:43:09.569647 => 2024-10-25 06:43:09.580436
[0m06:43:09.581774 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:43:09.586061 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:43:09.594900 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:09.596181 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:43:09.597228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:09.611575 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:43:09.613051 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:09.614082 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m06:43:09.616982 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:43:09.620219 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:09.621853 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:43:09.624217 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:09.627844 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:09.628832 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:43:09.631212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:09.634625 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:43:09.635579 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:09.636500 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:43:09.641034 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:43:09.643826 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:09.644807 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:43:09.649153 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:43:09.651086 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 06:43:09.582740 => 2024-10-25 06:43:09.651042
[0m06:43:09.652158 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:43:09.653620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b557be21-72f8-4ea8-8128-5847817a0d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e12878e80>]}
[0m06:43:09.655049 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.film_actors ............................ [[32mCREATE VIEW[0m in 0.09s]
[0m06:43:09.656363 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:43:09.657367 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:43:09.658356 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m06:43:09.659820 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:43:09.661008 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:43:09.664357 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:43:09.705927 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 06:43:09.662269 => 2024-10-25 06:43:09.705775
[0m06:43:09.708219 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:43:09.717150 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:43:09.731285 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:09.733045 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:43:09.734454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:09.757993 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:43:09.759382 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:09.761194 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m06:43:09.766835 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:43:09.770761 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:09.772146 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:43:09.774983 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:09.778439 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:09.779937 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:43:09.783108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:09.786011 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:43:09.787419 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:09.788417 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:43:09.792848 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:43:09.796244 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:09.797713 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:43:09.802998 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:43:09.805234 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 06:43:09.712158 => 2024-10-25 06:43:09.805183
[0m06:43:09.806533 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:43:09.808158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b557be21-72f8-4ea8-8128-5847817a0d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e1287a470>]}
[0m06:43:09.809348 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.films .................................. [[32mCREATE VIEW[0m in 0.15s]
[0m06:43:09.810614 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:43:09.812813 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:43:09.814314 [info ] [Thread-1 (]: 4 of 4 START sql view model public.film_ratings ................................ [RUN]
[0m06:43:09.817091 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m06:43:09.818299 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:43:09.822785 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:43:09.833986 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-10-25 06:43:09.819213 => 2024-10-25 06:43:09.833874
[0m06:43:09.835469 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:43:09.842341 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:43:09.853148 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:43:09.854759 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:43:09.856618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:09.873016 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:43:09.874649 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:43:09.876035 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  create view "destination_db"."public"."film_ratings__dbt_tmp" as (
    WITH films_with_ratings as (
    SELECT film_id,
            title,
            release_date,
            price,
            rating,
            user_rating,
            CASE WHEN user_rating >= 4.5 THEN 'Excellent'
                 WHEN user_rating BETWEEN 4 AND 4.5 THEN 'Good'
                 WHEN user_rating BETWEEN 3 AND 4 THEN 'Average'
                 ELSE 'Bad' 
                 END as rating_category
    FROM "destination_db"."public"."films"

),
films_with_actors AS (
  SELECT
    f.film_id,
    f.title,
    STRING_AGG(a.actor_name, ',') AS actors
  FROM "destination_db"."public"."films" f
  LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
  LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
  GROUP BY f.film_id, f.title
)

SELECT fwr.*,
       fwa.actors
FROM films_with_ratings fwr
LEFT JOIN films_with_actors fwa
ON fwr.film_id = fwa. film_id
  );
[0m06:43:09.879358 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 16:     FROM "destination_db"."public"."films"
                  ^

[0m06:43:09.881392 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m06:43:09.884304 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-10-25 06:43:09.836603 => 2024-10-25 06:43:09.884171
[0m06:43:09.885728 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:43:09.893788 [debug] [Thread-1 (]: Database Error in model film_ratings (models/film_ratings.sql)
  relation "public.films" does not exist
  LINE 16:     FROM "destination_db"."public"."films"
                    ^
  compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m06:43:09.895401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b557be21-72f8-4ea8-8128-5847817a0d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e12884730>]}
[0m06:43:09.896731 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model public.film_ratings ....................... [[31mERROR[0m in 0.08s]
[0m06:43:09.898072 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:43:09.900515 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:43:09.901890 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:09.902976 [debug] [MainThread]: On master: BEGIN
[0m06:43:09.904163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:43:09.919911 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:43:09.921467 [debug] [MainThread]: On master: COMMIT
[0m06:43:09.922773 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:09.924398 [debug] [MainThread]: On master: COMMIT
[0m06:43:09.927216 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:43:09.928551 [debug] [MainThread]: On master: Close
[0m06:43:09.930366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:43:09.931578 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m06:43:09.932931 [info ] [MainThread]: 
[0m06:43:09.933980 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m06:43:09.935400 [debug] [MainThread]: Command end result
[0m06:43:09.960129 [info ] [MainThread]: 
[0m06:43:09.961839 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:43:09.963388 [info ] [MainThread]: 
[0m06:43:09.964741 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/film_ratings.sql)[0m
[0m06:43:09.967184 [error] [MainThread]:   relation "public.films" does not exist
[0m06:43:09.968798 [error] [MainThread]:   LINE 16:     FROM "destination_db"."public"."films"
[0m06:43:09.969785 [error] [MainThread]:                     ^
[0m06:43:09.971643 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m06:43:09.974897 [info ] [MainThread]: 
[0m06:43:09.976819 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:43:09.980116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e1293c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e1293dba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e1293dfc0>]}
[0m06:43:09.981646 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 06:46:42.626205 | 37a14b58-9209-4480-b8fb-5d2effbe4789 ==============================
[0m06:46:42.626205 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:46:42.630031 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:46:42.632645 [debug] [MainThread]: Tracking: tracking
[0m06:46:42.644350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb28790c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb2879780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb2879360>]}
[0m06:46:42.662983 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:46:42.879630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:46:42.886286 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/film_ratings.sql
[0m06:46:42.913114 [debug] [MainThread]: 1699: static parser successfully parsed film_ratings.sql
[0m06:46:42.961407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0f0e620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0fd36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0fd3310>]}
[0m06:46:42.964406 [debug] [MainThread]: Flushing usage events
[0m06:46:44.415676 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.custom_postgres.film_ratings' (models/film_ratings.sql) depends on a node named 'fims' which was not found


============================== 2024-10-25 06:47:19.205376 | fa34f796-26f6-4677-b575-f51cfb152790 ==============================
[0m06:47:19.205376 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:47:19.207893 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:47:19.209104 [debug] [MainThread]: Tracking: tracking
[0m06:47:19.211264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2316e50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2316e57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2316e5390>]}
[0m06:47:19.234442 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:47:19.340765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:47:19.341783 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:47:19.342829 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m06:47:19.349786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa34f796-26f6-4677-b575-f51cfb152790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22fe2ca90>]}
[0m06:47:19.372377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa34f796-26f6-4677-b575-f51cfb152790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22fdea050>]}
[0m06:47:19.373861 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:47:19.375427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa34f796-26f6-4677-b575-f51cfb152790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa232ffbbe0>]}
[0m06:47:19.377660 [info ] [MainThread]: 
[0m06:47:19.380421 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:47:19.384121 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:47:19.395728 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:47:19.398306 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:47:19.399940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:47:19.421458 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:47:19.423533 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:47:19.426064 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:47:19.431933 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:47:19.432893 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:47:19.433556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:47:19.445629 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:47:19.446827 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:47:19.447849 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:47:19.452616 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m06:47:19.454552 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:47:19.463355 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:47:19.470285 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:19.475295 [debug] [MainThread]: On master: BEGIN
[0m06:47:19.478831 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:47:19.500676 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:47:19.502328 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:19.503667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:47:19.510824 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:47:19.513190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa34f796-26f6-4677-b575-f51cfb152790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22fc778b0>]}
[0m06:47:19.514745 [debug] [MainThread]: On master: ROLLBACK
[0m06:47:19.517175 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:19.518405 [debug] [MainThread]: On master: BEGIN
[0m06:47:19.522935 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:47:19.524650 [debug] [MainThread]: On master: COMMIT
[0m06:47:19.526045 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:19.527406 [debug] [MainThread]: On master: COMMIT
[0m06:47:19.530212 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:47:19.531650 [debug] [MainThread]: On master: Close
[0m06:47:19.533127 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:47:19.534387 [info ] [MainThread]: 
[0m06:47:19.551518 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:47:19.553035 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m06:47:19.554799 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:47:19.556473 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:47:19.560735 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:47:19.569444 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 06:47:19.557730 => 2024-10-25 06:47:19.569320
[0m06:47:19.570843 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:47:19.603322 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:47:19.627039 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:47:19.629045 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:47:19.630202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:47:19.644401 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:47:19.645807 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:47:19.646975 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m06:47:19.650049 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:47:19.656625 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:47:19.658120 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:47:19.661126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:47:19.664689 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:47:19.665728 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:47:19.668082 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:47:19.684543 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:47:19.686764 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:47:19.688672 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:47:19.693623 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:47:19.699076 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:47:19.700975 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:47:19.706824 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:47:19.708936 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 06:47:19.572070 => 2024-10-25 06:47:19.708886
[0m06:47:19.710282 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:47:19.712018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa34f796-26f6-4677-b575-f51cfb152790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22fce5540>]}
[0m06:47:19.713354 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.actors ................................. [[32mCREATE VIEW[0m in 0.16s]
[0m06:47:19.716838 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:47:19.718475 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:47:19.719957 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m06:47:19.721789 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:47:19.722705 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:47:19.726008 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:47:19.734539 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 06:47:19.723837 => 2024-10-25 06:47:19.734456
[0m06:47:19.736294 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:47:19.743376 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:47:19.751774 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:47:19.753432 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:47:19.754546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:47:19.772331 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:47:19.773544 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:47:19.774456 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m06:47:19.777836 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:47:19.781680 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:47:19.782939 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:47:19.785398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:47:19.788472 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:47:19.789559 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:47:19.792243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:47:19.796154 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:47:19.797230 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:47:19.798223 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:47:19.801399 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:47:19.803985 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:47:19.805085 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:47:19.810226 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:47:19.812487 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 06:47:19.739286 => 2024-10-25 06:47:19.812431
[0m06:47:19.813623 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:47:19.815030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa34f796-26f6-4677-b575-f51cfb152790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22fd28e80>]}
[0m06:47:19.816181 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.film_actors ............................ [[32mCREATE VIEW[0m in 0.09s]
[0m06:47:19.817795 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:47:19.819042 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:47:19.820147 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m06:47:19.821465 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:47:19.822163 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:47:19.825639 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:47:19.835167 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 06:47:19.823023 => 2024-10-25 06:47:19.835056
[0m06:47:19.836466 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:47:19.840840 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:47:19.848585 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:47:19.849781 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:47:19.850910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:47:19.863629 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:47:19.864884 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:47:19.866118 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m06:47:19.869285 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:47:19.872757 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:47:19.874315 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:47:19.876993 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:47:19.880835 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:47:19.881874 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:47:19.884238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:47:19.886555 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:47:19.887497 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:47:19.888339 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:47:19.891863 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:47:19.894559 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:47:19.895554 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:47:19.900041 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:47:19.902210 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 06:47:19.837506 => 2024-10-25 06:47:19.902166
[0m06:47:19.903374 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:47:19.904662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa34f796-26f6-4677-b575-f51cfb152790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22fd2b550>]}
[0m06:47:19.905761 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.films .................................. [[32mCREATE VIEW[0m in 0.08s]
[0m06:47:19.908171 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:47:19.909884 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:47:19.911077 [info ] [Thread-1 (]: 4 of 4 START sql view model public.film_ratings ................................ [RUN]
[0m06:47:19.912903 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m06:47:19.913938 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:47:19.917709 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:47:19.930262 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-10-25 06:47:19.914931 => 2024-10-25 06:47:19.930150
[0m06:47:19.931462 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:47:19.935693 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:47:19.944908 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:47:19.945915 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:47:19.946885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:47:19.958942 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:47:19.960128 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:47:19.960977 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  create view "destination_db"."public"."film_ratings__dbt_tmp" as (
    WITH films_with_ratings as (
    SELECT film_id,
            title,
            release_date,
            price,
            rating,
            user_rating,
            CASE WHEN user_rating >= 4.5 THEN 'Excellent'
                 WHEN user_rating BETWEEN 4 AND 4.5 THEN 'Good'
                 WHEN user_rating BETWEEN 3 AND 4 THEN 'Average'
                 ELSE 'Bad' 
                 END as rating_category
    FROM "destination_db"."public"."films"

),
films_with_actors AS (
  SELECT
    f.film_id,
    f.title,
    STRING_AGG(a.actor_name, ',') AS actors
  FROM "destination_db"."public"."films" f
  LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
  LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
  GROUP BY f.film_id, f.title
)

SELECT fwr.*,
       fwa.actors
FROM films_with_ratings fwr
LEFT JOIN films_with_actors fwa
ON fwr.film_id = fwa. film_id
  );
[0m06:47:19.964534 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 16:     FROM "destination_db"."public"."films"
                  ^

[0m06:47:19.972549 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m06:47:19.977429 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-10-25 06:47:19.932368 => 2024-10-25 06:47:19.977153
[0m06:47:19.978822 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:47:19.986490 [debug] [Thread-1 (]: Database Error in model film_ratings (models/film_ratings.sql)
  relation "public.films" does not exist
  LINE 16:     FROM "destination_db"."public"."films"
                    ^
  compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m06:47:19.987761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa34f796-26f6-4677-b575-f51cfb152790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22db34730>]}
[0m06:47:19.988904 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model public.film_ratings ....................... [[31mERROR[0m in 0.08s]
[0m06:47:19.990883 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:47:19.993589 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:47:19.995410 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:19.997008 [debug] [MainThread]: On master: BEGIN
[0m06:47:19.998090 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:47:20.015933 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:47:20.017659 [debug] [MainThread]: On master: COMMIT
[0m06:47:20.019204 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:20.020693 [debug] [MainThread]: On master: COMMIT
[0m06:47:20.023378 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:47:20.024763 [debug] [MainThread]: On master: Close
[0m06:47:20.026979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:47:20.028435 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m06:47:20.029665 [info ] [MainThread]: 
[0m06:47:20.030909 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m06:47:20.032281 [debug] [MainThread]: Command end result
[0m06:47:20.050179 [info ] [MainThread]: 
[0m06:47:20.051691 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:47:20.052956 [info ] [MainThread]: 
[0m06:47:20.054766 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/film_ratings.sql)[0m
[0m06:47:20.055981 [error] [MainThread]:   relation "public.films" does not exist
[0m06:47:20.058897 [error] [MainThread]:   LINE 16:     FROM "destination_db"."public"."films"
[0m06:47:20.061640 [error] [MainThread]:                     ^
[0m06:47:20.063319 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m06:47:20.065107 [info ] [MainThread]: 
[0m06:47:20.066817 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:47:20.069007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22fde9d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22fde9ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22fde8490>]}
[0m06:47:20.070815 [debug] [MainThread]: Flushing usage events


============================== 2024-10-25 06:53:40.280290 | bdc243a9-c2e1-4020-9ef3-75ec4b503fbc ==============================
[0m06:53:40.280290 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:53:40.283376 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:53:40.284135 [debug] [MainThread]: Tracking: tracking
[0m06:53:40.290483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e03c50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e03c57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e03c5390>]}
[0m06:53:40.308991 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:53:40.449706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:53:40.458002 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:53:40.474116 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.custom_postgres.example
[0m06:53:40.486590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdc243a9-c2e1-4020-9ef3-75ec4b503fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28deb04a60>]}
[0m06:53:40.524550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdc243a9-c2e1-4020-9ef3-75ec4b503fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28deac2020>]}
[0m06:53:40.526773 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:53:40.529614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdc243a9-c2e1-4020-9ef3-75ec4b503fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e1d488b0>]}
[0m06:53:40.533059 [info ] [MainThread]: 
[0m06:53:40.536231 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:53:40.538678 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:53:40.552655 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:53:40.556040 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:53:40.557638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:53:40.606102 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:53:40.608707 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:53:40.611803 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:53:40.618724 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:53:40.619899 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:53:40.621068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:53:40.640469 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:53:40.641671 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:53:40.642844 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:53:40.650074 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m06:53:40.652027 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:53:40.654573 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:53:40.660963 [debug] [MainThread]: Using postgres connection "master"
[0m06:53:40.662401 [debug] [MainThread]: On master: BEGIN
[0m06:53:40.663519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:53:40.684976 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:53:40.686301 [debug] [MainThread]: Using postgres connection "master"
[0m06:53:40.687169 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:53:40.699603 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:53:40.702098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdc243a9-c2e1-4020-9ef3-75ec4b503fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28deb4b8b0>]}
[0m06:53:40.703465 [debug] [MainThread]: On master: ROLLBACK
[0m06:53:40.705697 [debug] [MainThread]: Using postgres connection "master"
[0m06:53:40.706876 [debug] [MainThread]: On master: BEGIN
[0m06:53:40.710055 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:53:40.711051 [debug] [MainThread]: On master: COMMIT
[0m06:53:40.711924 [debug] [MainThread]: Using postgres connection "master"
[0m06:53:40.712726 [debug] [MainThread]: On master: COMMIT
[0m06:53:40.714510 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:53:40.715438 [debug] [MainThread]: On master: Close
[0m06:53:40.716629 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:53:40.719797 [info ] [MainThread]: 
[0m06:53:40.742804 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:53:40.744889 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m06:53:40.746720 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:53:40.748231 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:53:40.751700 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:53:40.764143 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-10-25 06:53:40.749214 => 2024-10-25 06:53:40.764019
[0m06:53:40.765694 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:53:40.798623 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:53:40.818394 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:53:40.819745 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:53:40.821135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:53:40.838188 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:53:40.839863 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:53:40.841851 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m06:53:40.846571 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:53:40.853717 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:53:40.855059 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:53:40.858240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:53:40.862022 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:53:40.863545 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:53:40.868359 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:53:40.884804 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:53:40.886944 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:53:40.888988 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:53:40.894073 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:53:40.899419 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:53:40.900789 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:53:40.907063 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:53:40.909515 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-10-25 06:53:40.766622 => 2024-10-25 06:53:40.909464
[0m06:53:40.910765 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:53:40.912404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc243a9-c2e1-4020-9ef3-75ec4b503fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28de9caaa0>]}
[0m06:53:40.913763 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.actors ................................. [[32mCREATE VIEW[0m in 0.17s]
[0m06:53:40.916450 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:53:40.918059 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:53:40.919858 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m06:53:40.921373 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:53:40.922721 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:53:40.925991 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:53:40.935949 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-10-25 06:53:40.923787 => 2024-10-25 06:53:40.935756
[0m06:53:40.937371 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:53:40.941815 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:53:40.953747 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:53:40.956171 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:53:40.957153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:53:40.976465 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:53:40.977895 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:53:40.978893 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m06:53:40.983379 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:53:40.987520 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:53:40.988973 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:53:40.991413 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:53:40.995413 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:53:40.996939 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:53:40.999499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:53:41.003425 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:53:41.004403 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:53:41.005326 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:53:41.008652 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:53:41.011341 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:53:41.012316 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:53:41.017254 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:53:41.018965 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-10-25 06:53:40.938490 => 2024-10-25 06:53:41.018918
[0m06:53:41.020171 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:53:41.021548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc243a9-c2e1-4020-9ef3-75ec4b503fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28dea00e50>]}
[0m06:53:41.022945 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.film_actors ............................ [[32mCREATE VIEW[0m in 0.10s]
[0m06:53:41.024313 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:53:41.025214 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:53:41.026407 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m06:53:41.027883 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:53:41.029207 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:53:41.032359 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:53:41.041258 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-10-25 06:53:41.030213 => 2024-10-25 06:53:41.041137
[0m06:53:41.043021 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:53:41.047794 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:53:41.055960 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:53:41.057602 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:53:41.058479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:53:41.076652 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:53:41.077710 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:53:41.078653 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m06:53:41.083677 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m06:53:41.087229 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:53:41.088179 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:53:41.090492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:53:41.093498 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:53:41.094292 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:53:41.096453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:53:41.098837 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:53:41.099728 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:53:41.100458 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:53:41.105864 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:53:41.114642 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:53:41.115750 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:53:41.120986 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:53:41.123003 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-10-25 06:53:41.044387 => 2024-10-25 06:53:41.122946
[0m06:53:41.123854 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:53:41.125228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc243a9-c2e1-4020-9ef3-75ec4b503fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28dea01ba0>]}
[0m06:53:41.126081 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.films .................................. [[32mCREATE VIEW[0m in 0.10s]
[0m06:53:41.127480 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:53:41.129151 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:53:41.130396 [info ] [Thread-1 (]: 4 of 4 START sql view model public.film_ratings ................................ [RUN]
[0m06:53:41.132220 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m06:53:41.133546 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:53:41.137565 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:53:41.149350 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-10-25 06:53:41.134588 => 2024-10-25 06:53:41.149235
[0m06:53:41.151349 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:53:41.156298 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:53:41.165223 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:53:41.168339 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:53:41.169318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:53:41.187578 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:53:41.189605 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:53:41.190639 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  create view "destination_db"."public"."film_ratings__dbt_tmp" as (
    WITH films_with_ratings as (
    SELECT film_id,
            title,
            release_date,
            price,
            rating,
            user_rating,
            CASE WHEN user_rating >= 4.5 THEN 'Excellent'
                 WHEN user_rating BETWEEN 4 AND 4.5 THEN 'Good'
                 WHEN user_rating BETWEEN 3 AND 4 THEN 'Average'
                 ELSE 'Bad' 
                 END as rating_category
    FROM "destination_db"."public"."films"

),
films_with_actors AS (
  SELECT
    f.film_id,
    f.title,
    STRING_AGG(a.actor_name, ',') AS actors
  FROM "destination_db"."public"."films" f
  LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
  LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
  GROUP BY f.film_id, f.title
)

SELECT fwr.*,
       fwa.actors
FROM films_with_ratings fwr
LEFT JOIN films_with_actors fwa
ON fwr.film_id = fwa. film_id
  );
[0m06:53:41.195087 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 16:     FROM "destination_db"."public"."films"
                  ^

[0m06:53:41.196746 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m06:53:41.200534 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-10-25 06:53:41.152430 => 2024-10-25 06:53:41.200269
[0m06:53:41.202797 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:53:41.211942 [debug] [Thread-1 (]: Database Error in model film_ratings (models/film_ratings.sql)
  relation "public.films" does not exist
  LINE 16:     FROM "destination_db"."public"."films"
                    ^
  compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m06:53:41.218744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc243a9-c2e1-4020-9ef3-75ec4b503fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28dea2c700>]}
[0m06:53:41.221111 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model public.film_ratings ....................... [[31mERROR[0m in 0.09s]
[0m06:53:41.223001 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:53:41.225875 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:53:41.227334 [debug] [MainThread]: Using postgres connection "master"
[0m06:53:41.228381 [debug] [MainThread]: On master: BEGIN
[0m06:53:41.229576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:53:41.249740 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:53:41.252270 [debug] [MainThread]: On master: COMMIT
[0m06:53:41.254052 [debug] [MainThread]: Using postgres connection "master"
[0m06:53:41.255339 [debug] [MainThread]: On master: COMMIT
[0m06:53:41.257688 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:53:41.258896 [debug] [MainThread]: On master: Close
[0m06:53:41.260281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:53:41.261307 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m06:53:41.262984 [info ] [MainThread]: 
[0m06:53:41.264323 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m06:53:41.266932 [debug] [MainThread]: Command end result
[0m06:53:41.292345 [info ] [MainThread]: 
[0m06:53:41.294268 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:53:41.296801 [info ] [MainThread]: 
[0m06:53:41.299947 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/film_ratings.sql)[0m
[0m06:53:41.302699 [error] [MainThread]:   relation "public.films" does not exist
[0m06:53:41.305929 [error] [MainThread]:   LINE 16:     FROM "destination_db"."public"."films"
[0m06:53:41.309655 [error] [MainThread]:                     ^
[0m06:53:41.312814 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/film_ratings.sql
[0m06:53:41.315501 [info ] [MainThread]: 
[0m06:53:41.318608 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:53:41.321940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28deac00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28deac1b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28deac1270>]}
[0m06:53:41.324260 [debug] [MainThread]: Flushing usage events
